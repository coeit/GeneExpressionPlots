var lc=Object.defineProperty,tc=Object.defineProperties;var cc=Object.getOwnPropertyDescriptors;var zl=Object.getOwnPropertySymbols;var Gt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;var fl=(l,t,c)=>t in l?lc(l,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[t]=c,L=(l,t)=>{for(var c in t||(t={}))Gt.call(t,c)&&fl(l,c,t[c]);if(zl)for(var c of zl(t))ut.call(t,c)&&fl(l,c,t[c]);return l},E=(l,t)=>tc(l,cc(t));var D=(l,t)=>{var c={};for(var d in l)Gt.call(l,d)&&t.indexOf(d)<0&&(c[d]=l[d]);if(l!=null&&zl)for(var d of zl(l))t.indexOf(d)<0&&ut.call(l,d)&&(c[d]=l[d]);return c};var Te=(l,t,c)=>(fl(l,typeof t!="symbol"?t+"":t,c),c);import{R as e,N as dc,F as x,I as re,T as _,L as rt,a as ac,m as ll,u as be,B as g,S as Zt,b as bl,M as Fl,c as Ul,d as El,e as Ol,f as Dl,g as jl,C as oc,h as T,i as nc,j as Qe,k as Be,V as $,l as j,n as Al,o as Sl,p as Zl,q as Ne,r as bc,s as pt,t as vl,v as tl,w as xe,x as ge,J as _l,y as pl,z as Ze,A as Xt,D as Rl,E as sl,G as ql,H as Ye,K as Xl,P as Kt,O as sc,Q as ht,U as ic,W as mc,X as me,Y as $l,Z as Ml,_ as Tl,$ as yc,a0 as Gc,a1 as Lt,a2 as uc,a3 as rc,a4 as il,a5 as Wt,a6 as Ue,a7 as Ee,a8 as Oe,a9 as we,aa as Zc,ab as pc,ac as Kl,ad as Re,ae as et,af as Xc,ag as Kc,ah as cl,ai as dl,aj as al,ak as De,al as hc,am as Lc,an as Wc,ao as xc,ap as gc,aq as Vc,ar as Ic,as as Je,at as Hc,au as Cc,av as xt,aw as gt,ax as Yl,ay as zc,az as Vt,aA as hl,aB as It,aC as Sc,aD as vc,aE as Rc,aF as Mc,aG as Tc,aH as Yc,aI as lt,aJ as Ht,aK as tt,aL as je,aM as ee,aN as ct,aO as Ce,aP as Jc,aQ as Pc,aR as kc,aS as Qc,aT as Bc,aU as Nc,aV as wc,aW as Ct,aX as fc,aY as Fc,aZ as Uc,a_ as Ec,a$ as dt,b0 as Oc,b1 as Dc,b2 as jc,b3 as Ac,b4 as zt,b5 as _c,b6 as qc,b7 as St,b8 as $c,b9 as ed,ba as ld,bb as td,bc as cd,bd as dd,be as ad,bf as od,bg as nd,bh as bd}from"./vendor.16fccfbd.js";const sd=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))d(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&d(n)}).observe(document,{childList:!0,subtree:!0});function c(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(a){if(a.ep)return;a.ep=!0;const o=c(a);fetch(a.href,o)}};sd();const id=()=>e.createElement(dc,{to:"/data"}),pe=o=>{var n=o,{icon:l,onClick:t,text:c,textGap:d}=n,a=D(n,["icon","onClick","text","textGap"]);const b=i=>{i.preventDefault(),i.button===0&&t&&t(i)},s=i=>{(i.key==="Enter"||i.key===" ")&&t&&t(i)};return e.createElement(x,L({_hover:{textColor:"orange.600"},_focus:{outline:"none",textColor:"orange.600"},alignItems:"center",as:"button",_disabled:{color:"gray.400"},flexWrap:"nowrap",paddingX:5,paddingY:4,textColor:"gray.600",onKeyDown:s,onMouseDown:b},a),e.createElement(re,{as:l,width:6,height:6}),e.createElement(_,{fontWeight:"semibold",marginLeft:d!=null?d:6,whiteSpace:"nowrap"},c))},at=l=>e.createElement(rt,E(L({},l),{as:ac}),l.children),md=ll(x),vt=l=>{var a,o,n;const{isOpen:t,onClose:c,onOpen:d}=be();return e.createElement(md,{backgroundColor:"white",onMouseEnter:d,onMouseLeave:c,initial:{x:-20},animate:{x:0},exit:{x:-20}},e.createElement(g,L({"aria-label":"Sidebar actions",boxShadow:"xl",role:"region"},l),e.createElement(Zt,{_focusWithin:{width:(a=l.maxWidth)!=null?a:"15rem"},as:"section",overflowX:"hidden",paddingX:1,paddingY:"1rem",position:"sticky",top:0,transitionProperty:"width",transitionDuration:"0.2s",transitionTimingFunction:"linear forwards",width:t?(o=l.maxWidth)!=null?o:"15rem":(n=l.minWidth)!=null?n:"4.5rem"},l.children)))},Ve=c=>{var d=c,{title:l}=d,t=D(d,["title"]);const a=bl({base:"full",md:"md"});return e.createElement(Fl,L({scrollBehavior:"inside",size:a},t),e.createElement(Ul,null),e.createElement(El,{margin:a==="full"?0:void 0},e.createElement(Ol,null,l),e.createElement(Dl,null),e.createElement(jl,{pb:0},t.children)))},yd=a=>{var o=a,{name:l,onDelete:t,onSelect:c}=o,d=D(o,["name","onDelete","onSelect"]);const n=()=>{t&&t(l)},b=s=>{c&&c(l,s.target.checked)};return e.createElement(g,L({_focus:{outline:"none",borderColor:"orange.600"},_focusWithin:{borderColor:"orange.600"},_hover:{borderColor:"orange.600"},border:"1px",borderColor:"transparent",as:"section",backgroundColor:"white",boxShadow:"md",maxWidth:"container.md",padding:"1.5rem",role:"group",width:"100%"},d),e.createElement(x,{alignItems:"center",justifyContent:"space-between"},e.createElement(_,{fontWeight:"semibold"},l),c&&e.createElement(oc,{"aria-label":`Add ${l} to selection`,colorScheme:"orange",onChange:b})),t&&e.createElement(T,{_groupHover:{diplay:"flex"},"aria-label":`Delete ${l}`,color:"red.600",marginTop:".5rem",onClick:n,rightIcon:e.createElement(nc,null),size:"sm",variant:"ghost"},"Delete"))},ae=K=>{var r=K,{children:l,controlProps:t,groupProps:c,hideLabel:d,initialFocusRef:a,label:o,leftChildren:n,name:b,rightChildren:s,validate:i,tooltip:m}=r,p=D(r,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate","tooltip"]);const[y,C]=Qe({name:b,validate:i});return e.createElement(Be,E(L({},t),{isInvalid:C.error!==void 0&&C.touched!==void 0,isRequired:p.isRequired}),d?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},o)):e.createElement(Al,{label:m,placement:"auto"},e.createElement(j,{fontWeight:"semibold"},o)),e.createElement(Sl,L({as:"span"},c),n,e.createElement(Zl,L({ref:G=>a?a.current=G:G,name:y.name,onBlur:y.onBlur,onChange:y.onChange,multiple:y.multiple,value:y.value},p)),l,s),e.createElement(Ne,{as:"span"},C.error))},Pe=b=>{var s=b,{controlProps:l,hideLabel:t,initialFocusRef:c,label:d,name:a,validate:o}=s,n=D(s,["controlProps","hideLabel","initialFocusRef","label","name","validate"]);const[i,m]=Qe({name:a,validate:o});return e.createElement(Be,E(L({},l),{isInvalid:m.error!==void 0&&m.touched!==void 0}),e.createElement(x,{alignItems:"flex-end"},e.createElement(bc,L({colorScheme:"orange",ref:p=>c?c.current=p:p,isChecked:i.value,name:i.name,onBlur:i.onBlur,onChange:i.onChange},n)),t?e.createElement($,null,e.createElement(j,{htmlFor:n.id},d)):e.createElement(j,{fontWeight:"semibold",color:"gray.600",htmlFor:n.id,marginBottom:0,marginLeft:"1rem"},d)),e.createElement(Ne,{as:"span"},m.error))};function Gd(l,t){return l.reduce((d,a,o)=>(d.set(a,t[o]),d),new Map)}function ud(l){return typeof l=="object"&&Object.keys(l).length===0}function Rt(l){return typeof l=="number"&&!isNaN(l)}function Mt(l){const t=["na","NA","N/A","n/a",null,NaN,"NaN","nan","null",""];return Rt(Number(l))||t.includes(l)}function rd(l){return l.every(t=>Mt(t))}function Tt(l,t){const c=t.shift();return t.length===1?(ud(l)||!l[c]?l[c]=t:l[c]=[...l[c],...t],l):(l[c]||(l[c]={}),l[c]=Tt(l[c],t),l)}function Zd(l){const t=pd(l.size),d=Array.from(l.values()).map((o,n)=>[o,t[n]]);return Object.fromEntries(d)}function pd(l){return l===1?[pt(2)[0]]:pt(l,{seed:1})}class Yt{constructor(){Te(this,"header",[]);Te(this,"rows",{});Te(this,"config",{multiHeader:""});vl(this)}loadFromObject(t,c){Object.assign(this.config,c),this.header=t.header,this.rows=t.rows}get colNames(){return[...this.header]}get groupsAsArray(){return Object.keys(this.headerObject)}get hasData(){return this.colNames.length>0&&this.rowNames.length>0}get headerObject(){return Array.from(this.colNames.map(c=>c.split(this.config.multiHeader))).reduce(Tt,{})}get rowNames(){return Object.keys(this.rows)}get samplesAsArray(){const t=[];return Object.values(this.headerObject).forEach(c=>{t.push(...Object.keys(c))}),[...new Set(t)]}get sampleGroupsAsArray(){const t=[];return Object.entries(this.headerObject).forEach(c=>Object.keys(c[1]).forEach(d=>{t.push(`${c[0]}${this.config.multiHeader}${d}`)})),[...new Set(t)]}getRow(t){return this.rows[t]}getColumnValue(t,c){const d=this.colNames.findIndex(a=>a===c);return this.rows[t][d]}getColumn(t){const c=this.colNames.findIndex(a=>a===t),d={};return this.rowNames.forEach(a=>{d[a]=this.rows[a][c]}),d}sliceColumns(t,c){const d=Object.values(this.rows).slice(t,c);return d[0].map((a,o)=>d.map(n=>n[o]))}getRowAsMap(t){return this.getRow(t)?Gd(this.colNames,this.getRow(t)):void 0}getRowAsTree(t){const c=this.rows[t];return this.header.reduce((d,a,o)=>{const n=a.split(this.config.multiHeader),b=n[0],s=n[1];return d[b]?d[b][s]?d[b][s].push(c[o]):d[b][s]=[c[o]]:d[b]={[s]:[c[o]]},d},{})}getRows(t){const c=a=>[a,this.getRow(a)];return Object.fromEntries(t.map(c))}getSubheaderColors(t){const c=this.colNames.map(o=>o.split(this.config.multiHeader).slice(0,t).join(this.config.multiHeader)),d=Zd(new Set(c));return c.map(o=>d[o])}toArrayOfRows(t=[]){const c=(s,i)=>t.includes(s)?i:void 0;let d=[];t.length>0&&(d=t.map(c).filter(Rt));const a=(s,i)=>d.includes(i),o=s=>parseFloat(s),n=s=>{const[,i]=s;let m=i;return t&&d.length>0&&(m=i.filter(a)),m.map(o)};return Object.entries(this.rows).map(n)}toArrayOfColumns(t=[]){const c=this.toArrayOfRows(t);return c[0].map((a,o)=>c.map(n=>n[o]))}toBins(t=!1){let c;const d=o=>{const[n,b]=o;return{bin:n,bins:b.map((s,i)=>({bin:this.colNames[i],count:parseFloat(s)}))}},a=(o,n)=>{const b=c.map(({bin:s,bins:i})=>({bin:s,count:i[n].count}));return{bin:o,bins:b}};return c=Object.entries(this.rows).map(d),t&&(c=this.colNames.map(a)),c}toString(t){let c="Gene-ID"+t;return c+=this.header.join(t),c+=`
`,Object.keys(this.rows).forEach(d=>{c+=d+t,c+=this.rows[d].join(t),c+=`
`}),c}addColumn(t,c){this.header.push(t),c.forEach(([d,a])=>{if(!this.rows[d]){console.warn(`${d} is not a known gene accession`);return}this.rows[d].push(a)})}addRow(t,c){this.rows[t]=c}clearData(){this.header=[],this.rows={}}removeColumns(...t){const c=this.colNames.filter(o=>!t.includes(o)),d=new Set(this.colNames.map((o,n)=>t.includes(o)?n:void 0).filter(o=>o!==void 0)),a=Object.fromEntries(Object.entries(this.rows).map(([o,n])=>[o,n.filter((b,s)=>!d.has(s))]));this.header=c,this.rows=a}getGenesForMapManBin(t,c,d,a){const o=this.colNames.findIndex(n=>n===t);return this.rowNames.filter(n=>{const b=this.rows[n][o].split(c),s=a?new RegExp(`^${d}`):new RegExp(`^${d}$`);return b.some(i=>s.test(i))})}getMapManMeanValues(t,c){const d={};return this.rowNames.forEach(a=>{const o=this.getRowAsTree(a),n=tl(o[t][c].map(b=>parseFloat(b)));d[a]=n}),d}addMercatorHeaderAndPrepareColumns(t,c){this.header.push("MapMan_BINCODE"),t&&this.header.push("MapMan_NAME"),c&&this.header.push("MapMan_DESCRIPTION")}isNumericColumn(t){return Object.values(this.getColumn(t)).slice(0,9).every(d=>Mt(d))}}const I=new Yt,v=new Yt,Xd="/GeneExpressionPlots/expression_table.txt",Kd={}.VITE_PRELOAD_IMAGE,hd="/GeneExpressionPlots/info_table.txt",Ld="/GeneExpressionPlots/GXP_settings.json",Wd="/GeneExpressionPlots/plots.json",xd={}.VITE_PRELOAD_ENRICHMENTS;class gd{constructor(t){Te(this,"_PRELOADED",{data:"",info:"",image:"",settings:"",plots:"",enrichments:""});Te(this,"_gxpSettings",{unit:"",expression_field_sep:"	",expression_header_sep:"*",info_field_sep:"	",groupOrder:[],sampleOrder:[]});Te(this,"_isPreloading",!1);Object.assign(this._PRELOADED,t),vl(this)}get preloaded(){return this._PRELOADED}get isPreloading(){return this.preloaded.data&&!I.hasData}get gxpSettings(){return this._gxpSettings}get groupOrder(){return this._gxpSettings.groupOrder}get sampleOrder(){return this._gxpSettings.sampleOrder}get unit(){return this._gxpSettings.unit}loadgxpSettings(t){Object.assign(this._gxpSettings,t)}setGroupOrder(t){this._gxpSettings.groupOrder=t}setSampleOrder(t){this._gxpSettings.sampleOrder=t}}const h=new gd({data:Xd,info:hd,image:Kd,settings:Ld,plots:Wd,enrichments:xd});function Vd(l){return l.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function fe(l){return l.replace(/\\t|\\s/,t=>{switch(t){case"\\t":return"	";case"\\s":return"s";default:return t}})}function Id(l){return l.replace(/\t|\s/,t=>{switch(t){case"	":return"\\t";case" ":return"\\s";default:return t}})}const Hd=l=>{const t=d=>{if(!d)return"A file name is required"},c=d=>{let a;return d?(d.length>1&&d[0]!=="\\"||d.length>2)&&(a="Separators must be one character long (escaped characters are supported)"):a="A separator value is required",a};return e.createElement(xe,{initialValues:{columnSep:Id(h.gxpSettings.expression_field_sep),fileName:"GXP_Database",exportPlots:!1,exportEnrichments:!1},onSubmit:l.onSubmit,validateOnBlur:!1},d=>e.createElement(g,{as:ge,id:"export-gxp-db",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(ae,{initialFocusRef:l.initialFocusRef,name:"columnSep",label:"Column Separator",validate:c,isRequired:!0}),e.createElement(ae,{name:"fileName",label:"File Name",validate:t,isRequired:!0}),e.createElement(Pe,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"export-plots",name:"exportPlots",label:"Export Plots"}),e.createElement(Pe,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"export-enrichments",name:"exportEnrichments",label:"Export Enrichments"}),l.children?typeof l.children=="function"?l.children(d):l.children:e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:d.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Export"))))},Ll=n=>{var b=n,{hideLabel:l,initialFocusRef:t,label:c,name:d,validate:a}=b,o=D(b,["hideLabel","initialFocusRef","label","name","validate"]);var G,Q;const[s,i,m]=Qe({name:d,validate:a}),p=e.useRef(null),K=W=>{var Y;const M=(Y=W.currentTarget.files)==null?void 0:Y.item(0);M&&m.setValue(M)},r=W=>{W.key===" "&&C()},y=W=>{W.button===0&&C()},C=()=>{var W;(W=p.current)==null||W.click()};return e.createElement(Be,{as:"p",isInvalid:i.error!==void 0&&i.touched!==void 0,isRequired:o.isRequired,isReadOnly:!0},l?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},c)):e.createElement(j,{fontWeight:"semibold"},c),e.createElement(Zl,E(L(L({},s),o),{ref:W=>t?t.current=W:W,onMouseDown:y,onKeyDown:r,placeholder:"Select a file to load",onChange:W=>W,value:(Q=(G=s.value)==null?void 0:G.name)!=null?Q:""})),e.createElement(Zl,{ref:W=>p.current=W,hidden:!0,id:`hidden-${s.name}`,name:`hidden-${s.name}`,type:"file",onChange:K}),e.createElement(Ne,{as:"span"},i.error))},Cd=l=>{const t=async c=>{if(!c)return"A file input is required";const a=await new _l().loadAsync(c);if(a.files["GXP_settings.json"]===void 0)return'The database does not contain the "GXP_settings.json" file.';if(a.files["expression_table.txt"]===void 0)return'The database does not contain the "expression_table.txt" file.'};return e.createElement(xe,{initialValues:{},onSubmit:l.onSubmit,validateOnBlur:!1},c=>e.createElement(g,{as:ge,id:"import-gxp-db",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(Ll,{initialFocusRef:l.initialFocusRef,name:"file",label:"GXP Archive",validate:t,isRequired:!0}),l.children?typeof l.children=="function"?l.children(c):l.children:e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Import"))))},zd=l=>{const t=d=>{if(!d)return"A file input is required"},c=d=>{let a;return d?(d.length>1&&d[0]!=="\\"||d.length>2)&&(a="Separators must be one character long (escaped characters are supported)"):a="A separator value is required",a};return e.createElement(xe,{initialValues:{columnSep:"\\t"},onSubmit:l.onSubmit,validateOnBlur:!1},d=>e.createElement(g,{as:ge,id:"load-gene-info-table",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(ae,{initialFocusRef:l.initialFocusRef,name:"columnSep",label:"Column Separator",validate:c,isRequired:!0}),e.createElement(Ll,{name:"file",label:"Tabular File",validate:t,isRequired:!0}),l.children?typeof l.children=="function"?l.children(d):l.children:e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:d.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Sd=l=>{const t=d=>{if(!d)return"A file input is required"},c=d=>{let a;return d?(d.length>1&&d[0]!=="\\"||d.length>2)&&(a="Separators must be one character long (escaped characters are supported)"):a="A separator value is required",a};return e.createElement(xe,{initialValues:{countUnit:"Raw",headerSep:"*",columnSep:"\\t"},onSubmit:l.onSubmit,validateOnBlur:!1},d=>e.createElement(g,{as:ge,id:"load-xtable",sx:{"& p:not(:first-of-type)":{marginTop:"1rem"}}},e.createElement(ae,{name:"countUnit",label:"Count Unit",initialFocusRef:l.initialFocusRef}),e.createElement(ae,{name:"headerSep",label:"Header Separator",validate:c,isRequired:!0}),e.createElement(ae,{name:"columnSep",label:"Column Separator",validate:c,isRequired:!0}),e.createElement(Ll,{name:"file",label:"Tabular File",validate:t,isRequired:!0}),l.children?typeof l.children=="function"?l.children(d):l.children:e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:d.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Jt="KCgpPT57dmFyIGVvPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgSnQ9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgbm89T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxvbz1PYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlO3ZhciBHdD0oVyxiLEIpPT5iIGluIFc/ZW8oVyxiLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTpCfSk6V1tiXT1CLFJ0PShXLGIpPT57Zm9yKHZhciBCIGluIGJ8fChiPXt9KSluby5jYWxsKGIsQikmJkd0KFcsQixiW0JdKTtpZihKdClmb3IodmFyIEIgb2YgSnQoYikpb28uY2FsbChiLEIpJiZHdChXLEIsYltCXSk7cmV0dXJuIFd9OyhmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBXKHMsbil7bGV0IGU9MDtmb3IobGV0IHQ9MDt0PHMubGVuZ3RoO3QrKyllKz0oc1t0XS1uW3RdKSooc1t0XS1uW3RdKTtyZXR1cm4gZX1mdW5jdGlvbiBiKHMsbil7cmV0dXJuIE1hdGguc3FydChXKHMsbikpfWZ1bmN0aW9uIEIocyxuKXtmb3IodmFyIGU9MCx0PXMubGVuZ3RoLG89MDtlPHQ7ZSsrKW8rPShzW2VdLW5bZV0pKihzW2VdLW5bZV0pKihzW2VdK25bZV0pLyhzW2VdKm5bZV0pO3JldHVybiAyKm99ZnVuY3Rpb24gV3QocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MCxyPTAsaT0wO2k8ZTtpKyspcj1NYXRoLmFicyhzW2ldLW5baV0pLG8rPXIsdDxyJiYodD1yKTtyZXR1cm4odCtvKS8yfWZ1bmN0aW9uIEt0KHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTA7bzxlO28rKyl0Kz1NYXRoLnNxcnQoc1tvXSpuW29dKTtyZXR1cm4tTWF0aC5sb2codCl9ZnVuY3Rpb24gVXQocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPU1hdGguYWJzKHNbb10tbltvXSkvKHNbb10rbltvXSk7cmV0dXJuIHR9ZnVuY3Rpb24gWHQocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MCxyPTA7cjxlO3IrKylvPU1hdGguYWJzKHNbcl0tbltyXSksdDxvJiYodD1vKTtyZXR1cm4gdH1mdW5jdGlvbiBRdChzLG4pe2Zvcih2YXIgZT0wLHQ9cy5sZW5ndGgsbz0wO2U8dDtlKyspbys9TWF0aC5zcXJ0KChzW2VdLW5bZV0pKihzW2VdLW5bZV0pLygoc1tlXStuW2VdKSooc1tlXStuW2VdKSkpO3JldHVybiAyKm99ZnVuY3Rpb24gWXQocyxuKXtmb3IodmFyIGU9MCx0PTAsbz0wO288cy5sZW5ndGg7bysrKWUrPU1hdGgubWluKHNbb10sbltvXSksdCs9c1tvXStuW29dO3JldHVybiAyKmUvdH1mdW5jdGlvbiBadChzLG4pe3JldHVybiAxLVl0KHMsbil9ZnVuY3Rpb24gX3QocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MCxyPTAsaT0wO2k8ZTtpKyspdCs9c1tpXSpzW2ldLG8rPW5baV0qbltpXSxyKz0oc1tpXS1uW2ldKSooc1tpXS1uW2ldKTtyZXR1cm4gci8odCtvKX1mdW5jdGlvbiB4dChzLG4pe2Zvcih2YXIgZT0wLHQ9cy5sZW5ndGgsbz0wO2U8dDtlKyspbys9KHNbZV0tbltlXSkqKHNbZV0tbltlXSkvKChzW2VdK25bZV0pKihzW2VdK25bZV0pKTtyZXR1cm4gMipvfWZ1bmN0aW9uIEF0KHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTA7bzxlO28rKyl0Kz1NYXRoLnNxcnQoc1tvXSpuW29dKTtyZXR1cm4gdH1mdW5jdGlvbiB0ZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wO288ZTtvKyspdCs9TWF0aC5hYnMoc1tvXS1uW29dKTtyZXR1cm4gdC9lfWZ1bmN0aW9uIGVlKHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTA7bzxlO28rKyl0Kz1zW29dKm5bb10vKHNbb10rbltvXSk7cmV0dXJuIDIqdH1mdW5jdGlvbiBuZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wO288ZTtvKyspdCs9TWF0aC5zcXJ0KHNbb10qbltvXSk7cmV0dXJuIDIqTWF0aC5zcXJ0KDEtdCl9ZnVuY3Rpb24gb2UocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPXNbb10qbltvXTtyZXR1cm4gdH1mdW5jdGlvbiBzZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wO288ZTtvKyspdCs9TWF0aC5taW4oc1tvXSxuW29dKTtyZXR1cm4gMS10fWZ1bmN0aW9uIHJlKHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTAscj0wLGk9MCxoPTA7aDxlO2grKyl0Kz1zW2hdKm5baF0sbys9c1toXSpzW2hdLHIrPW5baF0qbltoXSxpKz0oc1toXS1uW2hdKSooc1toXS1uW2hdKTtyZXR1cm4gaS8obytyLXQpfWZ1bmN0aW9uIGllKHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTA7bzxlO28rKyl0Kz0oc1tvXS1uW29dKSpNYXRoLmxvZyhzW29dL25bb10pO3JldHVybiB0fWZ1bmN0aW9uIGhlKHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTA7bzxlO28rKyl0Kz0oc1tvXSpNYXRoLmxvZyhzW29dKStuW29dKk1hdGgubG9nKG5bb10pKS8yLShzW29dK25bb10pLzIqTWF0aC5sb2coKHNbb10rbltvXSkvMik7cmV0dXJuIHR9ZnVuY3Rpb24gdWUocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MCxyPTA7cjxlO3IrKyl0Kz1zW3JdKk1hdGgubG9nKDIqc1tyXS8oc1tyXStuW3JdKSksbys9bltyXSpNYXRoLmxvZygyKm5bcl0vKHNbcl0rbltyXSkpO3JldHVybih0K28pLzJ9ZnVuY3Rpb24gbGUocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPXNbb10qTWF0aC5sb2coMipzW29dLyhzW29dK25bb10pKTtyZXR1cm4gdH1mdW5jdGlvbiBmZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wLHI9MDtyPGU7cisrKXQrPU1hdGguYWJzKHNbcl0tbltyXSksbys9TWF0aC5taW4oc1tyXSxuW3JdKTtyZXR1cm4gdC9vfWZ1bmN0aW9uIGNlKHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTA7bzxlO28rKyl0Kz1zW29dKk1hdGgubG9nKHNbb10vbltvXSk7cmV0dXJuIHR9ZnVuY3Rpb24gd2UocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MCxyPTAsaT0wO2k8ZTtpKyspdCs9c1tpXSpuW2ldLG8rPXNbaV0qc1tpXSxyKz1uW2ldKm5baV07cmV0dXJuIHQvKG8rci10KX1mdW5jdGlvbiBnZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wO288ZTtvKyspdCs9TWF0aC5wb3coc1tvXSpzW29dLW5bb10qbltvXSwyKS8oMipNYXRoLnBvdyhzW29dKm5bb10sMS41KSk7cmV0dXJuIHR9ZnVuY3Rpb24gbWUocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPU1hdGgubG9nKE1hdGguYWJzKHNbb10tbltvXSkrMSk7cmV0dXJuIHR9ZnVuY3Rpb24gcGUocyxuKXtmb3IodmFyIGU9MCx0PXMubGVuZ3RoLG89MDtlPHQ7ZSsrKW8rPU1hdGguYWJzKHNbZV0tbltlXSk7cmV0dXJuIG99ZnVuY3Rpb24gYWUocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPU1hdGguc3FydChzW29dKm5bb10pO3JldHVybiBNYXRoLnNxcnQoMi0yKnQpfWZ1bmN0aW9uIGRlKHMsbixlKXtmb3IodmFyIHQ9MCxvPXMubGVuZ3RoLHI9MDt0PG87dCsrKXIrPU1hdGgucG93KE1hdGguYWJzKHNbdF0tblt0XSksZSk7cmV0dXJuIE1hdGgucG93KHIsMS9lKX1mdW5jdGlvbiB5ZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wLHI9MDtyPGU7cisrKXQrPU1hdGgubWluKHNbcl0sbltyXSksbys9c1tyXStuW3JdO3JldHVybiAxLXQvb31mdW5jdGlvbiBqZShzLG4pe2Zvcih2YXIgZT0wLHQ9cy5sZW5ndGgsbz0wO2U8dDtlKyspbys9KHNbZV0tbltlXSkqKHNbZV0tbltlXSkvc1tlXTtyZXR1cm4gb31mdW5jdGlvbiB2ZShzLG4pe2Zvcih2YXIgZT0wLHQ9cy5sZW5ndGgsbz0wO2U8dDtlKyspbys9KHNbZV0tbltlXSkqKHNbZV0tbltlXSkvbltlXTtyZXR1cm4gb31mdW5jdGlvbiBTZShzLG4pe2Zvcih2YXIgZT0wLHQ9cy5sZW5ndGgsbz0wO2U8dDtlKyspbys9KHNbZV0tbltlXSkqKHNbZV0tbltlXSkvKHNbZV0rbltlXSk7cmV0dXJuIDIqb31mdW5jdGlvbiBFZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wLHI9MDtyPGU7cisrKXQrPU1hdGgubWluKHNbcl0sbltyXSksbys9TWF0aC5tYXgoc1tyXSxuW3JdKTtyZXR1cm4gdC9vfWZ1bmN0aW9uIE1lKHMsbil7Zm9yKHZhciBlPXMubGVuZ3RoLHQ9MCxvPTAscj0wO3I8ZTtyKyspdCs9TWF0aC5hYnMoc1tyXS1uW3JdKSxvKz1NYXRoLm1heChzW3JdLG5bcl0pO3JldHVybiB0L299ZnVuY3Rpb24ga2UocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MCxyPTA7cjxlO3IrKyl0Kz1NYXRoLmFicyhzW3JdLW5bcl0pLG8rPXNbcl0rbltyXTtyZXR1cm4gdC9vfWZ1bmN0aW9uIFJlKHMsbil7Zm9yKHZhciBlPTAsdD1zLmxlbmd0aCxvPTA7ZTx0O2UrKylvKz0oc1tlXS1uW2VdKSooc1tlXS1uW2VdKS8oc1tlXStuW2VdKTtyZXR1cm4gb31mdW5jdGlvbiAkZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wO288ZTtvKyspdCs9KE1hdGguc3FydChzW29dKS1NYXRoLnNxcnQobltvXSkpKihNYXRoLnNxcnQoc1tvXSktTWF0aC5zcXJ0KG5bb10pKTtyZXR1cm4gdH1mdW5jdGlvbiBUZShzLG4pe2Zvcih2YXIgZT1zLmxlbmd0aCx0PTAsbz0wO288ZTtvKyspdCs9KHNbb10rbltvXSkvMipNYXRoLmxvZygoc1tvXStuW29dKS8oMipNYXRoLnNxcnQoc1tvXSpuW29dKSkpO3JldHVybiB0fWZ1bmN0aW9uIHFlKHMsbixlKXtpZihlKXtmb3IodmFyIHQ9MCxvPTAscj0wO3I8cy5sZW5ndGg7cisrKXQrPXNbcl0mJm5bcl0sbys9c1tyXXx8bltyXTtyZXR1cm4gbz09PTA/MTp0L299ZWxzZXtmb3IodmFyIGk9cy5sZW5ndGgsaD0wLHU9MCxmPTAsbD0wO2w8aTtsKyspaCs9c1tsXSx1Kz1uW2xdLGYrPU1hdGgubWluKHNbbF0sbltsXSk7cmV0dXJuIDEtKGgrdS0yKmYpLyhoK3UtZil9fWZ1bmN0aW9uIEllKHMsbixlKXtpZihlKXJldHVybiAxLXFlKHMsbixlKTtmb3IodmFyIHQ9cy5sZW5ndGgsbz0wLHI9MCxpPTAsaD0wO2g8dDtoKyspbys9c1toXSxyKz1uW2hdLGkrPU1hdGgubWluKHNbaF0sbltoXSk7cmV0dXJuKG8rci0yKmkpLyhvK3ItaSl9ZnVuY3Rpb24gemUocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPXNbb10qTWF0aC5sb2coMipzW29dLyhzW29dK25bb10pKStuW29dKk1hdGgubG9nKDIqbltvXS8oc1tvXStuW29dKSk7cmV0dXJuIHR9ZnVuY3Rpb24gTmUocyxuKXtmb3IodmFyIGU9cy5sZW5ndGgsdD0wLG89MDtvPGU7bysrKXQrPTEtTWF0aC5taW4oc1tvXSxuW29dKS9NYXRoLm1heChzW29dLG5bb10pO3JldHVybiB0fXZhciBGZT1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxldWNsaWRlYW46YixzcXVhcmVkRXVjbGlkZWFuOlcsYWRkaXRpdmVTeW1tZXRyaWM6Qixhdmc6V3QsYmhhdHRhY2hhcnl5YTpLdCxjYW5iZXJyYTpVdCxjaGVieXNoZXY6WHQsY2xhcms6UXQsY3pla2Fub3dza2k6WnQsZGljZTpfdCxkaXZlcmdlbmNlOnh0LGZpZGVsaXR5OkF0LGdvd2VyOnRlLGhhcm1vbmljTWVhbjplZSxoZWxsaW5nZXI6bmUsaW5uZXJQcm9kdWN0Om9lLGludGVyc2VjdGlvbjpzZSxqYWNjYXJkOnJlLGplZmZyZXlzOmllLGplbnNlbkRpZmZlcmVuY2U6aGUsamVuc2VuU2hhbm5vbjp1ZSxrZGl2ZXJnZW5jZTpsZSxrdWxjenluc2tpOmZlLGt1bGxiYWNrTGVpYmxlcjpjZSxrdW1hckhhc3NlYnJvb2s6d2Usa3VtYXJKb2huc29uOmdlLGxvcmVudHppYW46bWUsbWFuaGF0dGFuOnBlLG1hdHVzaXRhOmFlLG1pbmtvd3NraTpkZSxtb3R5a2E6eWUsbmV5bWFuOmplLHBlYXJzb246dmUscHJvYmFiaWxpc3RpY1N5bW1ldHJpYzpTZSxydXppY2thOkVlLHNvZXJnZWw6TWUsc29yZW5zZW46a2Usc3F1YXJlZDpSZSxzcXVhcmVkQ2hvcmQ6JGUsdGFuZWphOlRlLHRhbmltb3RvOkllLHRvcHNvZTp6ZSx3YXZlSGVkZ2VzOk5lfSksVmU9dHlwZW9mIGdsb2JhbFRoaXMhPSJ1bmRlZmluZWQiP2dsb2JhbFRoaXM6dHlwZW9mIHdpbmRvdyE9InVuZGVmaW5lZCI/d2luZG93OnR5cGVvZiBnbG9iYWwhPSJ1bmRlZmluZWQiP2dsb2JhbDp0eXBlb2Ygc2VsZiE9InVuZGVmaW5lZCI/c2VsZjp7fTtjb25zdCBQZT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2Z1bmN0aW9uIFEocyl7cmV0dXJuIFBlLmNhbGwocykuZW5kc1dpdGgoIkFycmF5XSIpfWZ1bmN0aW9uICR0KHMsbil7Y29uc3QgZT1DZShzLmxlbmd0aCk7Zm9yKGxldCB0PTA7dDxzLmxlbmd0aDt0KyspZm9yKGxldCBvPTA7bzw9dDtvKyspZVt0XVtvXT1uKHNbdF0sc1tvXSksZVtvXVt0XT1lW3RdW29dO3JldHVybiBlfWZ1bmN0aW9uIENlKHMpe2NvbnN0IG49W107Zm9yKGxldCBlPTA7ZTxzO2UrKyl7Y29uc3QgdD1bXTtuLnB1c2godCk7Zm9yKGxldCBvPTA7bzxzO28rKyl0LnB1c2goMCl9cmV0dXJuIG59ZnVuY3Rpb24gVHQocyl7dmFyIG49YXJndW1lbnRzLmxlbmd0aD4xJiZhcmd1bWVudHNbMV0hPT12b2lkIDA/YXJndW1lbnRzWzFdOnt9O2lmKCFRKHMpKXRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3QgYmUgYW4gYXJyYXkiKTtpZihzLmxlbmd0aD09PTApdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBub3QgYmUgZW1wdHkiKTt2YXIgZT1uLmZyb21JbmRleCx0PWU9PT12b2lkIDA/MDplLG89bi50b0luZGV4LHI9bz09PXZvaWQgMD9zLmxlbmd0aDpvO2lmKHQ8MHx8dD49cy5sZW5ndGh8fCFOdW1iZXIuaXNJbnRlZ2VyKHQpKXRocm93IG5ldyBFcnJvcigiZnJvbUluZGV4IG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIHNtYWxsZXIgdGhhbiBsZW5ndGgiKTtpZihyPD10fHxyPnMubGVuZ3RofHwhTnVtYmVyLmlzSW50ZWdlcihyKSl0aHJvdyBuZXcgRXJyb3IoInRvSW5kZXggbXVzdCBiZSBhbiBpbnRlZ2VyIGdyZWF0ZXIgdGhhbiBmcm9tSW5kZXggYW5kIGF0IG1vc3QgZXF1YWwgdG8gbGVuZ3RoIik7Zm9yKHZhciBpPXNbdF0saD10KzE7aDxyO2grKylzW2hdPmkmJihpPXNbaF0pO3JldHVybiBpfWZ1bmN0aW9uIHF0KHMpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGg+MSYmYXJndW1lbnRzWzFdIT09dm9pZCAwP2FyZ3VtZW50c1sxXTp7fTtpZighUShzKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IGJlIGFuIGFycmF5Iik7aWYocy5sZW5ndGg9PT0wKXRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3Qgbm90IGJlIGVtcHR5Iik7dmFyIGU9bi5mcm9tSW5kZXgsdD1lPT09dm9pZCAwPzA6ZSxvPW4udG9JbmRleCxyPW89PT12b2lkIDA/cy5sZW5ndGg6bztpZih0PDB8fHQ+PXMubGVuZ3RofHwhTnVtYmVyLmlzSW50ZWdlcih0KSl0aHJvdyBuZXcgRXJyb3IoImZyb21JbmRleCBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciBzbWFsbGVyIHRoYW4gbGVuZ3RoIik7aWYocjw9dHx8cj5zLmxlbmd0aHx8IU51bWJlci5pc0ludGVnZXIocikpdGhyb3cgbmV3IEVycm9yKCJ0b0luZGV4IG11c3QgYmUgYW4gaW50ZWdlciBncmVhdGVyIHRoYW4gZnJvbUluZGV4IGFuZCBhdCBtb3N0IGVxdWFsIHRvIGxlbmd0aCIpO2Zvcih2YXIgaT1zW3RdLGg9dCsxO2g8cjtoKyspc1toXTxpJiYoaT1zW2hdKTtyZXR1cm4gaX1mdW5jdGlvbiBJdChzKXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoPjEmJmFyZ3VtZW50c1sxXSE9PXZvaWQgMD9hcmd1bWVudHNbMV06e307aWYoUShzKSl7aWYocy5sZW5ndGg9PT0wKXRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3Qgbm90IGJlIGVtcHR5Iil9ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IGJlIGFuIGFycmF5Iik7dmFyIGU7aWYobi5vdXRwdXQhPT12b2lkIDApe2lmKCFRKG4ub3V0cHV0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJvdXRwdXQgb3B0aW9uIG11c3QgYmUgYW4gYXJyYXkgaWYgc3BlY2lmaWVkIik7ZT1uLm91dHB1dH1lbHNlIGU9bmV3IEFycmF5KHMubGVuZ3RoKTt2YXIgdD1xdChzKSxvPVR0KHMpO2lmKHQ9PT1vKXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW5pbXVtIGFuZCBtYXhpbXVtIGlucHV0IHZhbHVlcyBhcmUgZXF1YWwuIENhbm5vdCByZXNjYWxlIGEgY29uc3RhbnQgYXJyYXkiKTt2YXIgcj1uLm1pbixpPXI9PT12b2lkIDA/bi5hdXRvTWluTWF4P3Q6MDpyLGg9bi5tYXgsdT1oPT09dm9pZCAwP24uYXV0b01pbk1heD9vOjE6aDtpZihpPj11KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gb3B0aW9uIG11c3QgYmUgc21hbGxlciB0aGFuIG1heCBvcHRpb24iKTtmb3IodmFyIGY9KHUtaSkvKG8tdCksbD0wO2w8cy5sZW5ndGg7bCsrKWVbbF09KHNbbF0tdCkqZitpO3JldHVybiBlfWNvbnN0IG90PSIgIi5yZXBlYXQoMiksenQ9IiAiLnJlcGVhdCg0KTtmdW5jdGlvbiBiZSgpe3JldHVybiBOdCh0aGlzKX1mdW5jdGlvbiBOdChzLG49e30pe2NvbnN0e21heFJvd3M6ZT0xNSxtYXhDb2x1bW5zOnQ9MTAsbWF4TnVtU2l6ZTpvPTh9PW47cmV0dXJuYCR7cy5jb25zdHJ1Y3Rvci5uYW1lfSB7CiR7b3R9Wwoke3p0fSR7RGUocyxlLHQsbyl9CiR7b3R9XQoke290fXJvd3M6ICR7cy5yb3dzfQoke290fWNvbHVtbnM6ICR7cy5jb2x1bW5zfQp9YH1mdW5jdGlvbiBEZShzLG4sZSx0KXtjb25zdHtyb3dzOm8sY29sdW1uczpyfT1zLGk9TWF0aC5taW4obyxuKSxoPU1hdGgubWluKHIsZSksdT1bXTtmb3IobGV0IGY9MDtmPGk7ZisrKXtsZXQgbD1bXTtmb3IobGV0IG09MDttPGg7bSsrKWwucHVzaChCZShzLmdldChmLG0pLHQpKTt1LnB1c2goYCR7bC5qb2luKCIgIil9YCl9cmV0dXJuIGghPT1yJiYodVt1Lmxlbmd0aC0xXSs9YCAuLi4gJHtyLWV9IG1vcmUgY29sdW1uc2ApLGkhPT1vJiZ1LnB1c2goYC4uLiAke28tbn0gbW9yZSByb3dzYCksdS5qb2luKGAKJHt6dH1gKX1mdW5jdGlvbiBCZShzLG4pe2NvbnN0IGU9U3RyaW5nKHMpO2lmKGUubGVuZ3RoPD1uKXJldHVybiBlLnBhZEVuZChuLCIgIik7Y29uc3QgdD1zLnRvUHJlY2lzaW9uKG4tMik7aWYodC5sZW5ndGg8PW4pcmV0dXJuIHQ7Y29uc3Qgbz1zLnRvRXhwb25lbnRpYWwobi0yKSxyPW8uaW5kZXhPZigiZSIpLGk9by5zbGljZShyKTtyZXR1cm4gby5zbGljZSgwLG4taS5sZW5ndGgpK2l9ZnVuY3Rpb24gT2UocyxuKXtzLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmFkZFModCk6dGhpcy5hZGRNKHQpfSxzLnByb3RvdHlwZS5hZGRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scikrdCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLmFkZE09ZnVuY3Rpb24odCl7aWYodD1uLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpK3QuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLmFkZD1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5hZGQobyl9LHMucHJvdG90eXBlLnN1Yj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuc3ViUyh0KTp0aGlzLnN1Yk0odCl9LHMucHJvdG90eXBlLnN1YlM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKS10KTtyZXR1cm4gdGhpc30scy5wcm90b3R5cGUuc3ViTT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8sciktdC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMuc3ViPWZ1bmN0aW9uKHQsbyl7cmV0dXJuIG5ldyBuKHQpLnN1YihvKX0scy5wcm90b3R5cGUuc3VidHJhY3Q9cy5wcm90b3R5cGUuc3ViLHMucHJvdG90eXBlLnN1YnRyYWN0Uz1zLnByb3RvdHlwZS5zdWJTLHMucHJvdG90eXBlLnN1YnRyYWN0TT1zLnByb3RvdHlwZS5zdWJNLHMuc3VidHJhY3Q9cy5zdWIscy5wcm90b3R5cGUubXVsPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5tdWxTKHQpOnRoaXMubXVsTSh0KX0scy5wcm90b3R5cGUubXVsUz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpKnQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5tdWxNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKSp0LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5tdWw9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkubXVsKG8pfSxzLnByb3RvdHlwZS5tdWx0aXBseT1zLnByb3RvdHlwZS5tdWwscy5wcm90b3R5cGUubXVsdGlwbHlTPXMucHJvdG90eXBlLm11bFMscy5wcm90b3R5cGUubXVsdGlwbHlNPXMucHJvdG90eXBlLm11bE0scy5tdWx0aXBseT1zLm11bCxzLnByb3RvdHlwZS5kaXY9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmRpdlModCk6dGhpcy5kaXZNKHQpfSxzLnByb3RvdHlwZS5kaXZTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scikvdCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLmRpdk09ZnVuY3Rpb24odCl7aWYodD1uLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpL3QuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLmRpdj1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5kaXYobyl9LHMucHJvdG90eXBlLmRpdmlkZT1zLnByb3RvdHlwZS5kaXYscy5wcm90b3R5cGUuZGl2aWRlUz1zLnByb3RvdHlwZS5kaXZTLHMucHJvdG90eXBlLmRpdmlkZU09cy5wcm90b3R5cGUuZGl2TSxzLmRpdmlkZT1zLmRpdixzLnByb3RvdHlwZS5tb2Q9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLm1vZFModCk6dGhpcy5tb2RNKHQpfSxzLnByb3RvdHlwZS5tb2RTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scikldCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLm1vZE09ZnVuY3Rpb24odCl7aWYodD1uLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpJXQuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLm1vZD1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5tb2Qobyl9LHMucHJvdG90eXBlLm1vZHVsdXM9cy5wcm90b3R5cGUubW9kLHMucHJvdG90eXBlLm1vZHVsdXNTPXMucHJvdG90eXBlLm1vZFMscy5wcm90b3R5cGUubW9kdWx1c009cy5wcm90b3R5cGUubW9kTSxzLm1vZHVsdXM9cy5tb2Qscy5wcm90b3R5cGUuYW5kPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5hbmRTKHQpOnRoaXMuYW5kTSh0KX0scy5wcm90b3R5cGUuYW5kUz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpJnQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5hbmRNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKSZ0LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5hbmQ9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkuYW5kKG8pfSxzLnByb3RvdHlwZS5vcj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMub3JTKHQpOnRoaXMub3JNKHQpfSxzLnByb3RvdHlwZS5vclM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKXx0KTtyZXR1cm4gdGhpc30scy5wcm90b3R5cGUub3JNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKXx0LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5vcj1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5vcihvKX0scy5wcm90b3R5cGUueG9yPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy54b3JTKHQpOnRoaXMueG9yTSh0KX0scy5wcm90b3R5cGUueG9yUz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpXnQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS54b3JNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKV50LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy54b3I9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkueG9yKG8pfSxzLnByb3RvdHlwZS5sZWZ0U2hpZnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmxlZnRTaGlmdFModCk6dGhpcy5sZWZ0U2hpZnRNKHQpfSxzLnByb3RvdHlwZS5sZWZ0U2hpZnRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scik8PHQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5sZWZ0U2hpZnRNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKTw8dC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMubGVmdFNoaWZ0PWZ1bmN0aW9uKHQsbyl7cmV0dXJuIG5ldyBuKHQpLmxlZnRTaGlmdChvKX0scy5wcm90b3R5cGUuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdFModCk6dGhpcy5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0TSh0KX0scy5wcm90b3R5cGUuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdFM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKT4+dCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnRNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKT4+dC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdD1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0KG8pfSxzLnByb3RvdHlwZS5yaWdodFNoaWZ0PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5yaWdodFNoaWZ0Uyh0KTp0aGlzLnJpZ2h0U2hpZnRNKHQpfSxzLnByb3RvdHlwZS5yaWdodFNoaWZ0Uz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpPj4+dCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLnJpZ2h0U2hpZnRNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKT4+PnQuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLnJpZ2h0U2hpZnQ9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkucmlnaHRTaGlmdChvKX0scy5wcm90b3R5cGUuemVyb0ZpbGxSaWdodFNoaWZ0PXMucHJvdG90eXBlLnJpZ2h0U2hpZnQscy5wcm90b3R5cGUuemVyb0ZpbGxSaWdodFNoaWZ0Uz1zLnByb3RvdHlwZS5yaWdodFNoaWZ0UyxzLnByb3RvdHlwZS56ZXJvRmlsbFJpZ2h0U2hpZnRNPXMucHJvdG90eXBlLnJpZ2h0U2hpZnRNLHMuemVyb0ZpbGxSaWdodFNoaWZ0PXMucmlnaHRTaGlmdCxzLnByb3RvdHlwZS5ub3Q9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyx+dGhpcy5nZXQodCxvKSk7cmV0dXJuIHRoaXN9LHMubm90PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5ub3QoKX0scy5wcm90b3R5cGUuYWJzPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5hYnModGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmFicz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuYWJzKCl9LHMucHJvdG90eXBlLmFjb3M9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmFjb3ModGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmFjb3M9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmFjb3MoKX0scy5wcm90b3R5cGUuYWNvc2g9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmFjb3NoKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5hY29zaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuYWNvc2goKX0scy5wcm90b3R5cGUuYXNpbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguYXNpbih0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuYXNpbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuYXNpbigpfSxzLnByb3RvdHlwZS5hc2luaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguYXNpbmgodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmFzaW5oPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5hc2luaCgpfSxzLnByb3RvdHlwZS5hdGFuPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5hdGFuKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5hdGFuPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5hdGFuKCl9LHMucHJvdG90eXBlLmF0YW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5hdGFuaCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuYXRhbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmF0YW5oKCl9LHMucHJvdG90eXBlLmNicnQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmNicnQodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmNicnQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmNicnQoKX0scy5wcm90b3R5cGUuY2VpbD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguY2VpbCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuY2VpbD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuY2VpbCgpfSxzLnByb3RvdHlwZS5jbHozMj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguY2x6MzIodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmNsejMyPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5jbHozMigpfSxzLnByb3RvdHlwZS5jb3M9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmNvcyh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuY29zPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5jb3MoKX0scy5wcm90b3R5cGUuY29zaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguY29zaCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuY29zaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuY29zaCgpfSxzLnByb3RvdHlwZS5leHA9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmV4cCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuZXhwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5leHAoKX0scy5wcm90b3R5cGUuZXhwbTE9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmV4cG0xKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5leHBtMT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuZXhwbTEoKX0scy5wcm90b3R5cGUuZmxvb3I9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmZsb29yKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5mbG9vcj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuZmxvb3IoKX0scy5wcm90b3R5cGUuZnJvdW5kPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5mcm91bmQodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmZyb3VuZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuZnJvdW5kKCl9LHMucHJvdG90eXBlLmxvZz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgubG9nKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5sb2c9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmxvZygpfSxzLnByb3RvdHlwZS5sb2cxcD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgubG9nMXAodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmxvZzFwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5sb2cxcCgpfSxzLnByb3RvdHlwZS5sb2cxMD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgubG9nMTAodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmxvZzEwPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5sb2cxMCgpfSxzLnByb3RvdHlwZS5sb2cyPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5sb2cyKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5sb2cyPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5sb2cyKCl9LHMucHJvdG90eXBlLnJvdW5kPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5yb3VuZCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMucm91bmQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLnJvdW5kKCl9LHMucHJvdG90eXBlLnNpZ249ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLnNpZ24odGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnNpZ249ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLnNpZ24oKX0scy5wcm90b3R5cGUuc2luPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5zaW4odGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnNpbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuc2luKCl9LHMucHJvdG90eXBlLnNpbmg9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLnNpbmgodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnNpbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLnNpbmgoKX0scy5wcm90b3R5cGUuc3FydD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguc3FydCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuc3FydD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuc3FydCgpfSxzLnByb3RvdHlwZS50YW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLnRhbih0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMudGFuPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS50YW4oKX0scy5wcm90b3R5cGUudGFuaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgudGFuaCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMudGFuaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkudGFuaCgpfSxzLnByb3RvdHlwZS50cnVuYz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgudHJ1bmModGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnRydW5jPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS50cnVuYygpfSxzLnBvdz1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5wb3cobyl9LHMucHJvdG90eXBlLnBvdz1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMucG93Uyh0KTp0aGlzLnBvd00odCl9LHMucHJvdG90eXBlLnBvd1M9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsTWF0aC5wb3codGhpcy5nZXQobyxyKSx0KSk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLnBvd009ZnVuY3Rpb24odCl7aWYodD1uLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scixNYXRoLnBvdyh0aGlzLmdldChvLHIpLHQuZ2V0KG8scikpKTtyZXR1cm4gdGhpc319ZnVuY3Rpb24gTyhzLG4sZSl7bGV0IHQ9ZT9zLnJvd3M6cy5yb3dzLTE7aWYobjwwfHxuPnQpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIlJvdyBpbmRleCBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiBMKHMsbixlKXtsZXQgdD1lP3MuY29sdW1uczpzLmNvbHVtbnMtMTtpZihuPDB8fG4+dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQ29sdW1uIGluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIFkocyxuKXtpZihuLnRvMURBcnJheSYmKG49bi50bzFEQXJyYXkoKSksbi5sZW5ndGghPT1zLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInZlY3RvciBzaXplIG11c3QgYmUgdGhlIHNhbWUgYXMgdGhlIG51bWJlciBvZiBjb2x1bW5zIik7cmV0dXJuIG59ZnVuY3Rpb24gWihzLG4pe2lmKG4udG8xREFycmF5JiYobj1uLnRvMURBcnJheSgpKSxuLmxlbmd0aCE9PXMucm93cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigidmVjdG9yIHNpemUgbXVzdCBiZSB0aGUgc2FtZSBhcyB0aGUgbnVtYmVyIG9mIHJvd3MiKTtyZXR1cm4gbn1mdW5jdGlvbiBMZShzLG4sZSl7cmV0dXJue3JvdzpIZShzLG4pLGNvbHVtbjpKZShzLGUpfX1mdW5jdGlvbiBIZShzLG4pe2lmKHR5cGVvZiBuIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJ1bmV4cGVjdGVkIHR5cGUgZm9yIHJvdyBpbmRpY2VzIik7aWYobi5zb21lKHQ9PnQ8MHx8dD49cy5yb3dzKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigicm93IGluZGljZXMgYXJlIG91dCBvZiByYW5nZSIpO3JldHVybiBBcnJheS5pc0FycmF5KG4pfHwobj1BcnJheS5mcm9tKG4pKSxufWZ1bmN0aW9uIEplKHMsbil7aWYodHlwZW9mIG4hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoInVuZXhwZWN0ZWQgdHlwZSBmb3IgY29sdW1uIGluZGljZXMiKTtpZihuLnNvbWUodD0+dDwwfHx0Pj1zLmNvbHVtbnMpKXRocm93IG5ldyBSYW5nZUVycm9yKCJjb2x1bW4gaW5kaWNlcyBhcmUgb3V0IG9mIHJhbmdlIik7cmV0dXJuIEFycmF5LmlzQXJyYXkobil8fChuPUFycmF5LmZyb20obikpLG59ZnVuY3Rpb24gRnQocyxuLGUsdCxvKXtpZihhcmd1bWVudHMubGVuZ3RoIT09NSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiZXhwZWN0ZWQgNCBhcmd1bWVudHMiKTtpZihydCgic3RhcnRSb3ciLG4pLHJ0KCJlbmRSb3ciLGUpLHJ0KCJzdGFydENvbHVtbiIsdCkscnQoImVuZENvbHVtbiIsbyksbj5lfHx0Pm98fG48MHx8bj49cy5yb3dzfHxlPDB8fGU+PXMucm93c3x8dDwwfHx0Pj1zLmNvbHVtbnN8fG88MHx8bz49cy5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJTdWJtYXRyaXggaW5kaWNlcyBhcmUgb3V0IG9mIHJhbmdlIil9ZnVuY3Rpb24gc3QocyxuPTApe2xldCBlPVtdO2ZvcihsZXQgdD0wO3Q8czt0KyspZS5wdXNoKG4pO3JldHVybiBlfWZ1bmN0aW9uIHJ0KHMsbil7aWYodHlwZW9mIG4hPSJudW1iZXIiKXRocm93IG5ldyBUeXBlRXJyb3IoYCR7c30gbXVzdCBiZSBhIG51bWJlcmApfWZ1bmN0aW9uIF8ocyl7aWYocy5pc0VtcHR5KCkpdGhyb3cgbmV3IEVycm9yKCJFbXB0eSBtYXRyaXggaGFzIG5vIGVsZW1lbnRzIHRvIGluZGV4Iil9ZnVuY3Rpb24gR2Uocyl7bGV0IG49c3Qocy5yb3dzKTtmb3IobGV0IGU9MDtlPHMucm93czsrK2UpZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7Kyt0KW5bZV0rPXMuZ2V0KGUsdCk7cmV0dXJuIG59ZnVuY3Rpb24gV2Uocyl7bGV0IG49c3Qocy5jb2x1bW5zKTtmb3IobGV0IGU9MDtlPHMucm93czsrK2UpZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7Kyt0KW5bdF0rPXMuZ2V0KGUsdCk7cmV0dXJuIG59ZnVuY3Rpb24gS2Uocyl7bGV0IG49MDtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKW4rPXMuZ2V0KGUsdCk7cmV0dXJuIG59ZnVuY3Rpb24gVWUocyl7bGV0IG49c3Qocy5yb3dzLDEpO2ZvcihsZXQgZT0wO2U8cy5yb3dzOysrZSlmb3IobGV0IHQ9MDt0PHMuY29sdW1uczsrK3QpbltlXSo9cy5nZXQoZSx0KTtyZXR1cm4gbn1mdW5jdGlvbiBYZShzKXtsZXQgbj1zdChzLmNvbHVtbnMsMSk7Zm9yKGxldCBlPTA7ZTxzLnJvd3M7KytlKWZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zOysrdCluW3RdKj1zLmdldChlLHQpO3JldHVybiBufWZ1bmN0aW9uIFFlKHMpe2xldCBuPTE7Zm9yKGxldCBlPTA7ZTxzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zO3QrKyluKj1zLmdldChlLHQpO3JldHVybiBufWZ1bmN0aW9uIFllKHMsbixlKXtjb25zdCB0PXMucm93cyxvPXMuY29sdW1ucyxyPVtdO2ZvcihsZXQgaT0wO2k8dDtpKyspe2xldCBoPTAsdT0wLGY9MDtmb3IobGV0IGw9MDtsPG87bCsrKWY9cy5nZXQoaSxsKS1lW2ldLGgrPWYsdSs9ZipmO24/ci5wdXNoKCh1LWgqaC9vKS8oby0xKSk6ci5wdXNoKCh1LWgqaC9vKS9vKX1yZXR1cm4gcn1mdW5jdGlvbiBaZShzLG4sZSl7Y29uc3QgdD1zLnJvd3Msbz1zLmNvbHVtbnMscj1bXTtmb3IobGV0IGk9MDtpPG87aSsrKXtsZXQgaD0wLHU9MCxmPTA7Zm9yKGxldCBsPTA7bDx0O2wrKylmPXMuZ2V0KGwsaSktZVtpXSxoKz1mLHUrPWYqZjtuP3IucHVzaCgodS1oKmgvdCkvKHQtMSkpOnIucHVzaCgodS1oKmgvdCkvdCl9cmV0dXJuIHJ9ZnVuY3Rpb24gX2UocyxuLGUpe2NvbnN0IHQ9cy5yb3dzLG89cy5jb2x1bW5zLHI9dCpvO2xldCBpPTAsaD0wLHU9MDtmb3IobGV0IGY9MDtmPHQ7ZisrKWZvcihsZXQgbD0wO2w8bztsKyspdT1zLmdldChmLGwpLWUsaSs9dSxoKz11KnU7cmV0dXJuIG4/KGgtaSppL3IpLyhyLTEpOihoLWkqaS9yKS9yfWZ1bmN0aW9uIHhlKHMsbil7Zm9yKGxldCBlPTA7ZTxzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zO3QrKylzLnNldChlLHQscy5nZXQoZSx0KS1uW2VdKX1mdW5jdGlvbiBBZShzLG4pe2ZvcihsZXQgZT0wO2U8cy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHMuY29sdW1uczt0Kyspcy5zZXQoZSx0LHMuZ2V0KGUsdCktblt0XSl9ZnVuY3Rpb24gdG4ocyxuKXtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKXMuc2V0KGUsdCxzLmdldChlLHQpLW4pfWZ1bmN0aW9uIGVuKHMpe2NvbnN0IG49W107Zm9yKGxldCBlPTA7ZTxzLnJvd3M7ZSsrKXtsZXQgdD0wO2ZvcihsZXQgbz0wO288cy5jb2x1bW5zO28rKyl0Kz1NYXRoLnBvdyhzLmdldChlLG8pLDIpLyhzLmNvbHVtbnMtMSk7bi5wdXNoKE1hdGguc3FydCh0KSl9cmV0dXJuIG59ZnVuY3Rpb24gbm4ocyxuKXtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKXMuc2V0KGUsdCxzLmdldChlLHQpL25bZV0pfWZ1bmN0aW9uIG9uKHMpe2NvbnN0IG49W107Zm9yKGxldCBlPTA7ZTxzLmNvbHVtbnM7ZSsrKXtsZXQgdD0wO2ZvcihsZXQgbz0wO288cy5yb3dzO28rKyl0Kz1NYXRoLnBvdyhzLmdldChvLGUpLDIpLyhzLnJvd3MtMSk7bi5wdXNoKE1hdGguc3FydCh0KSl9cmV0dXJuIG59ZnVuY3Rpb24gc24ocyxuKXtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKXMuc2V0KGUsdCxzLmdldChlLHQpL25bdF0pfWZ1bmN0aW9uIHJuKHMpe2NvbnN0IG49cy5zaXplLTE7bGV0IGU9MDtmb3IobGV0IHQ9MDt0PHMuY29sdW1uczt0KyspZm9yKGxldCBvPTA7bzxzLnJvd3M7bysrKWUrPU1hdGgucG93KHMuZ2V0KG8sdCksMikvbjtyZXR1cm4gTWF0aC5zcXJ0KGUpfWZ1bmN0aW9uIGhuKHMsbil7Zm9yKGxldCBlPTA7ZTxzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zO3QrKylzLnNldChlLHQscy5nZXQoZSx0KS9uKX1jbGFzcyAke3N0YXRpYyBmcm9tMURBcnJheShuLGUsdCl7aWYobiplIT09dC5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoImRhdGEgbGVuZ3RoIGRvZXMgbm90IG1hdGNoIGdpdmVuIGRpbWVuc2lvbnMiKTtsZXQgcj1uZXcgUihuLGUpO2ZvcihsZXQgaT0wO2k8bjtpKyspZm9yKGxldCBoPTA7aDxlO2grKylyLnNldChpLGgsdFtpKmUraF0pO3JldHVybiByfXN0YXRpYyByb3dWZWN0b3Iobil7bGV0IGU9bmV3IFIoMSxuLmxlbmd0aCk7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aDt0KyspZS5zZXQoMCx0LG5bdF0pO3JldHVybiBlfXN0YXRpYyBjb2x1bW5WZWN0b3Iobil7bGV0IGU9bmV3IFIobi5sZW5ndGgsMSk7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aDt0KyspZS5zZXQodCwwLG5bdF0pO3JldHVybiBlfXN0YXRpYyB6ZXJvcyhuLGUpe3JldHVybiBuZXcgUihuLGUpfXN0YXRpYyBvbmVzKG4sZSl7cmV0dXJuIG5ldyBSKG4sZSkuZmlsbCgxKX1zdGF0aWMgcmFuZChuLGUsdD17fSl7aWYodHlwZW9mIHQhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtyYW5kb206bz1NYXRoLnJhbmRvbX09dDtsZXQgcj1uZXcgUihuLGUpO2ZvcihsZXQgaT0wO2k8bjtpKyspZm9yKGxldCBoPTA7aDxlO2grKylyLnNldChpLGgsbygpKTtyZXR1cm4gcn1zdGF0aWMgcmFuZEludChuLGUsdD17fSl7aWYodHlwZW9mIHQhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46bz0wLG1heDpyPTFlMyxyYW5kb206aT1NYXRoLnJhbmRvbX09dDtpZighTnVtYmVyLmlzSW50ZWdlcihvKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhbiBpbnRlZ2VyIik7aWYoIU51bWJlci5pc0ludGVnZXIocikpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYW4gaW50ZWdlciIpO2lmKG8+PXIpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbiBtdXN0IGJlIHNtYWxsZXIgdGhhbiBtYXgiKTtsZXQgaD1yLW8sdT1uZXcgUihuLGUpO2ZvcihsZXQgZj0wO2Y8bjtmKyspZm9yKGxldCBsPTA7bDxlO2wrKyl7bGV0IG09bytNYXRoLnJvdW5kKGkoKSpoKTt1LnNldChmLGwsbSl9cmV0dXJuIHV9c3RhdGljIGV5ZShuLGUsdCl7ZT09PXZvaWQgMCYmKGU9biksdD09PXZvaWQgMCYmKHQ9MSk7bGV0IG89TWF0aC5taW4obixlKSxyPXRoaXMuemVyb3MobixlKTtmb3IobGV0IGk9MDtpPG87aSsrKXIuc2V0KGksaSx0KTtyZXR1cm4gcn1zdGF0aWMgZGlhZyhuLGUsdCl7bGV0IG89bi5sZW5ndGg7ZT09PXZvaWQgMCYmKGU9byksdD09PXZvaWQgMCYmKHQ9ZSk7bGV0IHI9TWF0aC5taW4obyxlLHQpLGk9dGhpcy56ZXJvcyhlLHQpO2ZvcihsZXQgaD0wO2g8cjtoKyspaS5zZXQoaCxoLG5baF0pO3JldHVybiBpfXN0YXRpYyBtaW4obixlKXtuPXRoaXMuY2hlY2tNYXRyaXgobiksZT10aGlzLmNoZWNrTWF0cml4KGUpO2xldCB0PW4ucm93cyxvPW4uY29sdW1ucyxyPW5ldyBSKHQsbyk7Zm9yKGxldCBpPTA7aTx0O2krKylmb3IobGV0IGg9MDtoPG87aCsrKXIuc2V0KGksaCxNYXRoLm1pbihuLmdldChpLGgpLGUuZ2V0KGksaCkpKTtyZXR1cm4gcn1zdGF0aWMgbWF4KG4sZSl7bj10aGlzLmNoZWNrTWF0cml4KG4pLGU9dGhpcy5jaGVja01hdHJpeChlKTtsZXQgdD1uLnJvd3Msbz1uLmNvbHVtbnMscj1uZXcgdGhpcyh0LG8pO2ZvcihsZXQgaT0wO2k8dDtpKyspZm9yKGxldCBoPTA7aDxvO2grKylyLnNldChpLGgsTWF0aC5tYXgobi5nZXQoaSxoKSxlLmdldChpLGgpKSk7cmV0dXJuIHJ9c3RhdGljIGNoZWNrTWF0cml4KG4pe3JldHVybiAkLmlzTWF0cml4KG4pP246bmV3IFIobil9c3RhdGljIGlzTWF0cml4KG4pe3JldHVybiBuIT1udWxsJiZuLmtsYXNzPT09Ik1hdHJpeCJ9Z2V0IHNpemUoKXtyZXR1cm4gdGhpcy5yb3dzKnRoaXMuY29sdW1uc31hcHBseShuKXtpZih0eXBlb2YgbiE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgVHlwZUVycm9yKCJjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24iKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW4uY2FsbCh0aGlzLGUsdCk7cmV0dXJuIHRoaXN9dG8xREFycmF5KCl7bGV0IG49W107Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyluLnB1c2godGhpcy5nZXQoZSx0KSk7cmV0dXJuIG59dG8yREFycmF5KCl7bGV0IG49W107Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKXtuLnB1c2goW10pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyluW2VdLnB1c2godGhpcy5nZXQoZSx0KSl9cmV0dXJuIG59dG9KU09OKCl7cmV0dXJuIHRoaXMudG8yREFycmF5KCl9aXNSb3dWZWN0b3IoKXtyZXR1cm4gdGhpcy5yb3dzPT09MX1pc0NvbHVtblZlY3Rvcigpe3JldHVybiB0aGlzLmNvbHVtbnM9PT0xfWlzVmVjdG9yKCl7cmV0dXJuIHRoaXMucm93cz09PTF8fHRoaXMuY29sdW1ucz09PTF9aXNTcXVhcmUoKXtyZXR1cm4gdGhpcy5yb3dzPT09dGhpcy5jb2x1bW5zfWlzRW1wdHkoKXtyZXR1cm4gdGhpcy5yb3dzPT09MHx8dGhpcy5jb2x1bW5zPT09MH1pc1N5bW1ldHJpYygpe2lmKHRoaXMuaXNTcXVhcmUoKSl7Zm9yKGxldCBuPTA7bjx0aGlzLnJvd3M7bisrKWZvcihsZXQgZT0wO2U8PW47ZSsrKWlmKHRoaXMuZ2V0KG4sZSkhPT10aGlzLmdldChlLG4pKXJldHVybiExO3JldHVybiEwfXJldHVybiExfWlzRWNoZWxvbkZvcm0oKXtsZXQgbj0wLGU9MCx0PS0xLG89ITAscj0hMTtmb3IoO248dGhpcy5yb3dzJiZvOyl7Zm9yKGU9MCxyPSExO2U8dGhpcy5jb2x1bW5zJiZyPT09ITE7KXRoaXMuZ2V0KG4sZSk9PT0wP2UrKzp0aGlzLmdldChuLGUpPT09MSYmZT50PyhyPSEwLHQ9ZSk6KG89ITEscj0hMCk7bisrfXJldHVybiBvfWlzUmVkdWNlZEVjaGVsb25Gb3JtKCl7bGV0IG49MCxlPTAsdD0tMSxvPSEwLHI9ITE7Zm9yKDtuPHRoaXMucm93cyYmbzspe2ZvcihlPTAscj0hMTtlPHRoaXMuY29sdW1ucyYmcj09PSExOyl0aGlzLmdldChuLGUpPT09MD9lKys6dGhpcy5nZXQobixlKT09PTEmJmU+dD8ocj0hMCx0PWUpOihvPSExLHI9ITApO2ZvcihsZXQgaT1lKzE7aTx0aGlzLnJvd3M7aSsrKXRoaXMuZ2V0KG4saSkhPT0wJiYobz0hMSk7bisrfXJldHVybiBvfWVjaGVsb25Gb3JtKCl7bGV0IG49dGhpcy5jbG9uZSgpLGU9MCx0PTA7Zm9yKDtlPG4ucm93cyYmdDxuLmNvbHVtbnM7KXtsZXQgbz1lO2ZvcihsZXQgcj1lO3I8bi5yb3dzO3IrKyluLmdldChyLHQpPm4uZ2V0KG8sdCkmJihvPXIpO2lmKG4uZ2V0KG8sdCk9PT0wKXQrKztlbHNle24uc3dhcFJvd3MoZSxvKTtsZXQgcj1uLmdldChlLHQpO2ZvcihsZXQgaT10O2k8bi5jb2x1bW5zO2krKyluLnNldChlLGksbi5nZXQoZSxpKS9yKTtmb3IobGV0IGk9ZSsxO2k8bi5yb3dzO2krKyl7bGV0IGg9bi5nZXQoaSx0KS9uLmdldChlLHQpO24uc2V0KGksdCwwKTtmb3IobGV0IHU9dCsxO3U8bi5jb2x1bW5zO3UrKyluLnNldChpLHUsbi5nZXQoaSx1KS1uLmdldChlLHUpKmgpfWUrKyx0Kyt9fXJldHVybiBufXJlZHVjZWRFY2hlbG9uRm9ybSgpe2xldCBuPXRoaXMuZWNoZWxvbkZvcm0oKSxlPW4uY29sdW1ucyx0PW4ucm93cyxvPXQtMTtmb3IoO28+PTA7KWlmKG4ubWF4Um93KG8pPT09MClvLS07ZWxzZXtsZXQgcj0wLGk9ITE7Zm9yKDtyPHQmJmk9PT0hMTspbi5nZXQobyxyKT09PTE/aT0hMDpyKys7Zm9yKGxldCBoPTA7aDxvO2grKyl7bGV0IHU9bi5nZXQoaCxyKTtmb3IobGV0IGY9cjtmPGU7ZisrKXtsZXQgbD1uLmdldChoLGYpLXUqbi5nZXQobyxmKTtuLnNldChoLGYsbCl9fW8tLX1yZXR1cm4gbn1zZXQoKXt0aHJvdyBuZXcgRXJyb3IoInNldCBtZXRob2QgaXMgdW5pbXBsZW1lbnRlZCIpfWdldCgpe3Rocm93IG5ldyBFcnJvcigiZ2V0IG1ldGhvZCBpcyB1bmltcGxlbWVudGVkIil9cmVwZWF0KG49e30pe2lmKHR5cGVvZiBuIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7Y29uc3R7cm93czplPTEsY29sdW1uczp0PTF9PW47aWYoIU51bWJlci5pc0ludGVnZXIoZSl8fGU8PTApdGhyb3cgbmV3IFR5cGVFcnJvcigicm93cyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciIpO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKHQpfHx0PD0wKXRocm93IG5ldyBUeXBlRXJyb3IoImNvbHVtbnMgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIiKTtsZXQgbz1uZXcgUih0aGlzLnJvd3MqZSx0aGlzLmNvbHVtbnMqdCk7Zm9yKGxldCByPTA7cjxlO3IrKylmb3IobGV0IGk9MDtpPHQ7aSsrKW8uc2V0U3ViTWF0cml4KHRoaXMsdGhpcy5yb3dzKnIsdGhpcy5jb2x1bW5zKmkpO3JldHVybiBvfWZpbGwobil7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChlLHQsbik7cmV0dXJuIHRoaXN9bmVnKCl7cmV0dXJuIHRoaXMubXVsUygtMSl9Z2V0Um93KG4pe08odGhpcyxuKTtsZXQgZT1bXTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspZS5wdXNoKHRoaXMuZ2V0KG4sdCkpO3JldHVybiBlfWdldFJvd1ZlY3RvcihuKXtyZXR1cm4gUi5yb3dWZWN0b3IodGhpcy5nZXRSb3cobikpfXNldFJvdyhuLGUpe08odGhpcyxuKSxlPVkodGhpcyxlKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LGVbdF0pO3JldHVybiB0aGlzfXN3YXBSb3dzKG4sZSl7Tyh0aGlzLG4pLE8odGhpcyxlKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspe2xldCBvPXRoaXMuZ2V0KG4sdCk7dGhpcy5zZXQobix0LHRoaXMuZ2V0KGUsdCkpLHRoaXMuc2V0KGUsdCxvKX1yZXR1cm4gdGhpc31nZXRDb2x1bW4obil7TCh0aGlzLG4pO2xldCBlPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyllLnB1c2godGhpcy5nZXQodCxuKSk7cmV0dXJuIGV9Z2V0Q29sdW1uVmVjdG9yKG4pe3JldHVybiBSLmNvbHVtblZlY3Rvcih0aGlzLmdldENvbHVtbihuKSl9c2V0Q29sdW1uKG4sZSl7TCh0aGlzLG4pLGU9Wih0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLnNldCh0LG4sZVt0XSk7cmV0dXJuIHRoaXN9c3dhcENvbHVtbnMobixlKXtMKHRoaXMsbiksTCh0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl7bGV0IG89dGhpcy5nZXQodCxuKTt0aGlzLnNldCh0LG4sdGhpcy5nZXQodCxlKSksdGhpcy5zZXQodCxlLG8pfXJldHVybiB0aGlzfWFkZFJvd1ZlY3RvcihuKXtuPVkodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpK25bdF0pO3JldHVybiB0aGlzfXN1YlJvd1ZlY3RvcihuKXtuPVkodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpLW5bdF0pO3JldHVybiB0aGlzfW11bFJvd1ZlY3RvcihuKXtuPVkodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpKm5bdF0pO3JldHVybiB0aGlzfWRpdlJvd1ZlY3RvcihuKXtuPVkodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpL25bdF0pO3JldHVybiB0aGlzfWFkZENvbHVtblZlY3RvcihuKXtuPVoodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpK25bZV0pO3JldHVybiB0aGlzfXN1YkNvbHVtblZlY3RvcihuKXtuPVoodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpLW5bZV0pO3JldHVybiB0aGlzfW11bENvbHVtblZlY3RvcihuKXtuPVoodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpKm5bZV0pO3JldHVybiB0aGlzfWRpdkNvbHVtblZlY3RvcihuKXtuPVoodGhpcyxuKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCx0aGlzLmdldChlLHQpL25bZV0pO3JldHVybiB0aGlzfW11bFJvdyhuLGUpe08odGhpcyxuKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQobix0LHRoaXMuZ2V0KG4sdCkqZSk7cmV0dXJuIHRoaXN9bXVsQ29sdW1uKG4sZSl7TCh0aGlzLG4pO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLnNldCh0LG4sdGhpcy5nZXQodCxuKSplKTtyZXR1cm4gdGhpc31tYXgoKXtpZih0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBuPXRoaXMuZ2V0KDAsMCk7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLmdldChlLHQpPm4mJihuPXRoaXMuZ2V0KGUsdCkpO3JldHVybiBufW1heEluZGV4KCl7Xyh0aGlzKTtsZXQgbj10aGlzLmdldCgwLDApLGU9WzAsMF07Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLmdldCh0LG8pPm4mJihuPXRoaXMuZ2V0KHQsbyksZVswXT10LGVbMV09byk7cmV0dXJuIGV9bWluKCl7aWYodGhpcy5pc0VtcHR5KCkpcmV0dXJuIE5hTjtsZXQgbj10aGlzLmdldCgwLDApO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5nZXQoZSx0KTxuJiYobj10aGlzLmdldChlLHQpKTtyZXR1cm4gbn1taW5JbmRleCgpe18odGhpcyk7bGV0IG49dGhpcy5nZXQoMCwwKSxlPVswLDBdO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5nZXQodCxvKTxuJiYobj10aGlzLmdldCh0LG8pLGVbMF09dCxlWzFdPW8pO3JldHVybiBlfW1heFJvdyhuKXtpZihPKHRoaXMsbiksdGhpcy5pc0VtcHR5KCkpcmV0dXJuIE5hTjtsZXQgZT10aGlzLmdldChuLDApO2ZvcihsZXQgdD0xO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLmdldChuLHQpPmUmJihlPXRoaXMuZ2V0KG4sdCkpO3JldHVybiBlfW1heFJvd0luZGV4KG4pe08odGhpcyxuKSxfKHRoaXMpO2xldCBlPXRoaXMuZ2V0KG4sMCksdD1bbiwwXTtmb3IobGV0IG89MTtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5nZXQobixvKT5lJiYoZT10aGlzLmdldChuLG8pLHRbMV09byk7cmV0dXJuIHR9bWluUm93KG4pe2lmKE8odGhpcyxuKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBlPXRoaXMuZ2V0KG4sMCk7Zm9yKGxldCB0PTE7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KG4sdCk8ZSYmKGU9dGhpcy5nZXQobix0KSk7cmV0dXJuIGV9bWluUm93SW5kZXgobil7Tyh0aGlzLG4pLF8odGhpcyk7bGV0IGU9dGhpcy5nZXQobiwwKSx0PVtuLDBdO2ZvcihsZXQgbz0xO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLmdldChuLG8pPGUmJihlPXRoaXMuZ2V0KG4sbyksdFsxXT1vKTtyZXR1cm4gdH1tYXhDb2x1bW4obil7aWYoTCh0aGlzLG4pLHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQoMCxuKTtmb3IobGV0IHQ9MTt0PHRoaXMucm93czt0KyspdGhpcy5nZXQodCxuKT5lJiYoZT10aGlzLmdldCh0LG4pKTtyZXR1cm4gZX1tYXhDb2x1bW5JbmRleChuKXtMKHRoaXMsbiksXyh0aGlzKTtsZXQgZT10aGlzLmdldCgwLG4pLHQ9WzAsbl07Zm9yKGxldCBvPTE7bzx0aGlzLnJvd3M7bysrKXRoaXMuZ2V0KG8sbik+ZSYmKGU9dGhpcy5nZXQobyxuKSx0WzBdPW8pO3JldHVybiB0fW1pbkNvbHVtbihuKXtpZihMKHRoaXMsbiksdGhpcy5pc0VtcHR5KCkpcmV0dXJuIE5hTjtsZXQgZT10aGlzLmdldCgwLG4pO2ZvcihsZXQgdD0xO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLmdldCh0LG4pPGUmJihlPXRoaXMuZ2V0KHQsbikpO3JldHVybiBlfW1pbkNvbHVtbkluZGV4KG4pe0wodGhpcyxuKSxfKHRoaXMpO2xldCBlPXRoaXMuZ2V0KDAsbiksdD1bMCxuXTtmb3IobGV0IG89MTtvPHRoaXMucm93cztvKyspdGhpcy5nZXQobyxuKTxlJiYoZT10aGlzLmdldChvLG4pLHRbMF09byk7cmV0dXJuIHR9ZGlhZygpe2xldCBuPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLGU9W107Zm9yKGxldCB0PTA7dDxuO3QrKyllLnB1c2godGhpcy5nZXQodCx0KSk7cmV0dXJuIGV9bm9ybShuPSJmcm9iZW5pdXMiKXtsZXQgZT0wO2lmKG49PT0ibWF4IilyZXR1cm4gdGhpcy5tYXgoKTtpZihuPT09ImZyb2Jlbml1cyIpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspZT1lK3RoaXMuZ2V0KHQsbykqdGhpcy5nZXQodCxvKTtyZXR1cm4gTWF0aC5zcXJ0KGUpfWVsc2UgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYHVua25vd24gbm9ybSB0eXBlOiAke259YCl9Y3VtdWxhdGl2ZVN1bSgpe2xldCBuPTA7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyluKz10aGlzLmdldChlLHQpLHRoaXMuc2V0KGUsdCxuKTtyZXR1cm4gdGhpc31kb3Qobil7JC5pc01hdHJpeChuKSYmKG49bi50bzFEQXJyYXkoKSk7bGV0IGU9dGhpcy50bzFEQXJyYXkoKTtpZihlLmxlbmd0aCE9PW4ubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJ2ZWN0b3JzIGRvIG5vdCBoYXZlIHRoZSBzYW1lIHNpemUiKTtsZXQgdD0wO2ZvcihsZXQgbz0wO288ZS5sZW5ndGg7bysrKXQrPWVbb10qbltvXTtyZXR1cm4gdH1tbXVsKG4pe249Ui5jaGVja01hdHJpeChuKTtsZXQgZT10aGlzLnJvd3MsdD10aGlzLmNvbHVtbnMsbz1uLmNvbHVtbnMscj1uZXcgUihlLG8pLGk9bmV3IEZsb2F0NjRBcnJheSh0KTtmb3IobGV0IGg9MDtoPG87aCsrKXtmb3IobGV0IHU9MDt1PHQ7dSsrKWlbdV09bi5nZXQodSxoKTtmb3IobGV0IHU9MDt1PGU7dSsrKXtsZXQgZj0wO2ZvcihsZXQgbD0wO2w8dDtsKyspZis9dGhpcy5nZXQodSxsKSppW2xdO3Iuc2V0KHUsaCxmKX19cmV0dXJuIHJ9c3RyYXNzZW4yeDIobil7bj1SLmNoZWNrTWF0cml4KG4pO2xldCBlPW5ldyBSKDIsMik7Y29uc3QgdD10aGlzLmdldCgwLDApLG89bi5nZXQoMCwwKSxyPXRoaXMuZ2V0KDAsMSksaT1uLmdldCgwLDEpLGg9dGhpcy5nZXQoMSwwKSx1PW4uZ2V0KDEsMCksZj10aGlzLmdldCgxLDEpLGw9bi5nZXQoMSwxKSxtPSh0K2YpKihvK2wpLGE9KGgrZikqbyxqPXQqKGktbCksdj1mKih1LW8pLHk9KHQrcikqbCxkPShoLXQpKihvK2kpLGM9KHItZikqKHUrbCksdz1tK3YteStjLGc9ait5LHA9YSt2LEU9bS1hK2orZDtyZXR1cm4gZS5zZXQoMCwwLHcpLGUuc2V0KDAsMSxnKSxlLnNldCgxLDAscCksZS5zZXQoMSwxLEUpLGV9c3RyYXNzZW4zeDMobil7bj1SLmNoZWNrTWF0cml4KG4pO2xldCBlPW5ldyBSKDMsMyk7Y29uc3QgdD10aGlzLmdldCgwLDApLG89dGhpcy5nZXQoMCwxKSxyPXRoaXMuZ2V0KDAsMiksaT10aGlzLmdldCgxLDApLGg9dGhpcy5nZXQoMSwxKSx1PXRoaXMuZ2V0KDEsMiksZj10aGlzLmdldCgyLDApLGw9dGhpcy5nZXQoMiwxKSxtPXRoaXMuZ2V0KDIsMiksYT1uLmdldCgwLDApLGo9bi5nZXQoMCwxKSx2PW4uZ2V0KDAsMikseT1uLmdldCgxLDApLGQ9bi5nZXQoMSwxKSxjPW4uZ2V0KDEsMiksdz1uLmdldCgyLDApLGc9bi5nZXQoMiwxKSxwPW4uZ2V0KDIsMiksRT0odCtvK3ItaS1oLWwtbSkqZCxTPSh0LWkpKigtaitkKSxrPWgqKC1hK2oreS1kLWMtdytwKSxxPSgtdCtpK2gpKihhLWorZCksRj0oaStoKSooLWEraiksST10KmEsVj0oLXQrZitsKSooYS12K2MpLEM9KC10K2YpKih2LWMpLEc9KGYrbCkqKC1hK3YpLFU9KHQrbytyLWgtdS1mLWwpKmMsWD1sKigtYSt2K3ktZC1jLXcrZyksej0oLXIrbCttKSooZCt3LWcpLEs9KHItbSkqKGQtZyksUD1yKncsRD0obCttKSooLXcrZyksTj0oLXIraCt1KSooYyt3LXApLGV0PShyLXUpKihjLXApLG50PShoK3UpKigtdytwKSxjdD1vKnksd3Q9dSpnLGd0PWkqdixtdD1mKmoscHQ9bSpwLGF0PUkrUCtjdCxkdD1FK3ErRitJK3orUCtELHl0PUkrVitHK1UrUCtOK250LGp0PVMraytxK0krUCtOK2V0LHZ0PVMrcStGK0krd3QsU3Q9UCtOK2V0K250K2d0LEV0PUkrVitDK1greitLK1AsTXQ9eitLK1ArRCttdCxrdD1JK1YrQytHK3B0O3JldHVybiBlLnNldCgwLDAsYXQpLGUuc2V0KDAsMSxkdCksZS5zZXQoMCwyLHl0KSxlLnNldCgxLDAsanQpLGUuc2V0KDEsMSx2dCksZS5zZXQoMSwyLFN0KSxlLnNldCgyLDAsRXQpLGUuc2V0KDIsMSxNdCksZS5zZXQoMiwyLGt0KSxlfW1tdWxTdHJhc3NlbihuKXtuPVIuY2hlY2tNYXRyaXgobik7bGV0IGU9dGhpcy5jbG9uZSgpLHQ9ZS5yb3dzLG89ZS5jb2x1bW5zLHI9bi5yb3dzLGk9bi5jb2x1bW5zO28hPT1yJiZjb25zb2xlLndhcm4oYE11bHRpcGx5aW5nICR7dH0geCAke299IGFuZCAke3J9IHggJHtpfSBtYXRyaXg6IGRpbWVuc2lvbnMgZG8gbm90IG1hdGNoLmApO2Z1bmN0aW9uIGgobSxhLGope2xldCB2PW0ucm93cyx5PW0uY29sdW1ucztpZih2PT09YSYmeT09PWopcmV0dXJuIG07e2xldCBkPSQuemVyb3MoYSxqKTtyZXR1cm4gZD1kLnNldFN1Yk1hdHJpeChtLDAsMCksZH19bGV0IHU9TWF0aC5tYXgodCxyKSxmPU1hdGgubWF4KG8saSk7ZT1oKGUsdSxmKSxuPWgobix1LGYpO2Z1bmN0aW9uIGwobSxhLGosdil7aWYoajw9NTEyfHx2PD01MTIpcmV0dXJuIG0ubW11bChhKTtqJTI9PTEmJnYlMj09MT8obT1oKG0saisxLHYrMSksYT1oKGEsaisxLHYrMSkpOmolMj09MT8obT1oKG0saisxLHYpLGE9aChhLGorMSx2KSk6diUyPT0xJiYobT1oKG0saix2KzEpLGE9aChhLGosdisxKSk7bGV0IHk9cGFyc2VJbnQobS5yb3dzLzIsMTApLGQ9cGFyc2VJbnQobS5jb2x1bW5zLzIsMTApLGM9bS5zdWJNYXRyaXgoMCx5LTEsMCxkLTEpLHc9YS5zdWJNYXRyaXgoMCx5LTEsMCxkLTEpLGc9bS5zdWJNYXRyaXgoMCx5LTEsZCxtLmNvbHVtbnMtMSkscD1hLnN1Yk1hdHJpeCgwLHktMSxkLGEuY29sdW1ucy0xKSxFPW0uc3ViTWF0cml4KHksbS5yb3dzLTEsMCxkLTEpLFM9YS5zdWJNYXRyaXgoeSxhLnJvd3MtMSwwLGQtMSksaz1tLnN1Yk1hdHJpeCh5LG0ucm93cy0xLGQsbS5jb2x1bW5zLTEpLHE9YS5zdWJNYXRyaXgoeSxhLnJvd3MtMSxkLGEuY29sdW1ucy0xKSxGPWwoJC5hZGQoYyxrKSwkLmFkZCh3LHEpLHksZCksST1sKCQuYWRkKEUsayksdyx5LGQpLFY9bChjLCQuc3ViKHAscSkseSxkKSxDPWwoaywkLnN1YihTLHcpLHksZCksRz1sKCQuYWRkKGMsZykscSx5LGQpLFU9bCgkLnN1YihFLGMpLCQuYWRkKHcscCkseSxkKSxYPWwoJC5zdWIoZyxrKSwkLmFkZChTLHEpLHksZCksej0kLmFkZChGLEMpO3ouc3ViKEcpLHouYWRkKFgpO2xldCBLPSQuYWRkKFYsRyksUD0kLmFkZChJLEMpLEQ9JC5zdWIoRixJKTtELmFkZChWKSxELmFkZChVKTtsZXQgTj0kLnplcm9zKDIqei5yb3dzLDIqei5jb2x1bW5zKTtyZXR1cm4gTj1OLnNldFN1Yk1hdHJpeCh6LDAsMCksTj1OLnNldFN1Yk1hdHJpeChLLHoucm93cywwKSxOPU4uc2V0U3ViTWF0cml4KFAsMCx6LmNvbHVtbnMpLE49Ti5zZXRTdWJNYXRyaXgoRCx6LnJvd3Msei5jb2x1bW5zKSxOLnN1Yk1hdHJpeCgwLGotMSwwLHYtMSl9cmV0dXJuIGwoZSxuLHUsZil9c2NhbGVSb3dzKG49e30pe2lmKHR5cGVvZiBuIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7Y29uc3R7bWluOmU9MCxtYXg6dD0xfT1uO2lmKCFOdW1iZXIuaXNGaW5pdGUoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWluIG11c3QgYmUgYSBudW1iZXIiKTtpZighTnVtYmVyLmlzRmluaXRlKHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIm1heCBtdXN0IGJlIGEgbnVtYmVyIik7aWYoZT49dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigibWluIG11c3QgYmUgc21hbGxlciB0aGFuIG1heCIpO2xldCBvPW5ldyBSKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKyl7Y29uc3QgaT10aGlzLmdldFJvdyhyKTtpLmxlbmd0aD4wJiZJdChpLHttaW46ZSxtYXg6dCxvdXRwdXQ6aX0pLG8uc2V0Um93KHIsaSl9cmV0dXJuIG99c2NhbGVDb2x1bW5zKG49e30pe2lmKHR5cGVvZiBuIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7Y29uc3R7bWluOmU9MCxtYXg6dD0xfT1uO2lmKCFOdW1iZXIuaXNGaW5pdGUoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWluIG11c3QgYmUgYSBudW1iZXIiKTtpZighTnVtYmVyLmlzRmluaXRlKHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIm1heCBtdXN0IGJlIGEgbnVtYmVyIik7aWYoZT49dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigibWluIG11c3QgYmUgc21hbGxlciB0aGFuIG1heCIpO2xldCBvPW5ldyBSKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpO2ZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl7Y29uc3QgaT10aGlzLmdldENvbHVtbihyKTtpLmxlbmd0aCYmSXQoaSx7bWluOmUsbWF4OnQsb3V0cHV0Oml9KSxvLnNldENvbHVtbihyLGkpfXJldHVybiBvfWZsaXBSb3dzKCl7Y29uc3Qgbj1NYXRoLmNlaWwodGhpcy5jb2x1bW5zLzIpO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PG47dCsrKXtsZXQgbz10aGlzLmdldChlLHQpLHI9dGhpcy5nZXQoZSx0aGlzLmNvbHVtbnMtMS10KTt0aGlzLnNldChlLHQsciksdGhpcy5zZXQoZSx0aGlzLmNvbHVtbnMtMS10LG8pfXJldHVybiB0aGlzfWZsaXBDb2x1bW5zKCl7Y29uc3Qgbj1NYXRoLmNlaWwodGhpcy5yb3dzLzIpO2ZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKylmb3IobGV0IHQ9MDt0PG47dCsrKXtsZXQgbz10aGlzLmdldCh0LGUpLHI9dGhpcy5nZXQodGhpcy5yb3dzLTEtdCxlKTt0aGlzLnNldCh0LGUsciksdGhpcy5zZXQodGhpcy5yb3dzLTEtdCxlLG8pfXJldHVybiB0aGlzfWtyb25lY2tlclByb2R1Y3Qobil7bj1SLmNoZWNrTWF0cml4KG4pO2xldCBlPXRoaXMucm93cyx0PXRoaXMuY29sdW1ucyxvPW4ucm93cyxyPW4uY29sdW1ucyxpPW5ldyBSKGUqbyx0KnIpO2ZvcihsZXQgaD0wO2g8ZTtoKyspZm9yKGxldCB1PTA7dTx0O3UrKylmb3IobGV0IGY9MDtmPG87ZisrKWZvcihsZXQgbD0wO2w8cjtsKyspaS5zZXQobypoK2Yscip1K2wsdGhpcy5nZXQoaCx1KSpuLmdldChmLGwpKTtyZXR1cm4gaX1rcm9uZWNrZXJTdW0obil7aWYobj1SLmNoZWNrTWF0cml4KG4pLCF0aGlzLmlzU3F1YXJlKCl8fCFuLmlzU3F1YXJlKCkpdGhyb3cgbmV3IEVycm9yKCJLcm9uZWNrZXIgU3VtIG5lZWRzIHR3byBTcXVhcmUgTWF0cmljZXMiKTtsZXQgZT10aGlzLnJvd3MsdD1uLnJvd3Msbz10aGlzLmtyb25lY2tlclByb2R1Y3QoUi5leWUodCx0KSkscj1SLmV5ZShlLGUpLmtyb25lY2tlclByb2R1Y3Qobik7cmV0dXJuIG8uYWRkKHIpfXRyYW5zcG9zZSgpe2xldCBuPW5ldyBSKHRoaXMuY29sdW1ucyx0aGlzLnJvd3MpO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspbi5zZXQodCxlLHRoaXMuZ2V0KGUsdCkpO3JldHVybiBufXNvcnRSb3dzKG49VnQpe2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKyl0aGlzLnNldFJvdyhlLHRoaXMuZ2V0Um93KGUpLnNvcnQobikpO3JldHVybiB0aGlzfXNvcnRDb2x1bW5zKG49VnQpe2ZvcihsZXQgZT0wO2U8dGhpcy5jb2x1bW5zO2UrKyl0aGlzLnNldENvbHVtbihlLHRoaXMuZ2V0Q29sdW1uKGUpLnNvcnQobikpO3JldHVybiB0aGlzfXN1Yk1hdHJpeChuLGUsdCxvKXtGdCh0aGlzLG4sZSx0LG8pO2xldCByPW5ldyBSKGUtbisxLG8tdCsxKTtmb3IobGV0IGk9bjtpPD1lO2krKylmb3IobGV0IGg9dDtoPD1vO2grKylyLnNldChpLW4saC10LHRoaXMuZ2V0KGksaCkpO3JldHVybiByfXN1Yk1hdHJpeFJvdyhuLGUsdCl7aWYoZT09PXZvaWQgMCYmKGU9MCksdD09PXZvaWQgMCYmKHQ9dGhpcy5jb2x1bW5zLTEpLGU+dHx8ZTwwfHxlPj10aGlzLmNvbHVtbnN8fHQ8MHx8dD49dGhpcy5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJBcmd1bWVudCBvdXQgb2YgcmFuZ2UiKTtsZXQgbz1uZXcgUihuLmxlbmd0aCx0LWUrMSk7Zm9yKGxldCByPTA7cjxuLmxlbmd0aDtyKyspZm9yKGxldCBpPWU7aTw9dDtpKyspe2lmKG5bcl08MHx8bltyXT49dGhpcy5yb3dzKXRocm93IG5ldyBSYW5nZUVycm9yKGBSb3cgaW5kZXggb3V0IG9mIHJhbmdlOiAke25bcl19YCk7by5zZXQocixpLWUsdGhpcy5nZXQobltyXSxpKSl9cmV0dXJuIG99c3ViTWF0cml4Q29sdW1uKG4sZSx0KXtpZihlPT09dm9pZCAwJiYoZT0wKSx0PT09dm9pZCAwJiYodD10aGlzLnJvd3MtMSksZT50fHxlPDB8fGU+PXRoaXMucm93c3x8dDwwfHx0Pj10aGlzLnJvd3MpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkFyZ3VtZW50IG91dCBvZiByYW5nZSIpO2xldCBvPW5ldyBSKHQtZSsxLG4ubGVuZ3RoKTtmb3IobGV0IHI9MDtyPG4ubGVuZ3RoO3IrKylmb3IobGV0IGk9ZTtpPD10O2krKyl7aWYobltyXTwwfHxuW3JdPj10aGlzLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoYENvbHVtbiBpbmRleCBvdXQgb2YgcmFuZ2U6ICR7bltyXX1gKTtvLnNldChpLWUscix0aGlzLmdldChpLG5bcl0pKX1yZXR1cm4gb31zZXRTdWJNYXRyaXgobixlLHQpe2lmKG49Ui5jaGVja01hdHJpeChuKSxuLmlzRW1wdHkoKSlyZXR1cm4gdGhpcztsZXQgbz1lK24ucm93cy0xLHI9dCtuLmNvbHVtbnMtMTtGdCh0aGlzLGUsbyx0LHIpO2ZvcihsZXQgaT0wO2k8bi5yb3dzO2krKylmb3IobGV0IGg9MDtoPG4uY29sdW1ucztoKyspdGhpcy5zZXQoZStpLHQraCxuLmdldChpLGgpKTtyZXR1cm4gdGhpc31zZWxlY3Rpb24obixlKXtsZXQgdD1MZSh0aGlzLG4sZSksbz1uZXcgUihuLmxlbmd0aCxlLmxlbmd0aCk7Zm9yKGxldCByPTA7cjx0LnJvdy5sZW5ndGg7cisrKXtsZXQgaT10LnJvd1tyXTtmb3IobGV0IGg9MDtoPHQuY29sdW1uLmxlbmd0aDtoKyspe2xldCB1PXQuY29sdW1uW2hdO28uc2V0KHIsaCx0aGlzLmdldChpLHUpKX19cmV0dXJuIG99dHJhY2UoKXtsZXQgbj1NYXRoLm1pbih0aGlzLnJvd3MsdGhpcy5jb2x1bW5zKSxlPTA7Zm9yKGxldCB0PTA7dDxuO3QrKyllKz10aGlzLmdldCh0LHQpO3JldHVybiBlfWNsb25lKCl7bGV0IG49bmV3IFIodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyluLnNldChlLHQsdGhpcy5nZXQoZSx0KSk7cmV0dXJuIG59c3VtKG4pe3N3aXRjaChuKXtjYXNlInJvdyI6cmV0dXJuIEdlKHRoaXMpO2Nhc2UiY29sdW1uIjpyZXR1cm4gV2UodGhpcyk7Y2FzZSB2b2lkIDA6cmV0dXJuIEtlKHRoaXMpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtufWApfX1wcm9kdWN0KG4pe3N3aXRjaChuKXtjYXNlInJvdyI6cmV0dXJuIFVlKHRoaXMpO2Nhc2UiY29sdW1uIjpyZXR1cm4gWGUodGhpcyk7Y2FzZSB2b2lkIDA6cmV0dXJuIFFlKHRoaXMpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtufWApfX1tZWFuKG4pe2NvbnN0IGU9dGhpcy5zdW0obik7c3dpdGNoKG4pe2Nhc2Uicm93Ijp7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWVbdF0vPXRoaXMuY29sdW1ucztyZXR1cm4gZX1jYXNlImNvbHVtbiI6e2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllW3RdLz10aGlzLnJvd3M7cmV0dXJuIGV9Y2FzZSB2b2lkIDA6cmV0dXJuIGUvdGhpcy5zaXplO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtufWApfX12YXJpYW5jZShuLGU9e30pe2lmKHR5cGVvZiBuPT0ib2JqZWN0IiYmKGU9bixuPXZvaWQgMCksdHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHt1bmJpYXNlZDp0PSEwLG1lYW46bz10aGlzLm1lYW4obil9PWU7aWYodHlwZW9mIHQhPSJib29sZWFuIil0aHJvdyBuZXcgVHlwZUVycm9yKCJ1bmJpYXNlZCBtdXN0IGJlIGEgYm9vbGVhbiIpO3N3aXRjaChuKXtjYXNlInJvdyI6e2lmKCFBcnJheS5pc0FycmF5KG8pKXRocm93IG5ldyBUeXBlRXJyb3IoIm1lYW4gbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBZZSh0aGlzLHQsbyl9Y2FzZSJjb2x1bW4iOntpZighQXJyYXkuaXNBcnJheShvKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtZWFuIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gWmUodGhpcyx0LG8pfWNhc2Ugdm9pZCAwOntpZih0eXBlb2YgbyE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigibWVhbiBtdXN0IGJlIGEgbnVtYmVyIik7cmV0dXJuIF9lKHRoaXMsdCxvKX1kZWZhdWx0OnRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvcHRpb246ICR7bn1gKX19c3RhbmRhcmREZXZpYXRpb24obixlKXt0eXBlb2Ygbj09Im9iamVjdCImJihlPW4sbj12b2lkIDApO2NvbnN0IHQ9dGhpcy52YXJpYW5jZShuLGUpO2lmKG49PT12b2lkIDApcmV0dXJuIE1hdGguc3FydCh0KTtmb3IobGV0IG89MDtvPHQubGVuZ3RoO28rKyl0W29dPU1hdGguc3FydCh0W29dKTtyZXR1cm4gdH1jZW50ZXIobixlPXt9KXtpZih0eXBlb2Ygbj09Im9iamVjdCImJihlPW4sbj12b2lkIDApLHR5cGVvZiBlIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7Y29uc3R7Y2VudGVyOnQ9dGhpcy5tZWFuKG4pfT1lO3N3aXRjaChuKXtjYXNlInJvdyI6e2lmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoImNlbnRlciBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIHhlKHRoaXMsdCksdGhpc31jYXNlImNvbHVtbiI6e2lmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoImNlbnRlciBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIEFlKHRoaXMsdCksdGhpc31jYXNlIHZvaWQgMDp7aWYodHlwZW9mIHQhPSJudW1iZXIiKXRocm93IG5ldyBUeXBlRXJyb3IoImNlbnRlciBtdXN0IGJlIGEgbnVtYmVyIik7cmV0dXJuIHRuKHRoaXMsdCksdGhpc31kZWZhdWx0OnRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvcHRpb246ICR7bn1gKX19c2NhbGUobixlPXt9KXtpZih0eXBlb2Ygbj09Im9iamVjdCImJihlPW4sbj12b2lkIDApLHR5cGVvZiBlIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7bGV0IHQ9ZS5zY2FsZTtzd2l0Y2gobil7Y2FzZSJyb3ciOntpZih0PT09dm9pZCAwKXQ9ZW4odGhpcyk7ZWxzZSBpZighQXJyYXkuaXNBcnJheSh0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJzY2FsZSBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIG5uKHRoaXMsdCksdGhpc31jYXNlImNvbHVtbiI6e2lmKHQ9PT12b2lkIDApdD1vbih0aGlzKTtlbHNlIGlmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoInNjYWxlIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gc24odGhpcyx0KSx0aGlzfWNhc2Ugdm9pZCAwOntpZih0PT09dm9pZCAwKXQ9cm4odGhpcyk7ZWxzZSBpZih0eXBlb2YgdCE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigic2NhbGUgbXVzdCBiZSBhIG51bWJlciIpO3JldHVybiBobih0aGlzLHQpLHRoaXN9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke259YCl9fXRvU3RyaW5nKG4pe3JldHVybiBOdCh0aGlzLG4pfX0kLnByb3RvdHlwZS5rbGFzcz0iTWF0cml4Iix0eXBlb2YgU3ltYm9sIT0idW5kZWZpbmVkIiYmKCQucHJvdG90eXBlW1N5bWJvbC5mb3IoIm5vZGVqcy51dGlsLmluc3BlY3QuY3VzdG9tIildPWJlKTtmdW5jdGlvbiBWdChzLG4pe3JldHVybiBzLW59JC5yYW5kb209JC5yYW5kLCQucmFuZG9tSW50PSQucmFuZEludCwkLmRpYWdvbmFsPSQuZGlhZywkLnByb3RvdHlwZS5kaWFnb25hbD0kLnByb3RvdHlwZS5kaWFnLCQuaWRlbnRpdHk9JC5leWUsJC5wcm90b3R5cGUubmVnYXRlPSQucHJvdG90eXBlLm5lZywkLnByb3RvdHlwZS50ZW5zb3JQcm9kdWN0PSQucHJvdG90eXBlLmtyb25lY2tlclByb2R1Y3Q7Y2xhc3MgUiBleHRlbmRzICR7Y29uc3RydWN0b3IobixlKXtzdXBlcigpO2lmKFIuaXNNYXRyaXgobikpcmV0dXJuIG4uY2xvbmUoKTtpZihOdW1iZXIuaXNJbnRlZ2VyKG4pJiZuPj0wKWlmKHRoaXMuZGF0YT1bXSxOdW1iZXIuaXNJbnRlZ2VyKGUpJiZlPj0wKWZvcihsZXQgdD0wO3Q8bjt0KyspdGhpcy5kYXRhLnB1c2gobmV3IEZsb2F0NjRBcnJheShlKSk7ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKCJuQ29sdW1ucyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciIpO2Vsc2UgaWYoQXJyYXkuaXNBcnJheShuKSl7Y29uc3QgdD1uO2lmKG49dC5sZW5ndGgsZT1uP3RbMF0ubGVuZ3RoOjAsdHlwZW9mIGUhPSJudW1iZXIiKXRocm93IG5ldyBUeXBlRXJyb3IoIkRhdGEgbXVzdCBiZSBhIDJEIGFycmF5IHdpdGggYXQgbGVhc3Qgb25lIGVsZW1lbnQiKTt0aGlzLmRhdGE9W107Zm9yKGxldCBvPTA7bzxuO28rKyl7aWYodFtvXS5sZW5ndGghPT1lKXRocm93IG5ldyBSYW5nZUVycm9yKCJJbmNvbnNpc3RlbnQgYXJyYXkgZGltZW5zaW9ucyIpO3RoaXMuZGF0YS5wdXNoKEZsb2F0NjRBcnJheS5mcm9tKHRbb10pKX19ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKCJGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyIG9yIGFuIGFycmF5Iik7dGhpcy5yb3dzPW4sdGhpcy5jb2x1bW5zPWV9c2V0KG4sZSx0KXtyZXR1cm4gdGhpcy5kYXRhW25dW2VdPXQsdGhpc31nZXQobixlKXtyZXR1cm4gdGhpcy5kYXRhW25dW2VdfXJlbW92ZVJvdyhuKXtyZXR1cm4gTyh0aGlzLG4pLHRoaXMuZGF0YS5zcGxpY2UobiwxKSx0aGlzLnJvd3MtPTEsdGhpc31hZGRSb3cobixlKXtyZXR1cm4gZT09PXZvaWQgMCYmKGU9bixuPXRoaXMucm93cyksTyh0aGlzLG4sITApLGU9RmxvYXQ2NEFycmF5LmZyb20oWSh0aGlzLGUpKSx0aGlzLmRhdGEuc3BsaWNlKG4sMCxlKSx0aGlzLnJvd3MrPTEsdGhpc31yZW1vdmVDb2x1bW4obil7TCh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKyl7Y29uc3QgdD1uZXcgRmxvYXQ2NEFycmF5KHRoaXMuY29sdW1ucy0xKTtmb3IobGV0IG89MDtvPG47bysrKXRbb109dGhpcy5kYXRhW2VdW29dO2ZvcihsZXQgbz1uKzE7bzx0aGlzLmNvbHVtbnM7bysrKXRbby0xXT10aGlzLmRhdGFbZV1bb107dGhpcy5kYXRhW2VdPXR9cmV0dXJuIHRoaXMuY29sdW1ucy09MSx0aGlzfWFkZENvbHVtbihuLGUpe3R5cGVvZiBlPT0idW5kZWZpbmVkIiYmKGU9bixuPXRoaXMuY29sdW1ucyksTCh0aGlzLG4sITApLGU9Wih0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl7Y29uc3Qgbz1uZXcgRmxvYXQ2NEFycmF5KHRoaXMuY29sdW1ucysxKTtsZXQgcj0wO2Zvcig7cjxuO3IrKylvW3JdPXRoaXMuZGF0YVt0XVtyXTtmb3Iob1tyKytdPWVbdF07cjx0aGlzLmNvbHVtbnMrMTtyKyspb1tyXT10aGlzLmRhdGFbdF1bci0xXTt0aGlzLmRhdGFbdF09b31yZXR1cm4gdGhpcy5jb2x1bW5zKz0xLHRoaXN9fU9lKCQsUik7dmFyIFB0PXtleHBvcnRzOnt9fTsoZnVuY3Rpb24ocyxuKXsoZnVuY3Rpb24oKXt2YXIgZSx0LG8scixpLGgsdSxmLGwsbSxhLGosdix5LGQ7bz1NYXRoLmZsb29yLG09TWF0aC5taW4sdD1mdW5jdGlvbihjLHcpe3JldHVybiBjPHc/LTE6Yz53PzE6MH0sbD1mdW5jdGlvbihjLHcsZyxwLEUpe3ZhciBTO2lmKGc9PW51bGwmJihnPTApLEU9PW51bGwmJihFPXQpLGc8MCl0aHJvdyBuZXcgRXJyb3IoImxvIG11c3QgYmUgbm9uLW5lZ2F0aXZlIik7Zm9yKHA9PW51bGwmJihwPWMubGVuZ3RoKTtnPHA7KVM9bygoZytwKS8yKSxFKHcsY1tTXSk8MD9wPVM6Zz1TKzE7cmV0dXJuW10uc3BsaWNlLmFwcGx5KGMsW2csZy1nXS5jb25jYXQodykpLHd9LGg9ZnVuY3Rpb24oYyx3LGcpe3JldHVybiBnPT1udWxsJiYoZz10KSxjLnB1c2godykseShjLDAsYy5sZW5ndGgtMSxnKX0saT1mdW5jdGlvbihjLHcpe3ZhciBnLHA7cmV0dXJuIHc9PW51bGwmJih3PXQpLGc9Yy5wb3AoKSxjLmxlbmd0aD8ocD1jWzBdLGNbMF09ZyxkKGMsMCx3KSk6cD1nLHB9LGY9ZnVuY3Rpb24oYyx3LGcpe3ZhciBwO3JldHVybiBnPT1udWxsJiYoZz10KSxwPWNbMF0sY1swXT13LGQoYywwLGcpLHB9LHU9ZnVuY3Rpb24oYyx3LGcpe3ZhciBwO3JldHVybiBnPT1udWxsJiYoZz10KSxjLmxlbmd0aCYmZyhjWzBdLHcpPDAmJihwPVtjWzBdLHddLHc9cFswXSxjWzBdPXBbMV0sZChjLDAsZykpLHd9LHI9ZnVuY3Rpb24oYyx3KXt2YXIgZyxwLEUsUyxrLHE7Zm9yKHc9PW51bGwmJih3PXQpLFM9ZnVuY3Rpb24oKXtxPVtdO2Zvcih2YXIgRj0wLEk9byhjLmxlbmd0aC8yKTswPD1JP0Y8STpGPkk7MDw9ST9GKys6Ri0tKXEucHVzaChGKTtyZXR1cm4gcX0uYXBwbHkodGhpcykucmV2ZXJzZSgpLGs9W10scD0wLEU9Uy5sZW5ndGg7cDxFO3ArKylnPVNbcF0say5wdXNoKGQoYyxnLHcpKTtyZXR1cm4ga30sdj1mdW5jdGlvbihjLHcsZyl7dmFyIHA7aWYoZz09bnVsbCYmKGc9dCkscD1jLmluZGV4T2YodykscCE9PS0xKXJldHVybiB5KGMsMCxwLGcpLGQoYyxwLGcpfSxhPWZ1bmN0aW9uKGMsdyxnKXt2YXIgcCxFLFMsayxxO2lmKGc9PW51bGwmJihnPXQpLEU9Yy5zbGljZSgwLHcpLCFFLmxlbmd0aClyZXR1cm4gRTtmb3IocihFLGcpLHE9Yy5zbGljZSh3KSxTPTAsaz1xLmxlbmd0aDtTPGs7UysrKXA9cVtTXSx1KEUscCxnKTtyZXR1cm4gRS5zb3J0KGcpLnJldmVyc2UoKX0saj1mdW5jdGlvbihjLHcsZyl7dmFyIHAsRSxTLGsscSxGLEksVixDO2lmKGc9PW51bGwmJihnPXQpLHcqMTA8PWMubGVuZ3RoKXtpZihTPWMuc2xpY2UoMCx3KS5zb3J0KGcpLCFTLmxlbmd0aClyZXR1cm4gUztmb3IoRT1TW1MubGVuZ3RoLTFdLEk9Yy5zbGljZSh3KSxrPTAsRj1JLmxlbmd0aDtrPEY7aysrKXA9SVtrXSxnKHAsRSk8MCYmKGwoUyxwLDAsbnVsbCxnKSxTLnBvcCgpLEU9U1tTLmxlbmd0aC0xXSk7cmV0dXJuIFN9Zm9yKHIoYyxnKSxDPVtdLHE9MCxWPW0odyxjLmxlbmd0aCk7MDw9Vj9xPFY6cT5WOzA8PVY/KytxOi0tcSlDLnB1c2goaShjLGcpKTtyZXR1cm4gQ30seT1mdW5jdGlvbihjLHcsZyxwKXt2YXIgRSxTLGs7Zm9yKHA9PW51bGwmJihwPXQpLEU9Y1tnXTtnPnc7KXtpZihrPWctMT4+MSxTPWNba10scChFLFMpPDApe2NbZ109UyxnPWs7Y29udGludWV9YnJlYWt9cmV0dXJuIGNbZ109RX0sZD1mdW5jdGlvbihjLHcsZyl7dmFyIHAsRSxTLGsscTtmb3IoZz09bnVsbCYmKGc9dCksRT1jLmxlbmd0aCxxPXcsUz1jW3ddLHA9Mip3KzE7cDxFOylrPXArMSxrPEUmJiEoZyhjW3BdLGNba10pPDApJiYocD1rKSxjW3ddPWNbcF0sdz1wLHA9Mip3KzE7cmV0dXJuIGNbd109Uyx5KGMscSx3LGcpfSxlPWZ1bmN0aW9uKCl7Yy5wdXNoPWgsYy5wb3A9aSxjLnJlcGxhY2U9ZixjLnB1c2hwb3A9dSxjLmhlYXBpZnk9cixjLnVwZGF0ZUl0ZW09dixjLm5sYXJnZXN0PWEsYy5uc21hbGxlc3Q9ajtmdW5jdGlvbiBjKHcpe3RoaXMuY21wPXchPW51bGw/dzp0LHRoaXMubm9kZXM9W119cmV0dXJuIGMucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odyl7cmV0dXJuIGgodGhpcy5ub2Rlcyx3LHRoaXMuY21wKX0sYy5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5ub2Rlcyx0aGlzLmNtcCl9LGMucHJvdG90eXBlLnBlZWs9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlc1swXX0sYy5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24odyl7cmV0dXJuIHRoaXMubm9kZXMuaW5kZXhPZih3KSE9PS0xfSxjLnByb3RvdHlwZS5yZXBsYWNlPWZ1bmN0aW9uKHcpe3JldHVybiBmKHRoaXMubm9kZXMsdyx0aGlzLmNtcCl9LGMucHJvdG90eXBlLnB1c2hwb3A9ZnVuY3Rpb24odyl7cmV0dXJuIHUodGhpcy5ub2Rlcyx3LHRoaXMuY21wKX0sYy5wcm90b3R5cGUuaGVhcGlmeT1mdW5jdGlvbigpe3JldHVybiByKHRoaXMubm9kZXMsdGhpcy5jbXApfSxjLnByb3RvdHlwZS51cGRhdGVJdGVtPWZ1bmN0aW9uKHcpe3JldHVybiB2KHRoaXMubm9kZXMsdyx0aGlzLmNtcCl9LGMucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXM9W119LGMucHJvdG90eXBlLmVtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXMubGVuZ3RoPT09MH0sYy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzLmxlbmd0aH0sYy5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgdztyZXR1cm4gdz1uZXcgYyx3Lm5vZGVzPXRoaXMubm9kZXMuc2xpY2UoMCksd30sYy5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzLnNsaWNlKDApfSxjLnByb3RvdHlwZS5pbnNlcnQ9Yy5wcm90b3R5cGUucHVzaCxjLnByb3RvdHlwZS50b3A9Yy5wcm90b3R5cGUucGVlayxjLnByb3RvdHlwZS5mcm9udD1jLnByb3RvdHlwZS5wZWVrLGMucHJvdG90eXBlLmhhcz1jLnByb3RvdHlwZS5jb250YWlucyxjLnByb3RvdHlwZS5jb3B5PWMucHJvdG90eXBlLmNsb25lLGN9KCksZnVuY3Rpb24oYyx3KXtyZXR1cm4gcy5leHBvcnRzPXcoKX0odGhpcyxmdW5jdGlvbigpe3JldHVybiBlfSl9KS5jYWxsKFZlKX0pKFB0KTt2YXIgdW49UHQuZXhwb3J0cyxsbj11bjtjbGFzcyBpdHtjb25zdHJ1Y3Rvcigpe3RoaXMuY2hpbGRyZW49W10sdGhpcy5oZWlnaHQ9MCx0aGlzLnNpemU9MSx0aGlzLmluZGV4PS0xLHRoaXMuaXNMZWFmPSExfWN1dChuKXtpZih0eXBlb2YgbiE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigidGhyZXNob2xkIG11c3QgYmUgYSBudW1iZXIiKTtpZihuPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoInRocmVzaG9sZCBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyIik7bGV0IGU9W3RoaXNdO2NvbnN0IHQ9W107Zm9yKDtlLmxlbmd0aD4wOyl7Y29uc3Qgbz1lLnNoaWZ0KCk7bj49by5oZWlnaHQ/dC5wdXNoKG8pOmU9ZS5jb25jYXQoby5jaGlsZHJlbil9cmV0dXJuIHR9Z3JvdXAobil7aWYoIU51bWJlci5pc0ludGVnZXIobil8fG48MSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiZ3JvdXBzIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7Y29uc3QgZT1uZXcgbG4oKG8scik9PnIuaGVpZ2h0LW8uaGVpZ2h0KTtmb3IoZS5wdXNoKHRoaXMpO2Uuc2l6ZSgpPG47KXtjb25zdCBvPWUucG9wKCk7aWYoby5jaGlsZHJlbi5sZW5ndGg9PT0wKWJyZWFrO28uY2hpbGRyZW4uZm9yRWFjaChyPT5lLnB1c2gocikpfWNvbnN0IHQ9bmV3IGl0O3JldHVybiB0LmNoaWxkcmVuPWUudG9BcnJheSgpLHQuaGVpZ2h0PXRoaXMuaGVpZ2h0LHR9dHJhdmVyc2Uobil7ZnVuY3Rpb24gZSh0LG8pe2lmKG8odCksdC5jaGlsZHJlbilmb3IoY29uc3QgciBvZiB0LmNoaWxkcmVuKWUocixvKX1lKHRoaXMsbil9aW5kaWNlcygpe2NvbnN0IG49W107cmV0dXJuIHRoaXMudHJhdmVyc2UoZT0+e2UuaXNMZWFmJiZuLnB1c2goZS5pbmRleCl9KSxufX1mdW5jdGlvbiBmbihzLG4pe3JldHVybiBNYXRoLm1pbihzLG4pfWZ1bmN0aW9uIGNuKHMsbil7cmV0dXJuIE1hdGgubWF4KHMsbil9ZnVuY3Rpb24gd24ocyxuLGUsdCxvKXtjb25zdCByPXQvKHQrbyksaT1vLyh0K28pO3JldHVybiByKnMraSpufWZ1bmN0aW9uIGduKHMsbil7cmV0dXJuKHMrbikvMn1mdW5jdGlvbiBtbihzLG4sZSx0LG8pe2NvbnN0IHI9dC8odCtvKSxpPW8vKHQrbyksaD0tKHQqbykvKHQrbykqKjI7cmV0dXJuIHIqcytpKm4raCplfWZ1bmN0aW9uIHBuKHMsbixlKXtyZXR1cm4gcy8yK24vMi1lLzR9ZnVuY3Rpb24gYW4ocyxuLGUsdCxvLHIpe2NvbnN0IGk9KHQrcikvKHQrbytyKSxoPShvK3IpLyh0K28rciksdT0tci8odCtvK3IpO3JldHVybiBpKnMraCpuK3UqZX1mdW5jdGlvbiBkbihzLG4sZSx0LG8scil7Y29uc3QgaT0odCtyKS8odCtvK3IpLGg9KG8rcikvKHQrbytyKSx1PS1yLyh0K28rcik7cmV0dXJuIE1hdGguc3FydChpKnMqcytoKm4qbit1KmUqZSl9ZnVuY3Rpb24geW4ocyxuPXt9KXtjb25zdHtkaXN0YW5jZUZ1bmN0aW9uOmU9YixtZXRob2Q6dD0iY29tcGxldGUiLGlzRGlzdGFuY2VNYXRyaXg6bz0hMX09bjtsZXQgcjtvfHwocz0kdChzLGUpKTtsZXQgaT1uZXcgUihzKTtjb25zdCBoPWkucm93cztpZih0eXBlb2YgdD09InN0cmluZyIpc3dpdGNoKHQudG9Mb3dlckNhc2UoKSl7Y2FzZSJzaW5nbGUiOnI9Zm47YnJlYWs7Y2FzZSJjb21wbGV0ZSI6cj1jbjticmVhaztjYXNlImF2ZXJhZ2UiOmNhc2UidXBnbWEiOnI9d247YnJlYWs7Y2FzZSJ3cGdtYSI6cj1nbjticmVhaztjYXNlImNlbnRyb2lkIjpjYXNlInVwZ21jIjpyPW1uO2JyZWFrO2Nhc2UibWVkaWFuIjpjYXNlIndwZ21jIjpyPXBuO2JyZWFrO2Nhc2Uid2FyZCI6cj1hbjticmVhaztjYXNlIndhcmQyIjpyPWRuO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IFJhbmdlRXJyb3IoYHVua25vd24gY2x1c3RlcmluZyBtZXRob2Q6ICR7dH1gKX1lbHNlIGlmKHR5cGVvZiB0IT0iZnVuY3Rpb24iKXRocm93IG5ldyBUeXBlRXJyb3IoIm1ldGhvZCBtdXN0IGJlIGEgc3RyaW5nIG9yIGZ1bmN0aW9uIik7bGV0IHU9W107Zm9yKGxldCBmPTA7ZjxoO2YrKyl7Y29uc3QgbD1uZXcgaXQ7bC5pc0xlYWY9ITAsbC5pbmRleD1mLHUucHVzaChsKX1mb3IobGV0IGY9MDtmPGgtMTtmKyspe2NvbnN0W2wsbSxhXT1qbihpKSxqPXVbbF0sdj11W21dLHk9bmV3IGl0O3kuc2l6ZT1qLnNpemUrdi5zaXplLHkuY2hpbGRyZW4ucHVzaChqLHYpLHkuaGVpZ2h0PWE7Y29uc3QgZD1beV0sYz1uZXcgUihpLnJvd3MtMSxpLnJvd3MtMSksdz1nPT52bihnLE1hdGgubWluKGwsbSksTWF0aC5tYXgobCxtKSk7Zm9yKGxldCBnPTE7ZzxjLnJvd3M7ZysrKXtjb25zdCBwPXcoZyksRT11W3BdO2QucHVzaChFKTtmb3IobGV0IFM9MDtTPGc7UysrKWlmKFM9PT0wKXtjb25zdCBrPWkuZ2V0KGwscCkscT1pLmdldChwLG0pLEY9cihrLHEsYSxqLnNpemUsdi5zaXplLEUuc2l6ZSk7Yy5zZXQoZyxTLEYpLGMuc2V0KFMsZyxGKX1lbHNle2NvbnN0IGs9aS5nZXQocCx3KFMpKTtjLnNldChnLFMsayksYy5zZXQoUyxnLGspfX11PWQsaT1jfXJldHVybiB1WzBdfWZ1bmN0aW9uIGpuKHMpe2xldCBuPTEvMCxlPTAsdD0wO2ZvcihsZXQgbz0xO288cy5yb3dzO28rKylmb3IobGV0IHI9MDtyPG87cisrKXMuZ2V0KG8scik8biYmKG49cy5nZXQobyxyKSxlPW8sdD1yKTtyZXR1cm5bZSx0LG5dfWZ1bmN0aW9uIHZuKHMsbixlKXtyZXR1cm4gcy09MSxzPj1uJiZzKysscz49ZSYmcysrLHN9bGV0IFNuPShzPTIxKT0+e2xldCBuPSIiLGU9Y3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShzKSk7Zm9yKDtzLS07KXtsZXQgdD1lW3NdJjYzO3Q8MzY/bis9dC50b1N0cmluZygzNik6dDw2Mj9uKz0odC0yNikudG9TdHJpbmcoMzYpLnRvVXBwZXJDYXNlKCk6dDw2Mz9uKz0iXyI6bis9Ii0ifXJldHVybiBufTtmdW5jdGlvbiBFbihzKXtyZXR1cm4gdHlwZW9mIHM9PSJudW1iZXIiJiYhaXNOYU4ocyl9ZnVuY3Rpb24gQ3QocyxuPVtdLGU9W10pe2NvbnN0IHQ9KGwsbSk9Pm4uaW5jbHVkZXMobCk/bTp2b2lkIDA7bGV0IG89W107bi5sZW5ndGg+MCYmKG89bi5tYXAodCkuZmlsdGVyKEVuKSk7Y29uc3Qgcj0obCxtKT0+by5pbmNsdWRlcyhtKSxpPWw9PnBhcnNlRmxvYXQobCksaD1sPT57Y29uc3RbLG1dPWw7bGV0IGE9bTtyZXR1cm4gbiYmby5sZW5ndGg+MCYmKGE9bS5maWx0ZXIocikpLGEubWFwKGkpfTtyZXR1cm4gZS5tYXAobD0+W2wsc1tsXV0pLm1hcChoKX1mdW5jdGlvbiBNbihzLG49W10sZT1bXSl7Y29uc3QgdD1DdChzLG4sZSk7cmV0dXJuIHRbMF0ubWFwKChyLGkpPT50Lm1hcChoPT5oW2ldKSl9ZnVuY3Rpb24gYnQocyl7dmFyIG49YXJndW1lbnRzLmxlbmd0aD4xJiZhcmd1bWVudHNbMV0hPT12b2lkIDA/YXJndW1lbnRzWzFdOnt9O2lmKFEocykpe2lmKHMubGVuZ3RoPT09MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IG5vdCBiZSBlbXB0eSIpfWVsc2UgdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBiZSBhbiBhcnJheSIpO3ZhciBlO2lmKG4ub3V0cHV0IT09dm9pZCAwKXtpZighUShuLm91dHB1dCkpdGhyb3cgbmV3IFR5cGVFcnJvcigib3V0cHV0IG9wdGlvbiBtdXN0IGJlIGFuIGFycmF5IGlmIHNwZWNpZmllZCIpO2U9bi5vdXRwdXR9ZWxzZSBlPW5ldyBBcnJheShzLmxlbmd0aCk7dmFyIHQ9cXQocyksbz1UdChzKTtpZih0PT09byl0aHJvdyBuZXcgUmFuZ2VFcnJvcigibWluaW11bSBhbmQgbWF4aW11bSBpbnB1dCB2YWx1ZXMgYXJlIGVxdWFsLiBDYW5ub3QgcmVzY2FsZSBhIGNvbnN0YW50IGFycmF5Iik7dmFyIHI9bi5taW4saT1yPT09dm9pZCAwP24uYXV0b01pbk1heD90OjA6cixoPW4ubWF4LHU9aD09PXZvaWQgMD9uLmF1dG9NaW5NYXg/bzoxOmg7aWYoaT49dSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigibWluIG9wdGlvbiBtdXN0IGJlIHNtYWxsZXIgdGhhbiBtYXggb3B0aW9uIik7Zm9yKHZhciBmPSh1LWkpLyhvLXQpLGw9MDtsPHMubGVuZ3RoO2wrKyllW2xdPShzW2xdLXQpKmYraTtyZXR1cm4gZX1jb25zdCBodD0iICIucmVwZWF0KDIpLER0PSIgIi5yZXBlYXQoNCk7ZnVuY3Rpb24ga24oKXtyZXR1cm4gQnQodGhpcyl9ZnVuY3Rpb24gQnQocyxuPXt9KXtjb25zdHttYXhSb3dzOmU9MTUsbWF4Q29sdW1uczp0PTEwLG1heE51bVNpemU6bz04fT1uO3JldHVybmAke3MuY29uc3RydWN0b3IubmFtZX0gewoke2h0fVsKJHtEdH0ke1JuKHMsZSx0LG8pfQoke2h0fV0KJHtodH1yb3dzOiAke3Mucm93c30KJHtodH1jb2x1bW5zOiAke3MuY29sdW1uc30KfWB9ZnVuY3Rpb24gUm4ocyxuLGUsdCl7Y29uc3R7cm93czpvLGNvbHVtbnM6cn09cyxpPU1hdGgubWluKG8sbiksaD1NYXRoLm1pbihyLGUpLHU9W107Zm9yKGxldCBmPTA7ZjxpO2YrKyl7bGV0IGw9W107Zm9yKGxldCBtPTA7bTxoO20rKylsLnB1c2goJG4ocy5nZXQoZixtKSx0KSk7dS5wdXNoKGAke2wuam9pbigiICIpfWApfXJldHVybiBoIT09ciYmKHVbdS5sZW5ndGgtMV0rPWAgLi4uICR7ci1lfSBtb3JlIGNvbHVtbnNgKSxpIT09byYmdS5wdXNoKGAuLi4gJHtvLW59IG1vcmUgcm93c2ApLHUuam9pbihgCiR7RHR9YCl9ZnVuY3Rpb24gJG4ocyxuKXtjb25zdCBlPVN0cmluZyhzKTtpZihlLmxlbmd0aDw9bilyZXR1cm4gZS5wYWRFbmQobiwiICIpO2NvbnN0IHQ9cy50b1ByZWNpc2lvbihuLTIpO2lmKHQubGVuZ3RoPD1uKXJldHVybiB0O2NvbnN0IG89cy50b0V4cG9uZW50aWFsKG4tMikscj1vLmluZGV4T2YoImUiKSxpPW8uc2xpY2Uocik7cmV0dXJuIG8uc2xpY2UoMCxuLWkubGVuZ3RoKStpfWZ1bmN0aW9uIFRuKHMsbil7cy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5hZGRTKHQpOnRoaXMuYWRkTSh0KX0scy5wcm90b3R5cGUuYWRkUz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpK3QpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5hZGRNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKSt0LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5hZGQ9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkuYWRkKG8pfSxzLnByb3RvdHlwZS5zdWI9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnN1YlModCk6dGhpcy5zdWJNKHQpfSxzLnByb3RvdHlwZS5zdWJTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8sciktdCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLnN1Yk09ZnVuY3Rpb24odCl7aWYodD1uLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpLXQuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLnN1Yj1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5zdWIobyl9LHMucHJvdG90eXBlLnN1YnRyYWN0PXMucHJvdG90eXBlLnN1YixzLnByb3RvdHlwZS5zdWJ0cmFjdFM9cy5wcm90b3R5cGUuc3ViUyxzLnByb3RvdHlwZS5zdWJ0cmFjdE09cy5wcm90b3R5cGUuc3ViTSxzLnN1YnRyYWN0PXMuc3ViLHMucHJvdG90eXBlLm11bD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMubXVsUyh0KTp0aGlzLm11bE0odCl9LHMucHJvdG90eXBlLm11bFM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKSp0KTtyZXR1cm4gdGhpc30scy5wcm90b3R5cGUubXVsTT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scikqdC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMubXVsPWZ1bmN0aW9uKHQsbyl7cmV0dXJuIG5ldyBuKHQpLm11bChvKX0scy5wcm90b3R5cGUubXVsdGlwbHk9cy5wcm90b3R5cGUubXVsLHMucHJvdG90eXBlLm11bHRpcGx5Uz1zLnByb3RvdHlwZS5tdWxTLHMucHJvdG90eXBlLm11bHRpcGx5TT1zLnByb3RvdHlwZS5tdWxNLHMubXVsdGlwbHk9cy5tdWwscy5wcm90b3R5cGUuZGl2PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5kaXZTKHQpOnRoaXMuZGl2TSh0KX0scy5wcm90b3R5cGUuZGl2Uz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpL3QpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5kaXZNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKS90LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5kaXY9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkuZGl2KG8pfSxzLnByb3RvdHlwZS5kaXZpZGU9cy5wcm90b3R5cGUuZGl2LHMucHJvdG90eXBlLmRpdmlkZVM9cy5wcm90b3R5cGUuZGl2UyxzLnByb3RvdHlwZS5kaXZpZGVNPXMucHJvdG90eXBlLmRpdk0scy5kaXZpZGU9cy5kaXYscy5wcm90b3R5cGUubW9kPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5tb2RTKHQpOnRoaXMubW9kTSh0KX0scy5wcm90b3R5cGUubW9kUz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpJXQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5tb2RNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKSV0LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5tb2Q9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkubW9kKG8pfSxzLnByb3RvdHlwZS5tb2R1bHVzPXMucHJvdG90eXBlLm1vZCxzLnByb3RvdHlwZS5tb2R1bHVzUz1zLnByb3RvdHlwZS5tb2RTLHMucHJvdG90eXBlLm1vZHVsdXNNPXMucHJvdG90eXBlLm1vZE0scy5tb2R1bHVzPXMubW9kLHMucHJvdG90eXBlLmFuZD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuYW5kUyh0KTp0aGlzLmFuZE0odCl9LHMucHJvdG90eXBlLmFuZFM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKSZ0KTtyZXR1cm4gdGhpc30scy5wcm90b3R5cGUuYW5kTT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scikmdC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMuYW5kPWZ1bmN0aW9uKHQsbyl7cmV0dXJuIG5ldyBuKHQpLmFuZChvKX0scy5wcm90b3R5cGUub3I9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLm9yUyh0KTp0aGlzLm9yTSh0KX0scy5wcm90b3R5cGUub3JTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scil8dCk7cmV0dXJuIHRoaXN9LHMucHJvdG90eXBlLm9yTT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scil8dC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMub3I9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkub3Iobyl9LHMucHJvdG90eXBlLnhvcj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMueG9yUyh0KTp0aGlzLnhvck0odCl9LHMucHJvdG90eXBlLnhvclM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKV50KTtyZXR1cm4gdGhpc30scy5wcm90b3R5cGUueG9yTT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8sciledC5nZXQobyxyKSk7cmV0dXJuIHRoaXN9LHMueG9yPWZ1bmN0aW9uKHQsbyl7cmV0dXJuIG5ldyBuKHQpLnhvcihvKX0scy5wcm90b3R5cGUubGVmdFNoaWZ0PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5sZWZ0U2hpZnRTKHQpOnRoaXMubGVmdFNoaWZ0TSh0KX0scy5wcm90b3R5cGUubGVmdFNoaWZ0Uz1mdW5jdGlvbih0KXtmb3IobGV0IG89MDtvPHRoaXMucm93cztvKyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KG8scix0aGlzLmdldChvLHIpPDx0KTtyZXR1cm4gdGhpc30scy5wcm90b3R5cGUubGVmdFNoaWZ0TT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scik8PHQuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLmxlZnRTaGlmdD1mdW5jdGlvbih0LG8pe3JldHVybiBuZXcgbih0KS5sZWZ0U2hpZnQobyl9LHMucHJvdG90eXBlLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnRTKHQpOnRoaXMuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdE0odCl9LHMucHJvdG90eXBlLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scik+PnQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0TT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scik+PnQuZ2V0KG8scikpO3JldHVybiB0aGlzfSxzLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnQ9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdChvKX0scy5wcm90b3R5cGUucmlnaHRTaGlmdD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMucmlnaHRTaGlmdFModCk6dGhpcy5yaWdodFNoaWZ0TSh0KX0scy5wcm90b3R5cGUucmlnaHRTaGlmdFM9ZnVuY3Rpb24odCl7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsdGhpcy5nZXQobyxyKT4+PnQpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5yaWdodFNoaWZ0TT1mdW5jdGlvbih0KXtpZih0PW4uY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLHRoaXMuZ2V0KG8scik+Pj50LmdldChvLHIpKTtyZXR1cm4gdGhpc30scy5yaWdodFNoaWZ0PWZ1bmN0aW9uKHQsbyl7cmV0dXJuIG5ldyBuKHQpLnJpZ2h0U2hpZnQobyl9LHMucHJvdG90eXBlLnplcm9GaWxsUmlnaHRTaGlmdD1zLnByb3RvdHlwZS5yaWdodFNoaWZ0LHMucHJvdG90eXBlLnplcm9GaWxsUmlnaHRTaGlmdFM9cy5wcm90b3R5cGUucmlnaHRTaGlmdFMscy5wcm90b3R5cGUuemVyb0ZpbGxSaWdodFNoaWZ0TT1zLnByb3RvdHlwZS5yaWdodFNoaWZ0TSxzLnplcm9GaWxsUmlnaHRTaGlmdD1zLnJpZ2h0U2hpZnQscy5wcm90b3R5cGUubm90PWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sfnRoaXMuZ2V0KHQsbykpO3JldHVybiB0aGlzfSxzLm5vdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkubm90KCl9LHMucHJvdG90eXBlLmFicz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguYWJzKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5hYnM9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmFicygpfSxzLnByb3RvdHlwZS5hY29zPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5hY29zKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5hY29zPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5hY29zKCl9LHMucHJvdG90eXBlLmFjb3NoPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5hY29zaCh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuYWNvc2g9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmFjb3NoKCl9LHMucHJvdG90eXBlLmFzaW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmFzaW4odGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmFzaW49ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmFzaW4oKX0scy5wcm90b3R5cGUuYXNpbmg9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmFzaW5oKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5hc2luaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuYXNpbmgoKX0scy5wcm90b3R5cGUuYXRhbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguYXRhbih0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuYXRhbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuYXRhbigpfSxzLnByb3RvdHlwZS5hdGFuaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguYXRhbmgodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmF0YW5oPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5hdGFuaCgpfSxzLnByb3RvdHlwZS5jYnJ0PWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5jYnJ0KHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5jYnJ0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5jYnJ0KCl9LHMucHJvdG90eXBlLmNlaWw9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmNlaWwodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmNlaWw9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmNlaWwoKX0scy5wcm90b3R5cGUuY2x6MzI9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmNsejMyKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5jbHozMj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuY2x6MzIoKX0scy5wcm90b3R5cGUuY29zPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5jb3ModGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmNvcz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuY29zKCl9LHMucHJvdG90eXBlLmNvc2g9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmNvc2godGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmNvc2g9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmNvc2goKX0scy5wcm90b3R5cGUuZXhwPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5leHAodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLmV4cD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkuZXhwKCl9LHMucHJvdG90eXBlLmV4cG0xPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5leHBtMSh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuZXhwbTE9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmV4cG0xKCl9LHMucHJvdG90eXBlLmZsb29yPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5mbG9vcih0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMuZmxvb3I9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmZsb29yKCl9LHMucHJvdG90eXBlLmZyb3VuZD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguZnJvdW5kKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5mcm91bmQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLmZyb3VuZCgpfSxzLnByb3RvdHlwZS5sb2c9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmxvZyh0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMubG9nPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5sb2coKX0scy5wcm90b3R5cGUubG9nMXA9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmxvZzFwKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5sb2cxcD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkubG9nMXAoKX0scy5wcm90b3R5cGUubG9nMTA9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLmxvZzEwKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5sb2cxMD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkubG9nMTAoKX0scy5wcm90b3R5cGUubG9nMj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgubG9nMih0aGlzLmdldCh0LG8pKSk7cmV0dXJuIHRoaXN9LHMubG9nMj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkubG9nMigpfSxzLnByb3RvdHlwZS5yb3VuZD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGgucm91bmQodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnJvdW5kPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5yb3VuZCgpfSxzLnByb3RvdHlwZS5zaWduPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5zaWduKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5zaWduPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5zaWduKCl9LHMucHJvdG90eXBlLnNpbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQodCxvLE1hdGguc2luKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5zaW49ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLnNpbigpfSxzLnByb3RvdHlwZS5zaW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC5zaW5oKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy5zaW5oPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgbih0KS5zaW5oKCl9LHMucHJvdG90eXBlLnNxcnQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLnNxcnQodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnNxcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLnNxcnQoKX0scy5wcm90b3R5cGUudGFuPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldCh0LG8sTWF0aC50YW4odGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnRhbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkudGFuKCl9LHMucHJvdG90eXBlLnRhbmg9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLnRhbmgodGhpcy5nZXQodCxvKSkpO3JldHVybiB0aGlzfSxzLnRhbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBuKHQpLnRhbmgoKX0scy5wcm90b3R5cGUudHJ1bmM9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHQsbyxNYXRoLnRydW5jKHRoaXMuZ2V0KHQsbykpKTtyZXR1cm4gdGhpc30scy50cnVuYz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG4odCkudHJ1bmMoKX0scy5wb3c9ZnVuY3Rpb24odCxvKXtyZXR1cm4gbmV3IG4odCkucG93KG8pfSxzLnByb3RvdHlwZS5wb3c9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnBvd1ModCk6dGhpcy5wb3dNKHQpfSxzLnByb3RvdHlwZS5wb3dTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbz0wO288dGhpcy5yb3dzO28rKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQobyxyLE1hdGgucG93KHRoaXMuZ2V0KG8sciksdCkpO3JldHVybiB0aGlzfSxzLnByb3RvdHlwZS5wb3dNPWZ1bmN0aW9uKHQpe2lmKHQ9bi5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldChvLHIsTWF0aC5wb3codGhpcy5nZXQobyxyKSx0LmdldChvLHIpKSk7cmV0dXJuIHRoaXN9fWZ1bmN0aW9uIEgocyxuLGUpe2xldCB0PWU/cy5yb3dzOnMucm93cy0xO2lmKG48MHx8bj50KXRocm93IG5ldyBSYW5nZUVycm9yKCJSb3cgaW5kZXggb3V0IG9mIHJhbmdlIil9ZnVuY3Rpb24gSihzLG4sZSl7bGV0IHQ9ZT9zLmNvbHVtbnM6cy5jb2x1bW5zLTE7aWYobjwwfHxuPnQpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkNvbHVtbiBpbmRleCBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiB4KHMsbil7aWYobi50bzFEQXJyYXkmJihuPW4udG8xREFycmF5KCkpLG4ubGVuZ3RoIT09cy5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJ2ZWN0b3Igc2l6ZSBtdXN0IGJlIHRoZSBzYW1lIGFzIHRoZSBudW1iZXIgb2YgY29sdW1ucyIpO3JldHVybiBufWZ1bmN0aW9uIEEocyxuKXtpZihuLnRvMURBcnJheSYmKG49bi50bzFEQXJyYXkoKSksbi5sZW5ndGghPT1zLnJvd3MpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInZlY3RvciBzaXplIG11c3QgYmUgdGhlIHNhbWUgYXMgdGhlIG51bWJlciBvZiByb3dzIik7cmV0dXJuIG59ZnVuY3Rpb24gcW4ocyxuLGUpe3JldHVybntyb3c6SW4ocyxuKSxjb2x1bW46em4ocyxlKX19ZnVuY3Rpb24gSW4ocyxuKXtpZih0eXBlb2YgbiE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigidW5leHBlY3RlZCB0eXBlIGZvciByb3cgaW5kaWNlcyIpO2lmKG4uc29tZSh0PT50PDB8fHQ+PXMucm93cykpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInJvdyBpbmRpY2VzIGFyZSBvdXQgb2YgcmFuZ2UiKTtyZXR1cm4gQXJyYXkuaXNBcnJheShuKXx8KG49QXJyYXkuZnJvbShuKSksbn1mdW5jdGlvbiB6bihzLG4pe2lmKHR5cGVvZiBuIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJ1bmV4cGVjdGVkIHR5cGUgZm9yIGNvbHVtbiBpbmRpY2VzIik7aWYobi5zb21lKHQ9PnQ8MHx8dD49cy5jb2x1bW5zKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiY29sdW1uIGluZGljZXMgYXJlIG91dCBvZiByYW5nZSIpO3JldHVybiBBcnJheS5pc0FycmF5KG4pfHwobj1BcnJheS5mcm9tKG4pKSxufWZ1bmN0aW9uIE90KHMsbixlLHQsbyl7aWYoYXJndW1lbnRzLmxlbmd0aCE9PTUpdGhyb3cgbmV3IFJhbmdlRXJyb3IoImV4cGVjdGVkIDQgYXJndW1lbnRzIik7aWYobHQoInN0YXJ0Um93IixuKSxsdCgiZW5kUm93IixlKSxsdCgic3RhcnRDb2x1bW4iLHQpLGx0KCJlbmRDb2x1bW4iLG8pLG4+ZXx8dD5vfHxuPDB8fG4+PXMucm93c3x8ZTwwfHxlPj1zLnJvd3N8fHQ8MHx8dD49cy5jb2x1bW5zfHxvPDB8fG8+PXMuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiU3VibWF0cml4IGluZGljZXMgYXJlIG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIHV0KHMsbj0wKXtsZXQgZT1bXTtmb3IobGV0IHQ9MDt0PHM7dCsrKWUucHVzaChuKTtyZXR1cm4gZX1mdW5jdGlvbiBsdChzLG4pe2lmKHR5cGVvZiBuIT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKGAke3N9IG11c3QgYmUgYSBudW1iZXJgKX1mdW5jdGlvbiB0dChzKXtpZihzLmlzRW1wdHkoKSl0aHJvdyBuZXcgRXJyb3IoIkVtcHR5IG1hdHJpeCBoYXMgbm8gZWxlbWVudHMgdG8gaW5kZXgiKX1mdW5jdGlvbiBObihzKXtsZXQgbj11dChzLnJvd3MpO2ZvcihsZXQgZT0wO2U8cy5yb3dzOysrZSlmb3IobGV0IHQ9MDt0PHMuY29sdW1uczsrK3QpbltlXSs9cy5nZXQoZSx0KTtyZXR1cm4gbn1mdW5jdGlvbiBGbihzKXtsZXQgbj11dChzLmNvbHVtbnMpO2ZvcihsZXQgZT0wO2U8cy5yb3dzOysrZSlmb3IobGV0IHQ9MDt0PHMuY29sdW1uczsrK3Qpblt0XSs9cy5nZXQoZSx0KTtyZXR1cm4gbn1mdW5jdGlvbiBWbihzKXtsZXQgbj0wO2ZvcihsZXQgZT0wO2U8cy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHMuY29sdW1uczt0Kyspbis9cy5nZXQoZSx0KTtyZXR1cm4gbn1mdW5jdGlvbiBQbihzKXtsZXQgbj11dChzLnJvd3MsMSk7Zm9yKGxldCBlPTA7ZTxzLnJvd3M7KytlKWZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zOysrdCluW2VdKj1zLmdldChlLHQpO3JldHVybiBufWZ1bmN0aW9uIENuKHMpe2xldCBuPXV0KHMuY29sdW1ucywxKTtmb3IobGV0IGU9MDtlPHMucm93czsrK2UpZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7Kyt0KW5bdF0qPXMuZ2V0KGUsdCk7cmV0dXJuIG59ZnVuY3Rpb24gYm4ocyl7bGV0IG49MTtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKW4qPXMuZ2V0KGUsdCk7cmV0dXJuIG59ZnVuY3Rpb24gRG4ocyxuLGUpe2NvbnN0IHQ9cy5yb3dzLG89cy5jb2x1bW5zLHI9W107Zm9yKGxldCBpPTA7aTx0O2krKyl7bGV0IGg9MCx1PTAsZj0wO2ZvcihsZXQgbD0wO2w8bztsKyspZj1zLmdldChpLGwpLWVbaV0saCs9Zix1Kz1mKmY7bj9yLnB1c2goKHUtaCpoL28pLyhvLTEpKTpyLnB1c2goKHUtaCpoL28pL28pfXJldHVybiByfWZ1bmN0aW9uIEJuKHMsbixlKXtjb25zdCB0PXMucm93cyxvPXMuY29sdW1ucyxyPVtdO2ZvcihsZXQgaT0wO2k8bztpKyspe2xldCBoPTAsdT0wLGY9MDtmb3IobGV0IGw9MDtsPHQ7bCsrKWY9cy5nZXQobCxpKS1lW2ldLGgrPWYsdSs9ZipmO24/ci5wdXNoKCh1LWgqaC90KS8odC0xKSk6ci5wdXNoKCh1LWgqaC90KS90KX1yZXR1cm4gcn1mdW5jdGlvbiBPbihzLG4sZSl7Y29uc3QgdD1zLnJvd3Msbz1zLmNvbHVtbnMscj10Km87bGV0IGk9MCxoPTAsdT0wO2ZvcihsZXQgZj0wO2Y8dDtmKyspZm9yKGxldCBsPTA7bDxvO2wrKyl1PXMuZ2V0KGYsbCktZSxpKz11LGgrPXUqdTtyZXR1cm4gbj8oaC1pKmkvcikvKHItMSk6KGgtaSppL3IpL3J9ZnVuY3Rpb24gTG4ocyxuKXtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKXMuc2V0KGUsdCxzLmdldChlLHQpLW5bZV0pfWZ1bmN0aW9uIEhuKHMsbil7Zm9yKGxldCBlPTA7ZTxzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zO3QrKylzLnNldChlLHQscy5nZXQoZSx0KS1uW3RdKX1mdW5jdGlvbiBKbihzLG4pe2ZvcihsZXQgZT0wO2U8cy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHMuY29sdW1uczt0Kyspcy5zZXQoZSx0LHMuZ2V0KGUsdCktbil9ZnVuY3Rpb24gR24ocyl7Y29uc3Qgbj1bXTtmb3IobGV0IGU9MDtlPHMucm93cztlKyspe2xldCB0PTA7Zm9yKGxldCBvPTA7bzxzLmNvbHVtbnM7bysrKXQrPU1hdGgucG93KHMuZ2V0KGUsbyksMikvKHMuY29sdW1ucy0xKTtuLnB1c2goTWF0aC5zcXJ0KHQpKX1yZXR1cm4gbn1mdW5jdGlvbiBXbihzLG4pe2ZvcihsZXQgZT0wO2U8cy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHMuY29sdW1uczt0Kyspcy5zZXQoZSx0LHMuZ2V0KGUsdCkvbltlXSl9ZnVuY3Rpb24gS24ocyl7Y29uc3Qgbj1bXTtmb3IobGV0IGU9MDtlPHMuY29sdW1ucztlKyspe2xldCB0PTA7Zm9yKGxldCBvPTA7bzxzLnJvd3M7bysrKXQrPU1hdGgucG93KHMuZ2V0KG8sZSksMikvKHMucm93cy0xKTtuLnB1c2goTWF0aC5zcXJ0KHQpKX1yZXR1cm4gbn1mdW5jdGlvbiBVbihzLG4pe2ZvcihsZXQgZT0wO2U8cy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHMuY29sdW1uczt0Kyspcy5zZXQoZSx0LHMuZ2V0KGUsdCkvblt0XSl9ZnVuY3Rpb24gWG4ocyl7Y29uc3Qgbj1zLnNpemUtMTtsZXQgZT0wO2ZvcihsZXQgdD0wO3Q8cy5jb2x1bW5zO3QrKylmb3IobGV0IG89MDtvPHMucm93cztvKyspZSs9TWF0aC5wb3cocy5nZXQobyx0KSwyKS9uO3JldHVybiBNYXRoLnNxcnQoZSl9ZnVuY3Rpb24gUW4ocyxuKXtmb3IobGV0IGU9MDtlPHMucm93cztlKyspZm9yKGxldCB0PTA7dDxzLmNvbHVtbnM7dCsrKXMuc2V0KGUsdCxzLmdldChlLHQpL24pfWNsYXNzIFR7c3RhdGljIGZyb20xREFycmF5KG4sZSx0KXtpZihuKmUhPT10Lmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiZGF0YSBsZW5ndGggZG9lcyBub3QgbWF0Y2ggZ2l2ZW4gZGltZW5zaW9ucyIpO2xldCByPW5ldyBNKG4sZSk7Zm9yKGxldCBpPTA7aTxuO2krKylmb3IobGV0IGg9MDtoPGU7aCsrKXIuc2V0KGksaCx0W2kqZStoXSk7cmV0dXJuIHJ9c3RhdGljIHJvd1ZlY3RvcihuKXtsZXQgZT1uZXcgTSgxLG4ubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PG4ubGVuZ3RoO3QrKyllLnNldCgwLHQsblt0XSk7cmV0dXJuIGV9c3RhdGljIGNvbHVtblZlY3RvcihuKXtsZXQgZT1uZXcgTShuLmxlbmd0aCwxKTtmb3IobGV0IHQ9MDt0PG4ubGVuZ3RoO3QrKyllLnNldCh0LDAsblt0XSk7cmV0dXJuIGV9c3RhdGljIHplcm9zKG4sZSl7cmV0dXJuIG5ldyBNKG4sZSl9c3RhdGljIG9uZXMobixlKXtyZXR1cm4gbmV3IE0obixlKS5maWxsKDEpfXN0YXRpYyByYW5kKG4sZSx0PXt9KXtpZih0eXBlb2YgdCE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e3JhbmRvbTpvPU1hdGgucmFuZG9tfT10O2xldCByPW5ldyBNKG4sZSk7Zm9yKGxldCBpPTA7aTxuO2krKylmb3IobGV0IGg9MDtoPGU7aCsrKXIuc2V0KGksaCxvKCkpO3JldHVybiByfXN0YXRpYyByYW5kSW50KG4sZSx0PXt9KXtpZih0eXBlb2YgdCE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e21pbjpvPTAsbWF4OnI9MWUzLHJhbmRvbTppPU1hdGgucmFuZG9tfT10O2lmKCFOdW1iZXIuaXNJbnRlZ2VyKG8pKXRocm93IG5ldyBUeXBlRXJyb3IoIm1pbiBtdXN0IGJlIGFuIGludGVnZXIiKTtpZighTnVtYmVyLmlzSW50ZWdlcihyKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtYXggbXVzdCBiZSBhbiBpbnRlZ2VyIik7aWYobz49cil0aHJvdyBuZXcgUmFuZ2VFcnJvcigibWluIG11c3QgYmUgc21hbGxlciB0aGFuIG1heCIpO2xldCBoPXItbyx1PW5ldyBNKG4sZSk7Zm9yKGxldCBmPTA7ZjxuO2YrKylmb3IobGV0IGw9MDtsPGU7bCsrKXtsZXQgbT1vK01hdGgucm91bmQoaSgpKmgpO3Uuc2V0KGYsbCxtKX1yZXR1cm4gdX1zdGF0aWMgZXllKG4sZSx0KXtlPT09dm9pZCAwJiYoZT1uKSx0PT09dm9pZCAwJiYodD0xKTtsZXQgbz1NYXRoLm1pbihuLGUpLHI9dGhpcy56ZXJvcyhuLGUpO2ZvcihsZXQgaT0wO2k8bztpKyspci5zZXQoaSxpLHQpO3JldHVybiByfXN0YXRpYyBkaWFnKG4sZSx0KXtsZXQgbz1uLmxlbmd0aDtlPT09dm9pZCAwJiYoZT1vKSx0PT09dm9pZCAwJiYodD1lKTtsZXQgcj1NYXRoLm1pbihvLGUsdCksaT10aGlzLnplcm9zKGUsdCk7Zm9yKGxldCBoPTA7aDxyO2grKylpLnNldChoLGgsbltoXSk7cmV0dXJuIGl9c3RhdGljIG1pbihuLGUpe249dGhpcy5jaGVja01hdHJpeChuKSxlPXRoaXMuY2hlY2tNYXRyaXgoZSk7bGV0IHQ9bi5yb3dzLG89bi5jb2x1bW5zLHI9bmV3IE0odCxvKTtmb3IobGV0IGk9MDtpPHQ7aSsrKWZvcihsZXQgaD0wO2g8bztoKyspci5zZXQoaSxoLE1hdGgubWluKG4uZ2V0KGksaCksZS5nZXQoaSxoKSkpO3JldHVybiByfXN0YXRpYyBtYXgobixlKXtuPXRoaXMuY2hlY2tNYXRyaXgobiksZT10aGlzLmNoZWNrTWF0cml4KGUpO2xldCB0PW4ucm93cyxvPW4uY29sdW1ucyxyPW5ldyB0aGlzKHQsbyk7Zm9yKGxldCBpPTA7aTx0O2krKylmb3IobGV0IGg9MDtoPG87aCsrKXIuc2V0KGksaCxNYXRoLm1heChuLmdldChpLGgpLGUuZ2V0KGksaCkpKTtyZXR1cm4gcn1zdGF0aWMgY2hlY2tNYXRyaXgobil7cmV0dXJuIFQuaXNNYXRyaXgobik/bjpuZXcgTShuKX1zdGF0aWMgaXNNYXRyaXgobil7cmV0dXJuIG4hPW51bGwmJm4ua2xhc3M9PT0iTWF0cml4In1nZXQgc2l6ZSgpe3JldHVybiB0aGlzLnJvd3MqdGhpcy5jb2x1bW5zfWFwcGx5KG4pe2lmKHR5cGVvZiBuIT0iZnVuY3Rpb24iKXRocm93IG5ldyBUeXBlRXJyb3IoImNhbGxiYWNrIG11c3QgYmUgYSBmdW5jdGlvbiIpO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspbi5jYWxsKHRoaXMsZSx0KTtyZXR1cm4gdGhpc310bzFEQXJyYXkoKXtsZXQgbj1bXTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW4ucHVzaCh0aGlzLmdldChlLHQpKTtyZXR1cm4gbn10bzJEQXJyYXkoKXtsZXQgbj1bXTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspe24ucHVzaChbXSk7Zm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW5bZV0ucHVzaCh0aGlzLmdldChlLHQpKX1yZXR1cm4gbn10b0pTT04oKXtyZXR1cm4gdGhpcy50bzJEQXJyYXkoKX1pc1Jvd1ZlY3Rvcigpe3JldHVybiB0aGlzLnJvd3M9PT0xfWlzQ29sdW1uVmVjdG9yKCl7cmV0dXJuIHRoaXMuY29sdW1ucz09PTF9aXNWZWN0b3IoKXtyZXR1cm4gdGhpcy5yb3dzPT09MXx8dGhpcy5jb2x1bW5zPT09MX1pc1NxdWFyZSgpe3JldHVybiB0aGlzLnJvd3M9PT10aGlzLmNvbHVtbnN9aXNFbXB0eSgpe3JldHVybiB0aGlzLnJvd3M9PT0wfHx0aGlzLmNvbHVtbnM9PT0wfWlzU3ltbWV0cmljKCl7aWYodGhpcy5pc1NxdWFyZSgpKXtmb3IobGV0IG49MDtuPHRoaXMucm93cztuKyspZm9yKGxldCBlPTA7ZTw9bjtlKyspaWYodGhpcy5nZXQobixlKSE9PXRoaXMuZ2V0KGUsbikpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuITF9aXNFY2hlbG9uRm9ybSgpe2xldCBuPTAsZT0wLHQ9LTEsbz0hMCxyPSExO2Zvcig7bjx0aGlzLnJvd3MmJm87KXtmb3IoZT0wLHI9ITE7ZTx0aGlzLmNvbHVtbnMmJnI9PT0hMTspdGhpcy5nZXQobixlKT09PTA/ZSsrOnRoaXMuZ2V0KG4sZSk9PT0xJiZlPnQ/KHI9ITAsdD1lKToobz0hMSxyPSEwKTtuKyt9cmV0dXJuIG99aXNSZWR1Y2VkRWNoZWxvbkZvcm0oKXtsZXQgbj0wLGU9MCx0PS0xLG89ITAscj0hMTtmb3IoO248dGhpcy5yb3dzJiZvOyl7Zm9yKGU9MCxyPSExO2U8dGhpcy5jb2x1bW5zJiZyPT09ITE7KXRoaXMuZ2V0KG4sZSk9PT0wP2UrKzp0aGlzLmdldChuLGUpPT09MSYmZT50PyhyPSEwLHQ9ZSk6KG89ITEscj0hMCk7Zm9yKGxldCBpPWUrMTtpPHRoaXMucm93cztpKyspdGhpcy5nZXQobixpKSE9PTAmJihvPSExKTtuKyt9cmV0dXJuIG99ZWNoZWxvbkZvcm0oKXtsZXQgbj10aGlzLmNsb25lKCksZT0wLHQ9MDtmb3IoO2U8bi5yb3dzJiZ0PG4uY29sdW1uczspe2xldCBvPWU7Zm9yKGxldCByPWU7cjxuLnJvd3M7cisrKW4uZ2V0KHIsdCk+bi5nZXQobyx0KSYmKG89cik7aWYobi5nZXQobyx0KT09PTApdCsrO2Vsc2V7bi5zd2FwUm93cyhlLG8pO2xldCByPW4uZ2V0KGUsdCk7Zm9yKGxldCBpPXQ7aTxuLmNvbHVtbnM7aSsrKW4uc2V0KGUsaSxuLmdldChlLGkpL3IpO2ZvcihsZXQgaT1lKzE7aTxuLnJvd3M7aSsrKXtsZXQgaD1uLmdldChpLHQpL24uZ2V0KGUsdCk7bi5zZXQoaSx0LDApO2ZvcihsZXQgdT10KzE7dTxuLmNvbHVtbnM7dSsrKW4uc2V0KGksdSxuLmdldChpLHUpLW4uZ2V0KGUsdSkqaCl9ZSsrLHQrK319cmV0dXJuIG59cmVkdWNlZEVjaGVsb25Gb3JtKCl7bGV0IG49dGhpcy5lY2hlbG9uRm9ybSgpLGU9bi5jb2x1bW5zLHQ9bi5yb3dzLG89dC0xO2Zvcig7bz49MDspaWYobi5tYXhSb3cobyk9PT0wKW8tLTtlbHNle2xldCByPTAsaT0hMTtmb3IoO3I8dCYmaT09PSExOyluLmdldChvLHIpPT09MT9pPSEwOnIrKztmb3IobGV0IGg9MDtoPG87aCsrKXtsZXQgdT1uLmdldChoLHIpO2ZvcihsZXQgZj1yO2Y8ZTtmKyspe2xldCBsPW4uZ2V0KGgsZiktdSpuLmdldChvLGYpO24uc2V0KGgsZixsKX19by0tfXJldHVybiBufXNldCgpe3Rocm93IG5ldyBFcnJvcigic2V0IG1ldGhvZCBpcyB1bmltcGxlbWVudGVkIil9Z2V0KCl7dGhyb3cgbmV3IEVycm9yKCJnZXQgbWV0aG9kIGlzIHVuaW1wbGVtZW50ZWQiKX1yZXBlYXQobj17fSl7aWYodHlwZW9mIG4hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtyb3dzOmU9MSxjb2x1bW5zOnQ9MX09bjtpZighTnVtYmVyLmlzSW50ZWdlcihlKXx8ZTw9MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJyb3dzIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7aWYoIU51bWJlci5pc0ludGVnZXIodCl8fHQ8PTApdGhyb3cgbmV3IFR5cGVFcnJvcigiY29sdW1ucyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciIpO2xldCBvPW5ldyBNKHRoaXMucm93cyplLHRoaXMuY29sdW1ucyp0KTtmb3IobGV0IHI9MDtyPGU7cisrKWZvcihsZXQgaT0wO2k8dDtpKyspby5zZXRTdWJNYXRyaXgodGhpcyx0aGlzLnJvd3Mqcix0aGlzLmNvbHVtbnMqaSk7cmV0dXJuIG99ZmlsbChuKXtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KGUsdCxuKTtyZXR1cm4gdGhpc31uZWcoKXtyZXR1cm4gdGhpcy5tdWxTKC0xKX1nZXRSb3cobil7SCh0aGlzLG4pO2xldCBlPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllLnB1c2godGhpcy5nZXQobix0KSk7cmV0dXJuIGV9Z2V0Um93VmVjdG9yKG4pe3JldHVybiBNLnJvd1ZlY3Rvcih0aGlzLmdldFJvdyhuKSl9c2V0Um93KG4sZSl7SCh0aGlzLG4pLGU9eCh0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChuLHQsZVt0XSk7cmV0dXJuIHRoaXN9c3dhcFJvd3MobixlKXtIKHRoaXMsbiksSCh0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl7bGV0IG89dGhpcy5nZXQobix0KTt0aGlzLnNldChuLHQsdGhpcy5nZXQoZSx0KSksdGhpcy5zZXQoZSx0LG8pfXJldHVybiB0aGlzfWdldENvbHVtbihuKXtKKHRoaXMsbik7bGV0IGU9W107Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWUucHVzaCh0aGlzLmdldCh0LG4pKTtyZXR1cm4gZX1nZXRDb2x1bW5WZWN0b3Iobil7cmV0dXJuIE0uY29sdW1uVmVjdG9yKHRoaXMuZ2V0Q29sdW1uKG4pKX1zZXRDb2x1bW4obixlKXtKKHRoaXMsbiksZT1BKHRoaXMsZSk7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXRoaXMuc2V0KHQsbixlW3RdKTtyZXR1cm4gdGhpc31zd2FwQ29sdW1ucyhuLGUpe0oodGhpcyxuKSxKKHRoaXMsZSk7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXtsZXQgbz10aGlzLmdldCh0LG4pO3RoaXMuc2V0KHQsbix0aGlzLmdldCh0LGUpKSx0aGlzLnNldCh0LGUsbyl9cmV0dXJuIHRoaXN9YWRkUm93VmVjdG9yKG4pe249eCh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkrblt0XSk7cmV0dXJuIHRoaXN9c3ViUm93VmVjdG9yKG4pe249eCh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCktblt0XSk7cmV0dXJuIHRoaXN9bXVsUm93VmVjdG9yKG4pe249eCh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkqblt0XSk7cmV0dXJuIHRoaXN9ZGl2Um93VmVjdG9yKG4pe249eCh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkvblt0XSk7cmV0dXJuIHRoaXN9YWRkQ29sdW1uVmVjdG9yKG4pe249QSh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkrbltlXSk7cmV0dXJuIHRoaXN9c3ViQ29sdW1uVmVjdG9yKG4pe249QSh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCktbltlXSk7cmV0dXJuIHRoaXN9bXVsQ29sdW1uVmVjdG9yKG4pe249QSh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkqbltlXSk7cmV0dXJuIHRoaXN9ZGl2Q29sdW1uVmVjdG9yKG4pe249QSh0aGlzLG4pO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkvbltlXSk7cmV0dXJuIHRoaXN9bXVsUm93KG4sZSl7SCh0aGlzLG4pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChuLHQsdGhpcy5nZXQobix0KSplKTtyZXR1cm4gdGhpc31tdWxDb2x1bW4obixlKXtKKHRoaXMsbik7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXRoaXMuc2V0KHQsbix0aGlzLmdldCh0LG4pKmUpO3JldHVybiB0aGlzfW1heCgpe2lmKHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IG49dGhpcy5nZXQoMCwwKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KGUsdCk+biYmKG49dGhpcy5nZXQoZSx0KSk7cmV0dXJuIG59bWF4SW5kZXgoKXt0dCh0aGlzKTtsZXQgbj10aGlzLmdldCgwLDApLGU9WzAsMF07Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLmdldCh0LG8pPm4mJihuPXRoaXMuZ2V0KHQsbyksZVswXT10LGVbMV09byk7cmV0dXJuIGV9bWluKCl7aWYodGhpcy5pc0VtcHR5KCkpcmV0dXJuIE5hTjtsZXQgbj10aGlzLmdldCgwLDApO2ZvcihsZXQgZT0wO2U8dGhpcy5yb3dzO2UrKylmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5nZXQoZSx0KTxuJiYobj10aGlzLmdldChlLHQpKTtyZXR1cm4gbn1taW5JbmRleCgpe3R0KHRoaXMpO2xldCBuPXRoaXMuZ2V0KDAsMCksZT1bMCwwXTtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuZ2V0KHQsbyk8biYmKG49dGhpcy5nZXQodCxvKSxlWzBdPXQsZVsxXT1vKTtyZXR1cm4gZX1tYXhSb3cobil7aWYoSCh0aGlzLG4pLHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQobiwwKTtmb3IobGV0IHQ9MTt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5nZXQobix0KT5lJiYoZT10aGlzLmdldChuLHQpKTtyZXR1cm4gZX1tYXhSb3dJbmRleChuKXtIKHRoaXMsbiksdHQodGhpcyk7bGV0IGU9dGhpcy5nZXQobiwwKSx0PVtuLDBdO2ZvcihsZXQgbz0xO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLmdldChuLG8pPmUmJihlPXRoaXMuZ2V0KG4sbyksdFsxXT1vKTtyZXR1cm4gdH1taW5Sb3cobil7aWYoSCh0aGlzLG4pLHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQobiwwKTtmb3IobGV0IHQ9MTt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5nZXQobix0KTxlJiYoZT10aGlzLmdldChuLHQpKTtyZXR1cm4gZX1taW5Sb3dJbmRleChuKXtIKHRoaXMsbiksdHQodGhpcyk7bGV0IGU9dGhpcy5nZXQobiwwKSx0PVtuLDBdO2ZvcihsZXQgbz0xO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLmdldChuLG8pPGUmJihlPXRoaXMuZ2V0KG4sbyksdFsxXT1vKTtyZXR1cm4gdH1tYXhDb2x1bW4obil7aWYoSih0aGlzLG4pLHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQoMCxuKTtmb3IobGV0IHQ9MTt0PHRoaXMucm93czt0KyspdGhpcy5nZXQodCxuKT5lJiYoZT10aGlzLmdldCh0LG4pKTtyZXR1cm4gZX1tYXhDb2x1bW5JbmRleChuKXtKKHRoaXMsbiksdHQodGhpcyk7bGV0IGU9dGhpcy5nZXQoMCxuKSx0PVswLG5dO2ZvcihsZXQgbz0xO288dGhpcy5yb3dzO28rKyl0aGlzLmdldChvLG4pPmUmJihlPXRoaXMuZ2V0KG8sbiksdFswXT1vKTtyZXR1cm4gdH1taW5Db2x1bW4obil7aWYoSih0aGlzLG4pLHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQoMCxuKTtmb3IobGV0IHQ9MTt0PHRoaXMucm93czt0KyspdGhpcy5nZXQodCxuKTxlJiYoZT10aGlzLmdldCh0LG4pKTtyZXR1cm4gZX1taW5Db2x1bW5JbmRleChuKXtKKHRoaXMsbiksdHQodGhpcyk7bGV0IGU9dGhpcy5nZXQoMCxuKSx0PVswLG5dO2ZvcihsZXQgbz0xO288dGhpcy5yb3dzO28rKyl0aGlzLmdldChvLG4pPGUmJihlPXRoaXMuZ2V0KG8sbiksdFswXT1vKTtyZXR1cm4gdH1kaWFnKCl7bGV0IG49TWF0aC5taW4odGhpcy5yb3dzLHRoaXMuY29sdW1ucyksZT1bXTtmb3IobGV0IHQ9MDt0PG47dCsrKWUucHVzaCh0aGlzLmdldCh0LHQpKTtyZXR1cm4gZX1ub3JtKG49ImZyb2Jlbml1cyIpe2xldCBlPTA7aWYobj09PSJtYXgiKXJldHVybiB0aGlzLm1heCgpO2lmKG49PT0iZnJvYmVuaXVzIil7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyllPWUrdGhpcy5nZXQodCxvKSp0aGlzLmdldCh0LG8pO3JldHVybiBNYXRoLnNxcnQoZSl9ZWxzZSB0aHJvdyBuZXcgUmFuZ2VFcnJvcihgdW5rbm93biBub3JtIHR5cGU6ICR7bn1gKX1jdW11bGF0aXZlU3VtKCl7bGV0IG49MDtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW4rPXRoaXMuZ2V0KGUsdCksdGhpcy5zZXQoZSx0LG4pO3JldHVybiB0aGlzfWRvdChuKXtULmlzTWF0cml4KG4pJiYobj1uLnRvMURBcnJheSgpKTtsZXQgZT10aGlzLnRvMURBcnJheSgpO2lmKGUubGVuZ3RoIT09bi5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoInZlY3RvcnMgZG8gbm90IGhhdmUgdGhlIHNhbWUgc2l6ZSIpO2xldCB0PTA7Zm9yKGxldCBvPTA7bzxlLmxlbmd0aDtvKyspdCs9ZVtvXSpuW29dO3JldHVybiB0fW1tdWwobil7bj1NLmNoZWNrTWF0cml4KG4pO2xldCBlPXRoaXMucm93cyx0PXRoaXMuY29sdW1ucyxvPW4uY29sdW1ucyxyPW5ldyBNKGUsbyksaT1uZXcgRmxvYXQ2NEFycmF5KHQpO2ZvcihsZXQgaD0wO2g8bztoKyspe2ZvcihsZXQgdT0wO3U8dDt1KyspaVt1XT1uLmdldCh1LGgpO2ZvcihsZXQgdT0wO3U8ZTt1Kyspe2xldCBmPTA7Zm9yKGxldCBsPTA7bDx0O2wrKylmKz10aGlzLmdldCh1LGwpKmlbbF07ci5zZXQodSxoLGYpfX1yZXR1cm4gcn1zdHJhc3NlbjJ4MihuKXtuPU0uY2hlY2tNYXRyaXgobik7bGV0IGU9bmV3IE0oMiwyKTtjb25zdCB0PXRoaXMuZ2V0KDAsMCksbz1uLmdldCgwLDApLHI9dGhpcy5nZXQoMCwxKSxpPW4uZ2V0KDAsMSksaD10aGlzLmdldCgxLDApLHU9bi5nZXQoMSwwKSxmPXRoaXMuZ2V0KDEsMSksbD1uLmdldCgxLDEpLG09KHQrZikqKG8rbCksYT0oaCtmKSpvLGo9dCooaS1sKSx2PWYqKHUtbykseT0odCtyKSpsLGQ9KGgtdCkqKG8raSksYz0oci1mKSoodStsKSx3PW0rdi15K2MsZz1qK3kscD1hK3YsRT1tLWEraitkO3JldHVybiBlLnNldCgwLDAsdyksZS5zZXQoMCwxLGcpLGUuc2V0KDEsMCxwKSxlLnNldCgxLDEsRSksZX1zdHJhc3NlbjN4MyhuKXtuPU0uY2hlY2tNYXRyaXgobik7bGV0IGU9bmV3IE0oMywzKTtjb25zdCB0PXRoaXMuZ2V0KDAsMCksbz10aGlzLmdldCgwLDEpLHI9dGhpcy5nZXQoMCwyKSxpPXRoaXMuZ2V0KDEsMCksaD10aGlzLmdldCgxLDEpLHU9dGhpcy5nZXQoMSwyKSxmPXRoaXMuZ2V0KDIsMCksbD10aGlzLmdldCgyLDEpLG09dGhpcy5nZXQoMiwyKSxhPW4uZ2V0KDAsMCksaj1uLmdldCgwLDEpLHY9bi5nZXQoMCwyKSx5PW4uZ2V0KDEsMCksZD1uLmdldCgxLDEpLGM9bi5nZXQoMSwyKSx3PW4uZ2V0KDIsMCksZz1uLmdldCgyLDEpLHA9bi5nZXQoMiwyKSxFPSh0K28rci1pLWgtbC1tKSpkLFM9KHQtaSkqKC1qK2QpLGs9aCooLWErait5LWQtYy13K3ApLHE9KC10K2kraCkqKGEtaitkKSxGPShpK2gpKigtYStqKSxJPXQqYSxWPSgtdCtmK2wpKihhLXYrYyksQz0oLXQrZikqKHYtYyksRz0oZitsKSooLWErdiksVT0odCtvK3ItaC11LWYtbCkqYyxYPWwqKC1hK3YreS1kLWMtdytnKSx6PSgtcitsK20pKihkK3ctZyksSz0oci1tKSooZC1nKSxQPXIqdyxEPShsK20pKigtdytnKSxOPSgtcitoK3UpKihjK3ctcCksZXQ9KHItdSkqKGMtcCksbnQ9KGgrdSkqKC13K3ApLGN0PW8qeSx3dD11KmcsZ3Q9aSp2LG10PWYqaixwdD1tKnAsYXQ9SStQK2N0LGR0PUUrcStGK0kreitQK0QseXQ9SStWK0crVStQK04rbnQsanQ9UytrK3ErSStQK04rZXQsdnQ9UytxK0YrSSt3dCxTdD1QK04rZXQrbnQrZ3QsRXQ9SStWK0MrWCt6K0srUCxNdD16K0srUCtEK210LGt0PUkrVitDK0crcHQ7cmV0dXJuIGUuc2V0KDAsMCxhdCksZS5zZXQoMCwxLGR0KSxlLnNldCgwLDIseXQpLGUuc2V0KDEsMCxqdCksZS5zZXQoMSwxLHZ0KSxlLnNldCgxLDIsU3QpLGUuc2V0KDIsMCxFdCksZS5zZXQoMiwxLE10KSxlLnNldCgyLDIsa3QpLGV9bW11bFN0cmFzc2VuKG4pe249TS5jaGVja01hdHJpeChuKTtsZXQgZT10aGlzLmNsb25lKCksdD1lLnJvd3Msbz1lLmNvbHVtbnMscj1uLnJvd3MsaT1uLmNvbHVtbnM7byE9PXImJmNvbnNvbGUud2FybihgTXVsdGlwbHlpbmcgJHt0fSB4ICR7b30gYW5kICR7cn0geCAke2l9IG1hdHJpeDogZGltZW5zaW9ucyBkbyBub3QgbWF0Y2guYCk7ZnVuY3Rpb24gaChtLGEsail7bGV0IHY9bS5yb3dzLHk9bS5jb2x1bW5zO2lmKHY9PT1hJiZ5PT09ailyZXR1cm4gbTt7bGV0IGQ9VC56ZXJvcyhhLGopO3JldHVybiBkPWQuc2V0U3ViTWF0cml4KG0sMCwwKSxkfX1sZXQgdT1NYXRoLm1heCh0LHIpLGY9TWF0aC5tYXgobyxpKTtlPWgoZSx1LGYpLG49aChuLHUsZik7ZnVuY3Rpb24gbChtLGEsaix2KXtpZihqPD01MTJ8fHY8PTUxMilyZXR1cm4gbS5tbXVsKGEpO2olMj09MSYmdiUyPT0xPyhtPWgobSxqKzEsdisxKSxhPWgoYSxqKzEsdisxKSk6aiUyPT0xPyhtPWgobSxqKzEsdiksYT1oKGEsaisxLHYpKTp2JTI9PTEmJihtPWgobSxqLHYrMSksYT1oKGEsaix2KzEpKTtsZXQgeT1wYXJzZUludChtLnJvd3MvMiwxMCksZD1wYXJzZUludChtLmNvbHVtbnMvMiwxMCksYz1tLnN1Yk1hdHJpeCgwLHktMSwwLGQtMSksdz1hLnN1Yk1hdHJpeCgwLHktMSwwLGQtMSksZz1tLnN1Yk1hdHJpeCgwLHktMSxkLG0uY29sdW1ucy0xKSxwPWEuc3ViTWF0cml4KDAseS0xLGQsYS5jb2x1bW5zLTEpLEU9bS5zdWJNYXRyaXgoeSxtLnJvd3MtMSwwLGQtMSksUz1hLnN1Yk1hdHJpeCh5LGEucm93cy0xLDAsZC0xKSxrPW0uc3ViTWF0cml4KHksbS5yb3dzLTEsZCxtLmNvbHVtbnMtMSkscT1hLnN1Yk1hdHJpeCh5LGEucm93cy0xLGQsYS5jb2x1bW5zLTEpLEY9bChULmFkZChjLGspLFQuYWRkKHcscSkseSxkKSxJPWwoVC5hZGQoRSxrKSx3LHksZCksVj1sKGMsVC5zdWIocCxxKSx5LGQpLEM9bChrLFQuc3ViKFMsdykseSxkKSxHPWwoVC5hZGQoYyxnKSxxLHksZCksVT1sKFQuc3ViKEUsYyksVC5hZGQodyxwKSx5LGQpLFg9bChULnN1YihnLGspLFQuYWRkKFMscSkseSxkKSx6PVQuYWRkKEYsQyk7ei5zdWIoRyksei5hZGQoWCk7bGV0IEs9VC5hZGQoVixHKSxQPVQuYWRkKEksQyksRD1ULnN1YihGLEkpO0QuYWRkKFYpLEQuYWRkKFUpO2xldCBOPVQuemVyb3MoMip6LnJvd3MsMip6LmNvbHVtbnMpO3JldHVybiBOPU4uc2V0U3ViTWF0cml4KHosMCwwKSxOPU4uc2V0U3ViTWF0cml4KEssei5yb3dzLDApLE49Ti5zZXRTdWJNYXRyaXgoUCwwLHouY29sdW1ucyksTj1OLnNldFN1Yk1hdHJpeChELHoucm93cyx6LmNvbHVtbnMpLE4uc3ViTWF0cml4KDAsai0xLDAsdi0xKX1yZXR1cm4gbChlLG4sdSxmKX1zY2FsZVJvd3Mobj17fSl7aWYodHlwZW9mIG4hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46ZT0wLG1heDp0PTF9PW47aWYoIU51bWJlci5pc0Zpbml0ZShlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihlPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IG89bmV3IE0odGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKXtjb25zdCBpPXRoaXMuZ2V0Um93KHIpO2kubGVuZ3RoPjAmJmJ0KGkse21pbjplLG1heDp0LG91dHB1dDppfSksby5zZXRSb3cocixpKX1yZXR1cm4gb31zY2FsZUNvbHVtbnMobj17fSl7aWYodHlwZW9mIG4hPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46ZT0wLG1heDp0PTF9PW47aWYoIU51bWJlci5pc0Zpbml0ZShlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihlPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IG89bmV3IE0odGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXtjb25zdCBpPXRoaXMuZ2V0Q29sdW1uKHIpO2kubGVuZ3RoJiZidChpLHttaW46ZSxtYXg6dCxvdXRwdXQ6aX0pLG8uc2V0Q29sdW1uKHIsaSl9cmV0dXJuIG99ZmxpcFJvd3MoKXtjb25zdCBuPU1hdGguY2VpbCh0aGlzLmNvbHVtbnMvMik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8bjt0Kyspe2xldCBvPXRoaXMuZ2V0KGUsdCkscj10aGlzLmdldChlLHRoaXMuY29sdW1ucy0xLXQpO3RoaXMuc2V0KGUsdCxyKSx0aGlzLnNldChlLHRoaXMuY29sdW1ucy0xLXQsbyl9cmV0dXJuIHRoaXN9ZmxpcENvbHVtbnMoKXtjb25zdCBuPU1hdGguY2VpbCh0aGlzLnJvd3MvMik7Zm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKWZvcihsZXQgdD0wO3Q8bjt0Kyspe2xldCBvPXRoaXMuZ2V0KHQsZSkscj10aGlzLmdldCh0aGlzLnJvd3MtMS10LGUpO3RoaXMuc2V0KHQsZSxyKSx0aGlzLnNldCh0aGlzLnJvd3MtMS10LGUsbyl9cmV0dXJuIHRoaXN9a3JvbmVja2VyUHJvZHVjdChuKXtuPU0uY2hlY2tNYXRyaXgobik7bGV0IGU9dGhpcy5yb3dzLHQ9dGhpcy5jb2x1bW5zLG89bi5yb3dzLHI9bi5jb2x1bW5zLGk9bmV3IE0oZSpvLHQqcik7Zm9yKGxldCBoPTA7aDxlO2grKylmb3IobGV0IHU9MDt1PHQ7dSsrKWZvcihsZXQgZj0wO2Y8bztmKyspZm9yKGxldCBsPTA7bDxyO2wrKylpLnNldChvKmgrZixyKnUrbCx0aGlzLmdldChoLHUpKm4uZ2V0KGYsbCkpO3JldHVybiBpfWtyb25lY2tlclN1bShuKXtpZihuPU0uY2hlY2tNYXRyaXgobiksIXRoaXMuaXNTcXVhcmUoKXx8IW4uaXNTcXVhcmUoKSl0aHJvdyBuZXcgRXJyb3IoIktyb25lY2tlciBTdW0gbmVlZHMgdHdvIFNxdWFyZSBNYXRyaWNlcyIpO2xldCBlPXRoaXMucm93cyx0PW4ucm93cyxvPXRoaXMua3JvbmVja2VyUHJvZHVjdChNLmV5ZSh0LHQpKSxyPU0uZXllKGUsZSkua3JvbmVja2VyUHJvZHVjdChuKTtyZXR1cm4gby5hZGQocil9dHJhbnNwb3NlKCl7bGV0IG49bmV3IE0odGhpcy5jb2x1bW5zLHRoaXMucm93cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyluLnNldCh0LGUsdGhpcy5nZXQoZSx0KSk7cmV0dXJuIG59c29ydFJvd3Mobj1MdCl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKXRoaXMuc2V0Um93KGUsdGhpcy5nZXRSb3coZSkuc29ydChuKSk7cmV0dXJuIHRoaXN9c29ydENvbHVtbnMobj1MdCl7Zm9yKGxldCBlPTA7ZTx0aGlzLmNvbHVtbnM7ZSsrKXRoaXMuc2V0Q29sdW1uKGUsdGhpcy5nZXRDb2x1bW4oZSkuc29ydChuKSk7cmV0dXJuIHRoaXN9c3ViTWF0cml4KG4sZSx0LG8pe090KHRoaXMsbixlLHQsbyk7bGV0IHI9bmV3IE0oZS1uKzEsby10KzEpO2ZvcihsZXQgaT1uO2k8PWU7aSsrKWZvcihsZXQgaD10O2g8PW87aCsrKXIuc2V0KGktbixoLXQsdGhpcy5nZXQoaSxoKSk7cmV0dXJuIHJ9c3ViTWF0cml4Um93KG4sZSx0KXtpZihlPT09dm9pZCAwJiYoZT0wKSx0PT09dm9pZCAwJiYodD10aGlzLmNvbHVtbnMtMSksZT50fHxlPDB8fGU+PXRoaXMuY29sdW1uc3x8dDwwfHx0Pj10aGlzLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkFyZ3VtZW50IG91dCBvZiByYW5nZSIpO2xldCBvPW5ldyBNKG4ubGVuZ3RoLHQtZSsxKTtmb3IobGV0IHI9MDtyPG4ubGVuZ3RoO3IrKylmb3IobGV0IGk9ZTtpPD10O2krKyl7aWYobltyXTwwfHxuW3JdPj10aGlzLnJvd3MpdGhyb3cgbmV3IFJhbmdlRXJyb3IoYFJvdyBpbmRleCBvdXQgb2YgcmFuZ2U6ICR7bltyXX1gKTtvLnNldChyLGktZSx0aGlzLmdldChuW3JdLGkpKX1yZXR1cm4gb31zdWJNYXRyaXhDb2x1bW4obixlLHQpe2lmKGU9PT12b2lkIDAmJihlPTApLHQ9PT12b2lkIDAmJih0PXRoaXMucm93cy0xKSxlPnR8fGU8MHx8ZT49dGhpcy5yb3dzfHx0PDB8fHQ+PXRoaXMucm93cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXJndW1lbnQgb3V0IG9mIHJhbmdlIik7bGV0IG89bmV3IE0odC1lKzEsbi5sZW5ndGgpO2ZvcihsZXQgcj0wO3I8bi5sZW5ndGg7cisrKWZvcihsZXQgaT1lO2k8PXQ7aSsrKXtpZihuW3JdPDB8fG5bcl0+PXRoaXMuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgQ29sdW1uIGluZGV4IG91dCBvZiByYW5nZTogJHtuW3JdfWApO28uc2V0KGktZSxyLHRoaXMuZ2V0KGksbltyXSkpfXJldHVybiBvfXNldFN1Yk1hdHJpeChuLGUsdCl7aWYobj1NLmNoZWNrTWF0cml4KG4pLG4uaXNFbXB0eSgpKXJldHVybiB0aGlzO2xldCBvPWUrbi5yb3dzLTEscj10K24uY29sdW1ucy0xO090KHRoaXMsZSxvLHQscik7Zm9yKGxldCBpPTA7aTxuLnJvd3M7aSsrKWZvcihsZXQgaD0wO2g8bi5jb2x1bW5zO2grKyl0aGlzLnNldChlK2ksdCtoLG4uZ2V0KGksaCkpO3JldHVybiB0aGlzfXNlbGVjdGlvbihuLGUpe2xldCB0PXFuKHRoaXMsbixlKSxvPW5ldyBNKG4ubGVuZ3RoLGUubGVuZ3RoKTtmb3IobGV0IHI9MDtyPHQucm93Lmxlbmd0aDtyKyspe2xldCBpPXQucm93W3JdO2ZvcihsZXQgaD0wO2g8dC5jb2x1bW4ubGVuZ3RoO2grKyl7bGV0IHU9dC5jb2x1bW5baF07by5zZXQocixoLHRoaXMuZ2V0KGksdSkpfX1yZXR1cm4gb310cmFjZSgpe2xldCBuPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLGU9MDtmb3IobGV0IHQ9MDt0PG47dCsrKWUrPXRoaXMuZ2V0KHQsdCk7cmV0dXJuIGV9Y2xvbmUoKXtsZXQgbj1uZXcgTSh0aGlzLnJvd3MsdGhpcy5jb2x1bW5zKTtmb3IobGV0IGU9MDtlPHRoaXMucm93cztlKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKW4uc2V0KGUsdCx0aGlzLmdldChlLHQpKTtyZXR1cm4gbn1zdW0obil7c3dpdGNoKG4pe2Nhc2Uicm93IjpyZXR1cm4gTm4odGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBGbih0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gVm4odGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke259YCl9fXByb2R1Y3Qobil7c3dpdGNoKG4pe2Nhc2Uicm93IjpyZXR1cm4gUG4odGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBDbih0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gYm4odGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke259YCl9fW1lYW4obil7Y29uc3QgZT10aGlzLnN1bShuKTtzd2l0Y2gobil7Y2FzZSJyb3ciOntmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZVt0XS89dGhpcy5jb2x1bW5zO3JldHVybiBlfWNhc2UiY29sdW1uIjp7Zm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKWVbdF0vPXRoaXMucm93cztyZXR1cm4gZX1jYXNlIHZvaWQgMDpyZXR1cm4gZS90aGlzLnNpemU7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke259YCl9fXZhcmlhbmNlKG4sZT17fSl7aWYodHlwZW9mIG49PSJvYmplY3QiJiYoZT1uLG49dm9pZCAwKSx0eXBlb2YgZSE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e3VuYmlhc2VkOnQ9ITAsbWVhbjpvPXRoaXMubWVhbihuKX09ZTtpZih0eXBlb2YgdCE9ImJvb2xlYW4iKXRocm93IG5ldyBUeXBlRXJyb3IoInVuYmlhc2VkIG11c3QgYmUgYSBib29sZWFuIik7c3dpdGNoKG4pe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkobykpdGhyb3cgbmV3IFR5cGVFcnJvcigibWVhbiBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIERuKHRoaXMsdCxvKX1jYXNlImNvbHVtbiI6e2lmKCFBcnJheS5pc0FycmF5KG8pKXRocm93IG5ldyBUeXBlRXJyb3IoIm1lYW4gbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBCbih0aGlzLHQsbyl9Y2FzZSB2b2lkIDA6e2lmKHR5cGVvZiBvIT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJtZWFuIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4gT24odGhpcyx0LG8pfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtufWApfX1zdGFuZGFyZERldmlhdGlvbihuLGUpe3R5cGVvZiBuPT0ib2JqZWN0IiYmKGU9bixuPXZvaWQgMCk7Y29uc3QgdD10aGlzLnZhcmlhbmNlKG4sZSk7aWYobj09PXZvaWQgMClyZXR1cm4gTWF0aC5zcXJ0KHQpO2ZvcihsZXQgbz0wO288dC5sZW5ndGg7bysrKXRbb109TWF0aC5zcXJ0KHRbb10pO3JldHVybiB0fWNlbnRlcihuLGU9e30pe2lmKHR5cGVvZiBuPT0ib2JqZWN0IiYmKGU9bixuPXZvaWQgMCksdHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtjZW50ZXI6dD10aGlzLm1lYW4obil9PWU7c3dpdGNoKG4pe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gTG4odGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gSG4odGhpcyx0KSx0aGlzfWNhc2Ugdm9pZCAwOntpZih0eXBlb2YgdCE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4gSm4odGhpcyx0KSx0aGlzfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtufWApfX1zY2FsZShuLGU9e30pe2lmKHR5cGVvZiBuPT0ib2JqZWN0IiYmKGU9bixuPXZvaWQgMCksdHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtsZXQgdD1lLnNjYWxlO3N3aXRjaChuKXtjYXNlInJvdyI6e2lmKHQ9PT12b2lkIDApdD1Hbih0aGlzKTtlbHNlIGlmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoInNjYWxlIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gV24odGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYodD09PXZvaWQgMCl0PUtuKHRoaXMpO2Vsc2UgaWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigic2NhbGUgbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBVbih0aGlzLHQpLHRoaXN9Y2FzZSB2b2lkIDA6e2lmKHQ9PT12b2lkIDApdD1Ybih0aGlzKTtlbHNlIGlmKHR5cGVvZiB0IT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJzY2FsZSBtdXN0IGJlIGEgbnVtYmVyIik7cmV0dXJuIFFuKHRoaXMsdCksdGhpc31kZWZhdWx0OnRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvcHRpb246ICR7bn1gKX19dG9TdHJpbmcobil7cmV0dXJuIEJ0KHRoaXMsbil9fVQucHJvdG90eXBlLmtsYXNzPSJNYXRyaXgiLHR5cGVvZiBTeW1ib2whPSJ1bmRlZmluZWQiJiYoVC5wcm90b3R5cGVbU3ltYm9sLmZvcigibm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20iKV09a24pO2Z1bmN0aW9uIEx0KHMsbil7cmV0dXJuIHMtbn1ULnJhbmRvbT1ULnJhbmQsVC5yYW5kb21JbnQ9VC5yYW5kSW50LFQuZGlhZ29uYWw9VC5kaWFnLFQucHJvdG90eXBlLmRpYWdvbmFsPVQucHJvdG90eXBlLmRpYWcsVC5pZGVudGl0eT1ULmV5ZSxULnByb3RvdHlwZS5uZWdhdGU9VC5wcm90b3R5cGUubmVnLFQucHJvdG90eXBlLnRlbnNvclByb2R1Y3Q9VC5wcm90b3R5cGUua3JvbmVja2VyUHJvZHVjdDtjbGFzcyBNIGV4dGVuZHMgVHtjb25zdHJ1Y3RvcihuLGUpe3N1cGVyKCk7aWYoTS5pc01hdHJpeChuKSlyZXR1cm4gbi5jbG9uZSgpO2lmKE51bWJlci5pc0ludGVnZXIobikmJm4+PTApaWYodGhpcy5kYXRhPVtdLE51bWJlci5pc0ludGVnZXIoZSkmJmU+PTApZm9yKGxldCB0PTA7dDxuO3QrKyl0aGlzLmRhdGEucHVzaChuZXcgRmxvYXQ2NEFycmF5KGUpKTtlbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIm5Db2x1bW5zIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7ZWxzZSBpZihBcnJheS5pc0FycmF5KG4pKXtjb25zdCB0PW47aWYobj10Lmxlbmd0aCxlPW4/dFswXS5sZW5ndGg6MCx0eXBlb2YgZSE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGF0YSBtdXN0IGJlIGEgMkQgYXJyYXkgd2l0aCBhdCBsZWFzdCBvbmUgZWxlbWVudCIpO3RoaXMuZGF0YT1bXTtmb3IobGV0IG89MDtvPG47bysrKXtpZih0W29dLmxlbmd0aCE9PWUpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluY29uc2lzdGVudCBhcnJheSBkaW1lbnNpb25zIik7dGhpcy5kYXRhLnB1c2goRmxvYXQ2NEFycmF5LmZyb20odFtvXSkpfX1lbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXIgb3IgYW4gYXJyYXkiKTt0aGlzLnJvd3M9bix0aGlzLmNvbHVtbnM9ZX1zZXQobixlLHQpe3JldHVybiB0aGlzLmRhdGFbbl1bZV09dCx0aGlzfWdldChuLGUpe3JldHVybiB0aGlzLmRhdGFbbl1bZV19cmVtb3ZlUm93KG4pe3JldHVybiBIKHRoaXMsbiksdGhpcy5kYXRhLnNwbGljZShuLDEpLHRoaXMucm93cy09MSx0aGlzfWFkZFJvdyhuLGUpe3JldHVybiBlPT09dm9pZCAwJiYoZT1uLG49dGhpcy5yb3dzKSxIKHRoaXMsbiwhMCksZT1GbG9hdDY0QXJyYXkuZnJvbSh4KHRoaXMsZSkpLHRoaXMuZGF0YS5zcGxpY2UobiwwLGUpLHRoaXMucm93cys9MSx0aGlzfXJlbW92ZUNvbHVtbihuKXtKKHRoaXMsbik7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKXtjb25zdCB0PW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zLTEpO2ZvcihsZXQgbz0wO288bjtvKyspdFtvXT10aGlzLmRhdGFbZV1bb107Zm9yKGxldCBvPW4rMTtvPHRoaXMuY29sdW1ucztvKyspdFtvLTFdPXRoaXMuZGF0YVtlXVtvXTt0aGlzLmRhdGFbZV09dH1yZXR1cm4gdGhpcy5jb2x1bW5zLT0xLHRoaXN9YWRkQ29sdW1uKG4sZSl7dHlwZW9mIGU9PSJ1bmRlZmluZWQiJiYoZT1uLG49dGhpcy5jb2x1bW5zKSxKKHRoaXMsbiwhMCksZT1BKHRoaXMsZSk7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXtjb25zdCBvPW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zKzEpO2xldCByPTA7Zm9yKDtyPG47cisrKW9bcl09dGhpcy5kYXRhW3RdW3JdO2ZvcihvW3IrK109ZVt0XTtyPHRoaXMuY29sdW1ucysxO3IrKylvW3JdPXRoaXMuZGF0YVt0XVtyLTFdO3RoaXMuZGF0YVt0XT1vfXJldHVybiB0aGlzLmNvbHVtbnMrPTEsdGhpc319VG4oVCxNKTtmdW5jdGlvbiBZbihzLG49cyxlPXt9KXtzPW5ldyBNKHMpO2xldCB0PSExO2lmKHR5cGVvZiBuPT0ib2JqZWN0IiYmIU0uaXNNYXRyaXgobikmJiFBcnJheS5pc0FycmF5KG4pPyhlPW4sbj1zLHQ9ITApOm49bmV3IE0obikscy5yb3dzIT09bi5yb3dzKXRocm93IG5ldyBUeXBlRXJyb3IoIkJvdGggbWF0cmljZXMgbXVzdCBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiByb3dzIik7Y29uc3R7Y2VudGVyOm89ITAsc2NhbGU6cj0hMH09ZTtvJiYocy5jZW50ZXIoImNvbHVtbiIpLHR8fG4uY2VudGVyKCJjb2x1bW4iKSksciYmKHMuc2NhbGUoImNvbHVtbiIpLHR8fG4uc2NhbGUoImNvbHVtbiIpKTtjb25zdCBpPXMuc3RhbmRhcmREZXZpYXRpb24oImNvbHVtbiIse3VuYmlhc2VkOiEwfSksaD10P2k6bi5zdGFuZGFyZERldmlhdGlvbigiY29sdW1uIix7dW5iaWFzZWQ6ITB9KSx1PXMudHJhbnNwb3NlKCkubW11bChuKTtmb3IobGV0IGY9MDtmPHUucm93cztmKyspZm9yKGxldCBsPTA7bDx1LmNvbHVtbnM7bCsrKXUuc2V0KGYsbCx1LmdldChmLGwpKigxLyhpW2ZdKmhbbF0pKSooMS8ocy5yb3dzLTEpKSk7cmV0dXJuIHV9ZnVuY3Rpb24gWm4ocyxuKXtzd2l0Y2gobil7Y2FzZSJldWNsaWRlYW4iOnJldHVybiAkdChzLEZlW25dKTtjYXNlImNvcnJlbGF0aW9uIjp7Y29uc3QgZT1uZXcgTShzKS50cmFuc3Bvc2UoKTtyZXR1cm4gWW4oZSkudG8yREFycmF5KCl9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVuc3VwcG9ydGVkIGRpc3RhbmNlIG1ldGhvZCAke259LmApfX1mdW5jdGlvbiBfbihzLG4pe3JldHVybiB5bihzLHtpc0Rpc3RhbmNlTWF0cml4OiEwLG1ldGhvZDpufSl9ZnVuY3Rpb24geG4ocyxuKXtyZXR1cm4oZSx0KT0+e2NvbnN0IG89c1t0XSxyPWUubWFwKChpLGgpPT4oe2JpbjpuP25baF06c1toXSxjb3VudDppfSkpO3JldHVybntiaW46byxiaW5zOnJ9fX1mdW5jdGlvbiBIdChzLG4pe2lmKHMuaXNMZWFmKXJldHVybntuYW1lOm5bcy5pbmRleF19O3tjb25zdCBlPVNuKCksdD1zLmNoaWxkcmVuLm1hcChvPT5IdChvLG4pKTtyZXR1cm57bmFtZTplLGNoaWxkcmVuOnR9fX1mdW5jdGlvbiBmdChzLG4pe3JldHVybiBzLmlzTGVhZj9uP3tbbltzLmluZGV4XV06cy5pbmRleH06W3MuaW5kZXhdOm4/cy5jaGlsZHJlbi5yZWR1Y2UoKHQsbyk9Pntjb25zdCByPWZ0KG8sbik7cmV0dXJuIFJ0KFJ0KHt9LHQpLHIpfSx7fSk6cy5jaGlsZHJlbi5yZWR1Y2UoKHQsbyk9Pntjb25zdCByPWZ0KG8pO3JldHVybiB0LnB1c2goLi4uciksdH0sW10pfWZ1bmN0aW9uIEFuKHMsbixlKXtyZXR1cm4gbi5tYXAobz0+e2NvbnN0IHI9c1tvXTtyZXR1cm4gZT9lLm1hcChoPT5yW2hdKTpuLm1hcChoPT5yW2hdKX0pfWZ1bmN0aW9uIHRvKHMsbixlLHQsbz0hMSl7Y29uc3Qgcj1vP0N0KHMsZSx0KTpNbihzLGUsdCksaT1vP3Q6ZSxoPVpuKHIsbiksdT1fbihuPT09ImNvcnJlbGF0aW9uIj9oLm1hcChqPT5qLm1hcCh2PT4xLU1hdGguYWJzKHYpKSk6aCwid2FyZCIpLGY9SHQodSxpKSxsPWZ0KHUsaSk7cmV0dXJue2JpbnM6QW4oaCxPYmplY3QudmFsdWVzKGwpKS5tYXAoeG4oT2JqZWN0LmtleXMobCkpKSx0cmVlOmZ9fW9ubWVzc2FnZT1mdW5jdGlvbihzKXtjb25zdHtkYXRhUm93czpuLGRpc3RhbmNlTWV0aG9kOmUsc3JjUmVwbGljYXRlTmFtZXM6dCxzcmNBY2Nlc3Npb25JZHM6byx0cmFuc3Bvc2U6cn09cy5kYXRhLGk9dG8obixlLHQsbyxyKTtwb3N0TWVzc2FnZShpLHZvaWQgMCl9fSkoKTt9KSgpOwo=",Pt=typeof window!="undefined"&&window.Blob&&new Blob([atob(Jt)],{type:"text/javascript;charset=utf-8"});function vd(){const l=Pt&&(window.URL||window.webkitURL).createObjectURL(Pt);try{return l?new Worker(l):new Worker("data:application/javascript;base64,"+Jt,{type:"module"})}finally{l&&(window.URL||window.webkitURL).revokeObjectURL(l)}}const kt="KCgpPT57KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IHF0PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7ZnVuY3Rpb24gcnQobil7cmV0dXJuIHF0LmNhbGwobikuZW5kc1dpdGgoIkFycmF5XSIpfWZ1bmN0aW9uIEZ0KG4pe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MSYmYXJndW1lbnRzWzFdIT09dm9pZCAwP2FyZ3VtZW50c1sxXTp7fTtpZighcnQobikpdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBiZSBhbiBhcnJheSIpO2lmKG4ubGVuZ3RoPT09MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IG5vdCBiZSBlbXB0eSIpO3ZhciBzPWUuZnJvbUluZGV4LHQ9cz09PXZvaWQgMD8wOnMscj1lLnRvSW5kZXgsbz1yPT09dm9pZCAwP24ubGVuZ3RoOnI7aWYodDwwfHx0Pj1uLmxlbmd0aHx8IU51bWJlci5pc0ludGVnZXIodCkpdGhyb3cgbmV3IEVycm9yKCJmcm9tSW5kZXggbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIgc21hbGxlciB0aGFuIGxlbmd0aCIpO2lmKG88PXR8fG8+bi5sZW5ndGh8fCFOdW1iZXIuaXNJbnRlZ2VyKG8pKXRocm93IG5ldyBFcnJvcigidG9JbmRleCBtdXN0IGJlIGFuIGludGVnZXIgZ3JlYXRlciB0aGFuIGZyb21JbmRleCBhbmQgYXQgbW9zdCBlcXVhbCB0byBsZW5ndGgiKTtmb3IodmFyIGk9blt0XSxoPXQrMTtoPG87aCsrKW5baF0+aSYmKGk9bltoXSk7cmV0dXJuIGl9ZnVuY3Rpb24gJHQobil7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4xJiZhcmd1bWVudHNbMV0hPT12b2lkIDA/YXJndW1lbnRzWzFdOnt9O2lmKCFydChuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IGJlIGFuIGFycmF5Iik7aWYobi5sZW5ndGg9PT0wKXRocm93IG5ldyBUeXBlRXJyb3IoImlucHV0IG11c3Qgbm90IGJlIGVtcHR5Iik7dmFyIHM9ZS5mcm9tSW5kZXgsdD1zPT09dm9pZCAwPzA6cyxyPWUudG9JbmRleCxvPXI9PT12b2lkIDA/bi5sZW5ndGg6cjtpZih0PDB8fHQ+PW4ubGVuZ3RofHwhTnVtYmVyLmlzSW50ZWdlcih0KSl0aHJvdyBuZXcgRXJyb3IoImZyb21JbmRleCBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciBzbWFsbGVyIHRoYW4gbGVuZ3RoIik7aWYobzw9dHx8bz5uLmxlbmd0aHx8IU51bWJlci5pc0ludGVnZXIobykpdGhyb3cgbmV3IEVycm9yKCJ0b0luZGV4IG11c3QgYmUgYW4gaW50ZWdlciBncmVhdGVyIHRoYW4gZnJvbUluZGV4IGFuZCBhdCBtb3N0IGVxdWFsIHRvIGxlbmd0aCIpO2Zvcih2YXIgaT1uW3RdLGg9dCsxO2g8bztoKyspbltoXTxpJiYoaT1uW2hdKTtyZXR1cm4gaX1mdW5jdGlvbiBkdChuKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjEmJmFyZ3VtZW50c1sxXSE9PXZvaWQgMD9hcmd1bWVudHNbMV06e307aWYocnQobikpe2lmKG4ubGVuZ3RoPT09MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJpbnB1dCBtdXN0IG5vdCBiZSBlbXB0eSIpfWVsc2UgdGhyb3cgbmV3IFR5cGVFcnJvcigiaW5wdXQgbXVzdCBiZSBhbiBhcnJheSIpO3ZhciBzO2lmKGUub3V0cHV0IT09dm9pZCAwKXtpZighcnQoZS5vdXRwdXQpKXRocm93IG5ldyBUeXBlRXJyb3IoIm91dHB1dCBvcHRpb24gbXVzdCBiZSBhbiBhcnJheSBpZiBzcGVjaWZpZWQiKTtzPWUub3V0cHV0fWVsc2Ugcz1uZXcgQXJyYXkobi5sZW5ndGgpO3ZhciB0PSR0KG4pLHI9RnQobik7aWYodD09PXIpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbmltdW0gYW5kIG1heGltdW0gaW5wdXQgdmFsdWVzIGFyZSBlcXVhbC4gQ2Fubm90IHJlc2NhbGUgYSBjb25zdGFudCBhcnJheSIpO3ZhciBvPWUubWluLGk9bz09PXZvaWQgMD9lLmF1dG9NaW5NYXg/dDowOm8saD1lLm1heCxhPWg9PT12b2lkIDA/ZS5hdXRvTWluTWF4P3I6MTpoO2lmKGk+PWEpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbiBvcHRpb24gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4IG9wdGlvbiIpO2Zvcih2YXIgbD0oYS1pKS8oci10KSxnPTA7ZzxuLmxlbmd0aDtnKyspc1tnXT0obltnXS10KSpsK2k7cmV0dXJuIHN9Y29uc3Qgb3Q9IiAiLnJlcGVhdCgyKSx5dD0iICIucmVwZWF0KDQpO2Z1bmN0aW9uIEN0KCl7cmV0dXJuIHZ0KHRoaXMpfWZ1bmN0aW9uIHZ0KG4sZT17fSl7Y29uc3R7bWF4Um93czpzPTE1LG1heENvbHVtbnM6dD0xMCxtYXhOdW1TaXplOnI9OH09ZTtyZXR1cm5gJHtuLmNvbnN0cnVjdG9yLm5hbWV9IHsKJHtvdH1bCiR7eXR9JHtQdChuLHMsdCxyKX0KJHtvdH1dCiR7b3R9cm93czogJHtuLnJvd3N9CiR7b3R9Y29sdW1uczogJHtuLmNvbHVtbnN9Cn1gfWZ1bmN0aW9uIFB0KG4sZSxzLHQpe2NvbnN0e3Jvd3M6cixjb2x1bW5zOm99PW4saT1NYXRoLm1pbihyLGUpLGg9TWF0aC5taW4obyxzKSxhPVtdO2ZvcihsZXQgbD0wO2w8aTtsKyspe2xldCBnPVtdO2ZvcihsZXQgdT0wO3U8aDt1KyspZy5wdXNoKEx0KG4uZ2V0KGwsdSksdCkpO2EucHVzaChgJHtnLmpvaW4oIiAiKX1gKX1yZXR1cm4gaCE9PW8mJihhW2EubGVuZ3RoLTFdKz1gIC4uLiAke28tc30gbW9yZSBjb2x1bW5zYCksaSE9PXImJmEucHVzaChgLi4uICR7ci1lfSBtb3JlIHJvd3NgKSxhLmpvaW4oYAoke3l0fWApfWZ1bmN0aW9uIEx0KG4sZSl7Y29uc3Qgcz1TdHJpbmcobik7aWYocy5sZW5ndGg8PWUpcmV0dXJuIHMucGFkRW5kKGUsIiAiKTtjb25zdCB0PW4udG9QcmVjaXNpb24oZS0yKTtpZih0Lmxlbmd0aDw9ZSlyZXR1cm4gdDtjb25zdCByPW4udG9FeHBvbmVudGlhbChlLTIpLG89ci5pbmRleE9mKCJlIiksaT1yLnNsaWNlKG8pO3JldHVybiByLnNsaWNlKDAsZS1pLmxlbmd0aCkraX1mdW5jdGlvbiB6dChuLGUpe24ucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuYWRkUyh0KTp0aGlzLmFkZE0odCl9LG4ucHJvdG90eXBlLmFkZFM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKSt0KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuYWRkTT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykrdC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4uYWRkPWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLmFkZChyKX0sbi5wcm90b3R5cGUuc3ViPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5zdWJTKHQpOnRoaXMuc3ViTSh0KX0sbi5wcm90b3R5cGUuc3ViUz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pLXQpO3JldHVybiB0aGlzfSxuLnByb3RvdHlwZS5zdWJNPWZ1bmN0aW9uKHQpe2lmKHQ9ZS5jaGVja01hdHJpeCh0KSx0aGlzLnJvd3MhPT10LnJvd3N8fHRoaXMuY29sdW1ucyE9PXQuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiTWF0cmljZXMgZGltZW5zaW9ucyBtdXN0IGJlIGVxdWFsIik7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKS10LmdldChyLG8pKTtyZXR1cm4gdGhpc30sbi5zdWI9ZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IGUodCkuc3ViKHIpfSxuLnByb3RvdHlwZS5zdWJ0cmFjdD1uLnByb3RvdHlwZS5zdWIsbi5wcm90b3R5cGUuc3VidHJhY3RTPW4ucHJvdG90eXBlLnN1YlMsbi5wcm90b3R5cGUuc3VidHJhY3RNPW4ucHJvdG90eXBlLnN1Yk0sbi5zdWJ0cmFjdD1uLnN1YixuLnByb3RvdHlwZS5tdWw9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLm11bFModCk6dGhpcy5tdWxNKHQpfSxuLnByb3RvdHlwZS5tdWxTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykqdCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLm11bE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pKnQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLm11bD1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS5tdWwocil9LG4ucHJvdG90eXBlLm11bHRpcGx5PW4ucHJvdG90eXBlLm11bCxuLnByb3RvdHlwZS5tdWx0aXBseVM9bi5wcm90b3R5cGUubXVsUyxuLnByb3RvdHlwZS5tdWx0aXBseU09bi5wcm90b3R5cGUubXVsTSxuLm11bHRpcGx5PW4ubXVsLG4ucHJvdG90eXBlLmRpdj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMuZGl2Uyh0KTp0aGlzLmRpdk0odCl9LG4ucHJvdG90eXBlLmRpdlM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKS90KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuZGl2TT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykvdC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4uZGl2PWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLmRpdihyKX0sbi5wcm90b3R5cGUuZGl2aWRlPW4ucHJvdG90eXBlLmRpdixuLnByb3RvdHlwZS5kaXZpZGVTPW4ucHJvdG90eXBlLmRpdlMsbi5wcm90b3R5cGUuZGl2aWRlTT1uLnByb3RvdHlwZS5kaXZNLG4uZGl2aWRlPW4uZGl2LG4ucHJvdG90eXBlLm1vZD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMubW9kUyh0KTp0aGlzLm1vZE0odCl9LG4ucHJvdG90eXBlLm1vZFM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKSV0KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUubW9kTT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykldC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4ubW9kPWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLm1vZChyKX0sbi5wcm90b3R5cGUubW9kdWx1cz1uLnByb3RvdHlwZS5tb2Qsbi5wcm90b3R5cGUubW9kdWx1c1M9bi5wcm90b3R5cGUubW9kUyxuLnByb3RvdHlwZS5tb2R1bHVzTT1uLnByb3RvdHlwZS5tb2RNLG4ubW9kdWx1cz1uLm1vZCxuLnByb3RvdHlwZS5hbmQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLmFuZFModCk6dGhpcy5hbmRNKHQpfSxuLnByb3RvdHlwZS5hbmRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbykmdCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLmFuZE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pJnQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLmFuZD1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS5hbmQocil9LG4ucHJvdG90eXBlLm9yPWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5vclModCk6dGhpcy5vck0odCl9LG4ucHJvdG90eXBlLm9yUz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pfHQpO3JldHVybiB0aGlzfSxuLnByb3RvdHlwZS5vck09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pfHQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLm9yPWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLm9yKHIpfSxuLnByb3RvdHlwZS54b3I9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnhvclModCk6dGhpcy54b3JNKHQpfSxuLnByb3RvdHlwZS54b3JTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbyledCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLnhvck09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pXnQuZ2V0KHIsbykpO3JldHVybiB0aGlzfSxuLnhvcj1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS54b3Iocil9LG4ucHJvdG90eXBlLmxlZnRTaGlmdD1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQ9PSJudW1iZXIiP3RoaXMubGVmdFNoaWZ0Uyh0KTp0aGlzLmxlZnRTaGlmdE0odCl9LG4ucHJvdG90eXBlLmxlZnRTaGlmdFM9ZnVuY3Rpb24odCl7Zm9yKGxldCByPTA7cjx0aGlzLnJvd3M7cisrKWZvcihsZXQgbz0wO288dGhpcy5jb2x1bW5zO28rKyl0aGlzLnNldChyLG8sdGhpcy5nZXQocixvKTw8dCk7cmV0dXJuIHRoaXN9LG4ucHJvdG90eXBlLmxlZnRTaGlmdE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPDx0LmdldChyLG8pKTtyZXR1cm4gdGhpc30sbi5sZWZ0U2hpZnQ9ZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IGUodCkubGVmdFNoaWZ0KHIpfSxuLnByb3RvdHlwZS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0Uyh0KTp0aGlzLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnRNKHQpfSxuLnByb3RvdHlwZS5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0Uz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPj50KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuc2lnblByb3BhZ2F0aW5nUmlnaHRTaGlmdE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPj50LmdldChyLG8pKTtyZXR1cm4gdGhpc30sbi5zaWduUHJvcGFnYXRpbmdSaWdodFNoaWZ0PWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLnNpZ25Qcm9wYWdhdGluZ1JpZ2h0U2hpZnQocil9LG4ucHJvdG90eXBlLnJpZ2h0U2hpZnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0PT0ibnVtYmVyIj90aGlzLnJpZ2h0U2hpZnRTKHQpOnRoaXMucmlnaHRTaGlmdE0odCl9LG4ucHJvdG90eXBlLnJpZ2h0U2hpZnRTPWZ1bmN0aW9uKHQpe2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLHRoaXMuZ2V0KHIsbyk+Pj50KTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUucmlnaHRTaGlmdE09ZnVuY3Rpb24odCl7aWYodD1lLmNoZWNrTWF0cml4KHQpLHRoaXMucm93cyE9PXQucm93c3x8dGhpcy5jb2x1bW5zIT09dC5jb2x1bW5zKXRocm93IG5ldyBSYW5nZUVycm9yKCJNYXRyaWNlcyBkaW1lbnNpb25zIG11c3QgYmUgZXF1YWwiKTtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyx0aGlzLmdldChyLG8pPj4+dC5nZXQocixvKSk7cmV0dXJuIHRoaXN9LG4ucmlnaHRTaGlmdD1mdW5jdGlvbih0LHIpe3JldHVybiBuZXcgZSh0KS5yaWdodFNoaWZ0KHIpfSxuLnByb3RvdHlwZS56ZXJvRmlsbFJpZ2h0U2hpZnQ9bi5wcm90b3R5cGUucmlnaHRTaGlmdCxuLnByb3RvdHlwZS56ZXJvRmlsbFJpZ2h0U2hpZnRTPW4ucHJvdG90eXBlLnJpZ2h0U2hpZnRTLG4ucHJvdG90eXBlLnplcm9GaWxsUmlnaHRTaGlmdE09bi5wcm90b3R5cGUucmlnaHRTaGlmdE0sbi56ZXJvRmlsbFJpZ2h0U2hpZnQ9bi5yaWdodFNoaWZ0LG4ucHJvdG90eXBlLm5vdD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLH50aGlzLmdldCh0LHIpKTtyZXR1cm4gdGhpc30sbi5ub3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLm5vdCgpfSxuLnByb3RvdHlwZS5hYnM9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmFicyh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uYWJzPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5hYnMoKX0sbi5wcm90b3R5cGUuYWNvcz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguYWNvcyh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uYWNvcz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuYWNvcygpfSxuLnByb3RvdHlwZS5hY29zaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguYWNvc2godGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmFjb3NoPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5hY29zaCgpfSxuLnByb3RvdHlwZS5hc2luPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5hc2luKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5hc2luPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5hc2luKCl9LG4ucHJvdG90eXBlLmFzaW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5hc2luaCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uYXNpbmg9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmFzaW5oKCl9LG4ucHJvdG90eXBlLmF0YW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmF0YW4odGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmF0YW49ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmF0YW4oKX0sbi5wcm90b3R5cGUuYXRhbmg9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmF0YW5oKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5hdGFuaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuYXRhbmgoKX0sbi5wcm90b3R5cGUuY2JydD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguY2JydCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uY2JydD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuY2JydCgpfSxuLnByb3RvdHlwZS5jZWlsPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5jZWlsKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5jZWlsPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5jZWlsKCl9LG4ucHJvdG90eXBlLmNsejMyPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5jbHozMih0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uY2x6MzI9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmNsejMyKCl9LG4ucHJvdG90eXBlLmNvcz1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguY29zKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5jb3M9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmNvcygpfSxuLnByb3RvdHlwZS5jb3NoPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5jb3NoKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5jb3NoPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5jb3NoKCl9LG4ucHJvdG90eXBlLmV4cD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguZXhwKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5leHA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmV4cCgpfSxuLnByb3RvdHlwZS5leHBtMT1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguZXhwbTEodGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmV4cG0xPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5leHBtMSgpfSxuLnByb3RvdHlwZS5mbG9vcj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguZmxvb3IodGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmZsb29yPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5mbG9vcigpfSxuLnByb3RvdHlwZS5mcm91bmQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmZyb3VuZCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uZnJvdW5kPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5mcm91bmQoKX0sbi5wcm90b3R5cGUubG9nPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5sb2codGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmxvZz1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkubG9nKCl9LG4ucHJvdG90eXBlLmxvZzFwPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5sb2cxcCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4ubG9nMXA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmxvZzFwKCl9LG4ucHJvdG90eXBlLmxvZzEwPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5sb2cxMCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4ubG9nMTA9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmxvZzEwKCl9LG4ucHJvdG90eXBlLmxvZzI9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLmxvZzIodGhpcy5nZXQodCxyKSkpO3JldHVybiB0aGlzfSxuLmxvZzI9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLmxvZzIoKX0sbi5wcm90b3R5cGUucm91bmQ9ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLnJvdW5kKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5yb3VuZD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkucm91bmQoKX0sbi5wcm90b3R5cGUuc2lnbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguc2lnbih0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uc2lnbj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuc2lnbigpfSxuLnByb3RvdHlwZS5zaW49ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0KyspZm9yKGxldCByPTA7cjx0aGlzLmNvbHVtbnM7cisrKXRoaXMuc2V0KHQscixNYXRoLnNpbih0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uc2luPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5zaW4oKX0sbi5wcm90b3R5cGUuc2luaD1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGguc2luaCh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4uc2luaD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCkuc2luaCgpfSxuLnByb3RvdHlwZS5zcXJ0PWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC5zcXJ0KHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi5zcXJ0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS5zcXJ0KCl9LG4ucHJvdG90eXBlLnRhbj1mdW5jdGlvbigpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5zZXQodCxyLE1hdGgudGFuKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi50YW49ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLnRhbigpfSxuLnByb3RvdHlwZS50YW5oPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC50YW5oKHRoaXMuZ2V0KHQscikpKTtyZXR1cm4gdGhpc30sbi50YW5oPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0KS50YW5oKCl9LG4ucHJvdG90eXBlLnRydW5jPWZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLnNldCh0LHIsTWF0aC50cnVuYyh0aGlzLmdldCh0LHIpKSk7cmV0dXJuIHRoaXN9LG4udHJ1bmM9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHQpLnRydW5jKCl9LG4ucG93PWZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQpLnBvdyhyKX0sbi5wcm90b3R5cGUucG93PWZ1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdD09Im51bWJlciI/dGhpcy5wb3dTKHQpOnRoaXMucG93TSh0KX0sbi5wcm90b3R5cGUucG93Uz1mdW5jdGlvbih0KXtmb3IobGV0IHI9MDtyPHRoaXMucm93cztyKyspZm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXRoaXMuc2V0KHIsbyxNYXRoLnBvdyh0aGlzLmdldChyLG8pLHQpKTtyZXR1cm4gdGhpc30sbi5wcm90b3R5cGUucG93TT1mdW5jdGlvbih0KXtpZih0PWUuY2hlY2tNYXRyaXgodCksdGhpcy5yb3dzIT09dC5yb3dzfHx0aGlzLmNvbHVtbnMhPT10LmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIk1hdHJpY2VzIGRpbWVuc2lvbnMgbXVzdCBiZSBlcXVhbCIpO2ZvcihsZXQgcj0wO3I8dGhpcy5yb3dzO3IrKylmb3IobGV0IG89MDtvPHRoaXMuY29sdW1ucztvKyspdGhpcy5zZXQocixvLE1hdGgucG93KHRoaXMuZ2V0KHIsbyksdC5nZXQocixvKSkpO3JldHVybiB0aGlzfX1mdW5jdGlvbiBXKG4sZSxzKXtsZXQgdD1zP24ucm93czpuLnJvd3MtMTtpZihlPDB8fGU+dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiUm93IGluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEoobixlLHMpe2xldCB0PXM/bi5jb2x1bW5zOm4uY29sdW1ucy0xO2lmKGU8MHx8ZT50KXRocm93IG5ldyBSYW5nZUVycm9yKCJDb2x1bW4gaW5kZXggb3V0IG9mIHJhbmdlIil9ZnVuY3Rpb24gQShuLGUpe2lmKGUudG8xREFycmF5JiYoZT1lLnRvMURBcnJheSgpKSxlLmxlbmd0aCE9PW4uY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigidmVjdG9yIHNpemUgbXVzdCBiZSB0aGUgc2FtZSBhcyB0aGUgbnVtYmVyIG9mIGNvbHVtbnMiKTtyZXR1cm4gZX1mdW5jdGlvbiBIKG4sZSl7aWYoZS50bzFEQXJyYXkmJihlPWUudG8xREFycmF5KCkpLGUubGVuZ3RoIT09bi5yb3dzKXRocm93IG5ldyBSYW5nZUVycm9yKCJ2ZWN0b3Igc2l6ZSBtdXN0IGJlIHRoZSBzYW1lIGFzIHRoZSBudW1iZXIgb2Ygcm93cyIpO3JldHVybiBlfWZ1bmN0aW9uIE90KG4sZSxzKXtyZXR1cm57cm93OkR0KG4sZSksY29sdW1uOlV0KG4scyl9fWZ1bmN0aW9uIER0KG4sZSl7aWYodHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoInVuZXhwZWN0ZWQgdHlwZSBmb3Igcm93IGluZGljZXMiKTtpZihlLnNvbWUodD0+dDwwfHx0Pj1uLnJvd3MpKXRocm93IG5ldyBSYW5nZUVycm9yKCJyb3cgaW5kaWNlcyBhcmUgb3V0IG9mIHJhbmdlIik7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSl8fChlPUFycmF5LmZyb20oZSkpLGV9ZnVuY3Rpb24gVXQobixlKXtpZih0eXBlb2YgZSE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigidW5leHBlY3RlZCB0eXBlIGZvciBjb2x1bW4gaW5kaWNlcyIpO2lmKGUuc29tZSh0PT50PDB8fHQ+PW4uY29sdW1ucykpdGhyb3cgbmV3IFJhbmdlRXJyb3IoImNvbHVtbiBpbmRpY2VzIGFyZSBvdXQgb2YgcmFuZ2UiKTtyZXR1cm4gQXJyYXkuaXNBcnJheShlKXx8KGU9QXJyYXkuZnJvbShlKSksZX1mdW5jdGlvbiBNdChuLGUscyx0LHIpe2lmKGFyZ3VtZW50cy5sZW5ndGghPT01KXRocm93IG5ldyBSYW5nZUVycm9yKCJleHBlY3RlZCA0IGFyZ3VtZW50cyIpO2lmKGl0KCJzdGFydFJvdyIsZSksaXQoImVuZFJvdyIscyksaXQoInN0YXJ0Q29sdW1uIix0KSxpdCgiZW5kQ29sdW1uIixyKSxlPnN8fHQ+cnx8ZTwwfHxlPj1uLnJvd3N8fHM8MHx8cz49bi5yb3dzfHx0PDB8fHQ+PW4uY29sdW1uc3x8cjwwfHxyPj1uLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIlN1Ym1hdHJpeCBpbmRpY2VzIGFyZSBvdXQgb2YgcmFuZ2UiKX1mdW5jdGlvbiBudChuLGU9MCl7bGV0IHM9W107Zm9yKGxldCB0PTA7dDxuO3QrKylzLnB1c2goZSk7cmV0dXJuIHN9ZnVuY3Rpb24gaXQobixlKXtpZih0eXBlb2YgZSE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcihgJHtufSBtdXN0IGJlIGEgbnVtYmVyYCl9ZnVuY3Rpb24gdHQobil7aWYobi5pc0VtcHR5KCkpdGhyb3cgbmV3IEVycm9yKCJFbXB0eSBtYXRyaXggaGFzIG5vIGVsZW1lbnRzIHRvIGluZGV4Iil9ZnVuY3Rpb24gVnQobil7bGV0IGU9bnQobi5yb3dzKTtmb3IobGV0IHM9MDtzPG4ucm93czsrK3MpZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7Kyt0KWVbc10rPW4uZ2V0KHMsdCk7cmV0dXJuIGV9ZnVuY3Rpb24gQnQobil7bGV0IGU9bnQobi5jb2x1bW5zKTtmb3IobGV0IHM9MDtzPG4ucm93czsrK3MpZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7Kyt0KWVbdF0rPW4uZ2V0KHMsdCk7cmV0dXJuIGV9ZnVuY3Rpb24gWXQobil7bGV0IGU9MDtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKWUrPW4uZ2V0KHMsdCk7cmV0dXJuIGV9ZnVuY3Rpb24gX3Qobil7bGV0IGU9bnQobi5yb3dzLDEpO2ZvcihsZXQgcz0wO3M8bi5yb3dzOysrcylmb3IobGV0IHQ9MDt0PG4uY29sdW1uczsrK3QpZVtzXSo9bi5nZXQocyx0KTtyZXR1cm4gZX1mdW5jdGlvbiBYdChuKXtsZXQgZT1udChuLmNvbHVtbnMsMSk7Zm9yKGxldCBzPTA7czxuLnJvd3M7KytzKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zOysrdCllW3RdKj1uLmdldChzLHQpO3JldHVybiBlfWZ1bmN0aW9uIFp0KG4pe2xldCBlPTE7Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zO3QrKyllKj1uLmdldChzLHQpO3JldHVybiBlfWZ1bmN0aW9uIEd0KG4sZSxzKXtjb25zdCB0PW4ucm93cyxyPW4uY29sdW1ucyxvPVtdO2ZvcihsZXQgaT0wO2k8dDtpKyspe2xldCBoPTAsYT0wLGw9MDtmb3IobGV0IGc9MDtnPHI7ZysrKWw9bi5nZXQoaSxnKS1zW2ldLGgrPWwsYSs9bCpsO2U/by5wdXNoKChhLWgqaC9yKS8oci0xKSk6by5wdXNoKChhLWgqaC9yKS9yKX1yZXR1cm4gb31mdW5jdGlvbiBXdChuLGUscyl7Y29uc3QgdD1uLnJvd3Mscj1uLmNvbHVtbnMsbz1bXTtmb3IobGV0IGk9MDtpPHI7aSsrKXtsZXQgaD0wLGE9MCxsPTA7Zm9yKGxldCBnPTA7Zzx0O2crKylsPW4uZ2V0KGcsaSktc1tpXSxoKz1sLGErPWwqbDtlP28ucHVzaCgoYS1oKmgvdCkvKHQtMSkpOm8ucHVzaCgoYS1oKmgvdCkvdCl9cmV0dXJuIG99ZnVuY3Rpb24gSnQobixlLHMpe2NvbnN0IHQ9bi5yb3dzLHI9bi5jb2x1bW5zLG89dCpyO2xldCBpPTAsaD0wLGE9MDtmb3IobGV0IGw9MDtsPHQ7bCsrKWZvcihsZXQgZz0wO2c8cjtnKyspYT1uLmdldChsLGcpLXMsaSs9YSxoKz1hKmE7cmV0dXJuIGU/KGgtaSppL28pLyhvLTEpOihoLWkqaS9vKS9vfWZ1bmN0aW9uIFF0KG4sZSl7Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zO3QrKyluLnNldChzLHQsbi5nZXQocyx0KS1lW3NdKX1mdW5jdGlvbiBLdChuLGUpe2ZvcihsZXQgcz0wO3M8bi5yb3dzO3MrKylmb3IobGV0IHQ9MDt0PG4uY29sdW1uczt0Kyspbi5zZXQocyx0LG4uZ2V0KHMsdCktZVt0XSl9ZnVuY3Rpb24geHQobixlKXtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKW4uc2V0KHMsdCxuLmdldChzLHQpLWUpfWZ1bmN0aW9uIEF0KG4pe2NvbnN0IGU9W107Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKXtsZXQgdD0wO2ZvcihsZXQgcj0wO3I8bi5jb2x1bW5zO3IrKyl0Kz1NYXRoLnBvdyhuLmdldChzLHIpLDIpLyhuLmNvbHVtbnMtMSk7ZS5wdXNoKE1hdGguc3FydCh0KSl9cmV0dXJuIGV9ZnVuY3Rpb24gSHQobixlKXtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKW4uc2V0KHMsdCxuLmdldChzLHQpL2Vbc10pfWZ1bmN0aW9uIHRlKG4pe2NvbnN0IGU9W107Zm9yKGxldCBzPTA7czxuLmNvbHVtbnM7cysrKXtsZXQgdD0wO2ZvcihsZXQgcj0wO3I8bi5yb3dzO3IrKyl0Kz1NYXRoLnBvdyhuLmdldChyLHMpLDIpLyhuLnJvd3MtMSk7ZS5wdXNoKE1hdGguc3FydCh0KSl9cmV0dXJuIGV9ZnVuY3Rpb24gZWUobixlKXtmb3IobGV0IHM9MDtzPG4ucm93cztzKyspZm9yKGxldCB0PTA7dDxuLmNvbHVtbnM7dCsrKW4uc2V0KHMsdCxuLmdldChzLHQpL2VbdF0pfWZ1bmN0aW9uIHNlKG4pe2NvbnN0IGU9bi5zaXplLTE7bGV0IHM9MDtmb3IobGV0IHQ9MDt0PG4uY29sdW1uczt0KyspZm9yKGxldCByPTA7cjxuLnJvd3M7cisrKXMrPU1hdGgucG93KG4uZ2V0KHIsdCksMikvZTtyZXR1cm4gTWF0aC5zcXJ0KHMpfWZ1bmN0aW9uIHJlKG4sZSl7Zm9yKGxldCBzPTA7czxuLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8bi5jb2x1bW5zO3QrKyluLnNldChzLHQsbi5nZXQocyx0KS9lKX1jbGFzcyBxe3N0YXRpYyBmcm9tMURBcnJheShlLHMsdCl7aWYoZSpzIT09dC5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoImRhdGEgbGVuZ3RoIGRvZXMgbm90IG1hdGNoIGdpdmVuIGRpbWVuc2lvbnMiKTtsZXQgbz1uZXcgVChlLHMpO2ZvcihsZXQgaT0wO2k8ZTtpKyspZm9yKGxldCBoPTA7aDxzO2grKylvLnNldChpLGgsdFtpKnMraF0pO3JldHVybiBvfXN0YXRpYyByb3dWZWN0b3IoZSl7bGV0IHM9bmV3IFQoMSxlLmxlbmd0aCk7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDt0Kyspcy5zZXQoMCx0LGVbdF0pO3JldHVybiBzfXN0YXRpYyBjb2x1bW5WZWN0b3IoZSl7bGV0IHM9bmV3IFQoZS5sZW5ndGgsMSk7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDt0Kyspcy5zZXQodCwwLGVbdF0pO3JldHVybiBzfXN0YXRpYyB6ZXJvcyhlLHMpe3JldHVybiBuZXcgVChlLHMpfXN0YXRpYyBvbmVzKGUscyl7cmV0dXJuIG5ldyBUKGUscykuZmlsbCgxKX1zdGF0aWMgcmFuZChlLHMsdD17fSl7aWYodHlwZW9mIHQhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtyYW5kb206cj1NYXRoLnJhbmRvbX09dDtsZXQgbz1uZXcgVChlLHMpO2ZvcihsZXQgaT0wO2k8ZTtpKyspZm9yKGxldCBoPTA7aDxzO2grKylvLnNldChpLGgscigpKTtyZXR1cm4gb31zdGF0aWMgcmFuZEludChlLHMsdD17fSl7aWYodHlwZW9mIHQhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46cj0wLG1heDpvPTFlMyxyYW5kb206aT1NYXRoLnJhbmRvbX09dDtpZighTnVtYmVyLmlzSW50ZWdlcihyKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhbiBpbnRlZ2VyIik7aWYoIU51bWJlci5pc0ludGVnZXIobykpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYW4gaW50ZWdlciIpO2lmKHI+PW8pdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm1pbiBtdXN0IGJlIHNtYWxsZXIgdGhhbiBtYXgiKTtsZXQgaD1vLXIsYT1uZXcgVChlLHMpO2ZvcihsZXQgbD0wO2w8ZTtsKyspZm9yKGxldCBnPTA7ZzxzO2crKyl7bGV0IHU9citNYXRoLnJvdW5kKGkoKSpoKTthLnNldChsLGcsdSl9cmV0dXJuIGF9c3RhdGljIGV5ZShlLHMsdCl7cz09PXZvaWQgMCYmKHM9ZSksdD09PXZvaWQgMCYmKHQ9MSk7bGV0IHI9TWF0aC5taW4oZSxzKSxvPXRoaXMuemVyb3MoZSxzKTtmb3IobGV0IGk9MDtpPHI7aSsrKW8uc2V0KGksaSx0KTtyZXR1cm4gb31zdGF0aWMgZGlhZyhlLHMsdCl7bGV0IHI9ZS5sZW5ndGg7cz09PXZvaWQgMCYmKHM9ciksdD09PXZvaWQgMCYmKHQ9cyk7bGV0IG89TWF0aC5taW4ocixzLHQpLGk9dGhpcy56ZXJvcyhzLHQpO2ZvcihsZXQgaD0wO2g8bztoKyspaS5zZXQoaCxoLGVbaF0pO3JldHVybiBpfXN0YXRpYyBtaW4oZSxzKXtlPXRoaXMuY2hlY2tNYXRyaXgoZSkscz10aGlzLmNoZWNrTWF0cml4KHMpO2xldCB0PWUucm93cyxyPWUuY29sdW1ucyxvPW5ldyBUKHQscik7Zm9yKGxldCBpPTA7aTx0O2krKylmb3IobGV0IGg9MDtoPHI7aCsrKW8uc2V0KGksaCxNYXRoLm1pbihlLmdldChpLGgpLHMuZ2V0KGksaCkpKTtyZXR1cm4gb31zdGF0aWMgbWF4KGUscyl7ZT10aGlzLmNoZWNrTWF0cml4KGUpLHM9dGhpcy5jaGVja01hdHJpeChzKTtsZXQgdD1lLnJvd3Mscj1lLmNvbHVtbnMsbz1uZXcgdGhpcyh0LHIpO2ZvcihsZXQgaT0wO2k8dDtpKyspZm9yKGxldCBoPTA7aDxyO2grKylvLnNldChpLGgsTWF0aC5tYXgoZS5nZXQoaSxoKSxzLmdldChpLGgpKSk7cmV0dXJuIG99c3RhdGljIGNoZWNrTWF0cml4KGUpe3JldHVybiBxLmlzTWF0cml4KGUpP2U6bmV3IFQoZSl9c3RhdGljIGlzTWF0cml4KGUpe3JldHVybiBlIT1udWxsJiZlLmtsYXNzPT09Ik1hdHJpeCJ9Z2V0IHNpemUoKXtyZXR1cm4gdGhpcy5yb3dzKnRoaXMuY29sdW1uc31hcHBseShlKXtpZih0eXBlb2YgZSE9ImZ1bmN0aW9uIil0aHJvdyBuZXcgVHlwZUVycm9yKCJjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24iKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKWUuY2FsbCh0aGlzLHMsdCk7cmV0dXJuIHRoaXN9dG8xREFycmF5KCl7bGV0IGU9W107Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllLnB1c2godGhpcy5nZXQocyx0KSk7cmV0dXJuIGV9dG8yREFycmF5KCl7bGV0IGU9W107Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXtlLnB1c2goW10pO2ZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllW3NdLnB1c2godGhpcy5nZXQocyx0KSl9cmV0dXJuIGV9dG9KU09OKCl7cmV0dXJuIHRoaXMudG8yREFycmF5KCl9aXNSb3dWZWN0b3IoKXtyZXR1cm4gdGhpcy5yb3dzPT09MX1pc0NvbHVtblZlY3Rvcigpe3JldHVybiB0aGlzLmNvbHVtbnM9PT0xfWlzVmVjdG9yKCl7cmV0dXJuIHRoaXMucm93cz09PTF8fHRoaXMuY29sdW1ucz09PTF9aXNTcXVhcmUoKXtyZXR1cm4gdGhpcy5yb3dzPT09dGhpcy5jb2x1bW5zfWlzRW1wdHkoKXtyZXR1cm4gdGhpcy5yb3dzPT09MHx8dGhpcy5jb2x1bW5zPT09MH1pc1N5bW1ldHJpYygpe2lmKHRoaXMuaXNTcXVhcmUoKSl7Zm9yKGxldCBlPTA7ZTx0aGlzLnJvd3M7ZSsrKWZvcihsZXQgcz0wO3M8PWU7cysrKWlmKHRoaXMuZ2V0KGUscykhPT10aGlzLmdldChzLGUpKXJldHVybiExO3JldHVybiEwfXJldHVybiExfWlzRWNoZWxvbkZvcm0oKXtsZXQgZT0wLHM9MCx0PS0xLHI9ITAsbz0hMTtmb3IoO2U8dGhpcy5yb3dzJiZyOyl7Zm9yKHM9MCxvPSExO3M8dGhpcy5jb2x1bW5zJiZvPT09ITE7KXRoaXMuZ2V0KGUscyk9PT0wP3MrKzp0aGlzLmdldChlLHMpPT09MSYmcz50PyhvPSEwLHQ9cyk6KHI9ITEsbz0hMCk7ZSsrfXJldHVybiByfWlzUmVkdWNlZEVjaGVsb25Gb3JtKCl7bGV0IGU9MCxzPTAsdD0tMSxyPSEwLG89ITE7Zm9yKDtlPHRoaXMucm93cyYmcjspe2ZvcihzPTAsbz0hMTtzPHRoaXMuY29sdW1ucyYmbz09PSExOyl0aGlzLmdldChlLHMpPT09MD9zKys6dGhpcy5nZXQoZSxzKT09PTEmJnM+dD8obz0hMCx0PXMpOihyPSExLG89ITApO2ZvcihsZXQgaT1zKzE7aTx0aGlzLnJvd3M7aSsrKXRoaXMuZ2V0KGUsaSkhPT0wJiYocj0hMSk7ZSsrfXJldHVybiByfWVjaGVsb25Gb3JtKCl7bGV0IGU9dGhpcy5jbG9uZSgpLHM9MCx0PTA7Zm9yKDtzPGUucm93cyYmdDxlLmNvbHVtbnM7KXtsZXQgcj1zO2ZvcihsZXQgbz1zO288ZS5yb3dzO28rKyllLmdldChvLHQpPmUuZ2V0KHIsdCkmJihyPW8pO2lmKGUuZ2V0KHIsdCk9PT0wKXQrKztlbHNle2Uuc3dhcFJvd3MocyxyKTtsZXQgbz1lLmdldChzLHQpO2ZvcihsZXQgaT10O2k8ZS5jb2x1bW5zO2krKyllLnNldChzLGksZS5nZXQocyxpKS9vKTtmb3IobGV0IGk9cysxO2k8ZS5yb3dzO2krKyl7bGV0IGg9ZS5nZXQoaSx0KS9lLmdldChzLHQpO2Uuc2V0KGksdCwwKTtmb3IobGV0IGE9dCsxO2E8ZS5jb2x1bW5zO2ErKyllLnNldChpLGEsZS5nZXQoaSxhKS1lLmdldChzLGEpKmgpfXMrKyx0Kyt9fXJldHVybiBlfXJlZHVjZWRFY2hlbG9uRm9ybSgpe2xldCBlPXRoaXMuZWNoZWxvbkZvcm0oKSxzPWUuY29sdW1ucyx0PWUucm93cyxyPXQtMTtmb3IoO3I+PTA7KWlmKGUubWF4Um93KHIpPT09MClyLS07ZWxzZXtsZXQgbz0wLGk9ITE7Zm9yKDtvPHQmJmk9PT0hMTspZS5nZXQocixvKT09PTE/aT0hMDpvKys7Zm9yKGxldCBoPTA7aDxyO2grKyl7bGV0IGE9ZS5nZXQoaCxvKTtmb3IobGV0IGw9bztsPHM7bCsrKXtsZXQgZz1lLmdldChoLGwpLWEqZS5nZXQocixsKTtlLnNldChoLGwsZyl9fXItLX1yZXR1cm4gZX1zZXQoKXt0aHJvdyBuZXcgRXJyb3IoInNldCBtZXRob2QgaXMgdW5pbXBsZW1lbnRlZCIpfWdldCgpe3Rocm93IG5ldyBFcnJvcigiZ2V0IG1ldGhvZCBpcyB1bmltcGxlbWVudGVkIil9cmVwZWF0KGU9e30pe2lmKHR5cGVvZiBlIT0ib2JqZWN0Iil0aHJvdyBuZXcgVHlwZUVycm9yKCJvcHRpb25zIG11c3QgYmUgYW4gb2JqZWN0Iik7Y29uc3R7cm93czpzPTEsY29sdW1uczp0PTF9PWU7aWYoIU51bWJlci5pc0ludGVnZXIocyl8fHM8PTApdGhyb3cgbmV3IFR5cGVFcnJvcigicm93cyBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlciIpO2lmKCFOdW1iZXIuaXNJbnRlZ2VyKHQpfHx0PD0wKXRocm93IG5ldyBUeXBlRXJyb3IoImNvbHVtbnMgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIiKTtsZXQgcj1uZXcgVCh0aGlzLnJvd3Mqcyx0aGlzLmNvbHVtbnMqdCk7Zm9yKGxldCBvPTA7bzxzO28rKylmb3IobGV0IGk9MDtpPHQ7aSsrKXIuc2V0U3ViTWF0cml4KHRoaXMsdGhpcy5yb3dzKm8sdGhpcy5jb2x1bW5zKmkpO3JldHVybiByfWZpbGwoZSl7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLnNldChzLHQsZSk7cmV0dXJuIHRoaXN9bmVnKCl7cmV0dXJuIHRoaXMubXVsUygtMSl9Z2V0Um93KGUpe1codGhpcyxlKTtsZXQgcz1bXTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspcy5wdXNoKHRoaXMuZ2V0KGUsdCkpO3JldHVybiBzfWdldFJvd1ZlY3RvcihlKXtyZXR1cm4gVC5yb3dWZWN0b3IodGhpcy5nZXRSb3coZSkpfXNldFJvdyhlLHMpe1codGhpcyxlKSxzPUEodGhpcyxzKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHNbdF0pO3JldHVybiB0aGlzfXN3YXBSb3dzKGUscyl7Vyh0aGlzLGUpLFcodGhpcyxzKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0Kyspe2xldCByPXRoaXMuZ2V0KGUsdCk7dGhpcy5zZXQoZSx0LHRoaXMuZ2V0KHMsdCkpLHRoaXMuc2V0KHMsdCxyKX1yZXR1cm4gdGhpc31nZXRDb2x1bW4oZSl7Sih0aGlzLGUpO2xldCBzPVtdO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylzLnB1c2godGhpcy5nZXQodCxlKSk7cmV0dXJuIHN9Z2V0Q29sdW1uVmVjdG9yKGUpe3JldHVybiBULmNvbHVtblZlY3Rvcih0aGlzLmdldENvbHVtbihlKSl9c2V0Q29sdW1uKGUscyl7Sih0aGlzLGUpLHM9SCh0aGlzLHMpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLnNldCh0LGUsc1t0XSk7cmV0dXJuIHRoaXN9c3dhcENvbHVtbnMoZSxzKXtKKHRoaXMsZSksSih0aGlzLHMpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl7bGV0IHI9dGhpcy5nZXQodCxlKTt0aGlzLnNldCh0LGUsdGhpcy5nZXQodCxzKSksdGhpcy5zZXQodCxzLHIpfXJldHVybiB0aGlzfWFkZFJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpK2VbdF0pO3JldHVybiB0aGlzfXN1YlJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpLWVbdF0pO3JldHVybiB0aGlzfW11bFJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpKmVbdF0pO3JldHVybiB0aGlzfWRpdlJvd1ZlY3RvcihlKXtlPUEodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpL2VbdF0pO3JldHVybiB0aGlzfWFkZENvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpK2Vbc10pO3JldHVybiB0aGlzfXN1YkNvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpLWVbc10pO3JldHVybiB0aGlzfW11bENvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpKmVbc10pO3JldHVybiB0aGlzfWRpdkNvbHVtblZlY3RvcihlKXtlPUgodGhpcyxlKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuc2V0KHMsdCx0aGlzLmdldChzLHQpL2Vbc10pO3JldHVybiB0aGlzfW11bFJvdyhlLHMpe1codGhpcyxlKTtmb3IobGV0IHQ9MDt0PHRoaXMuY29sdW1uczt0KyspdGhpcy5zZXQoZSx0LHRoaXMuZ2V0KGUsdCkqcyk7cmV0dXJuIHRoaXN9bXVsQ29sdW1uKGUscyl7Sih0aGlzLGUpO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKyl0aGlzLnNldCh0LGUsdGhpcy5nZXQodCxlKSpzKTtyZXR1cm4gdGhpc31tYXgoKXtpZih0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBlPXRoaXMuZ2V0KDAsMCk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyl0aGlzLmdldChzLHQpPmUmJihlPXRoaXMuZ2V0KHMsdCkpO3JldHVybiBlfW1heEluZGV4KCl7dHQodGhpcyk7bGV0IGU9dGhpcy5nZXQoMCwwKSxzPVswLDBdO2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5nZXQodCxyKT5lJiYoZT10aGlzLmdldCh0LHIpLHNbMF09dCxzWzFdPXIpO3JldHVybiBzfW1pbigpe2lmKHRoaXMuaXNFbXB0eSgpKXJldHVybiBOYU47bGV0IGU9dGhpcy5nZXQoMCwwKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KHMsdCk8ZSYmKGU9dGhpcy5nZXQocyx0KSk7cmV0dXJuIGV9bWluSW5kZXgoKXt0dCh0aGlzKTtsZXQgZT10aGlzLmdldCgwLDApLHM9WzAsMF07Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKWZvcihsZXQgcj0wO3I8dGhpcy5jb2x1bW5zO3IrKyl0aGlzLmdldCh0LHIpPGUmJihlPXRoaXMuZ2V0KHQsciksc1swXT10LHNbMV09cik7cmV0dXJuIHN9bWF4Um93KGUpe2lmKFcodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KGUsMCk7Zm9yKGxldCB0PTE7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KGUsdCk+cyYmKHM9dGhpcy5nZXQoZSx0KSk7cmV0dXJuIHN9bWF4Um93SW5kZXgoZSl7Vyh0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KGUsMCksdD1bZSwwXTtmb3IobGV0IHI9MTtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5nZXQoZSxyKT5zJiYocz10aGlzLmdldChlLHIpLHRbMV09cik7cmV0dXJuIHR9bWluUm93KGUpe2lmKFcodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KGUsMCk7Zm9yKGxldCB0PTE7dDx0aGlzLmNvbHVtbnM7dCsrKXRoaXMuZ2V0KGUsdCk8cyYmKHM9dGhpcy5nZXQoZSx0KSk7cmV0dXJuIHN9bWluUm93SW5kZXgoZSl7Vyh0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KGUsMCksdD1bZSwwXTtmb3IobGV0IHI9MTtyPHRoaXMuY29sdW1ucztyKyspdGhpcy5nZXQoZSxyKTxzJiYocz10aGlzLmdldChlLHIpLHRbMV09cik7cmV0dXJuIHR9bWF4Q29sdW1uKGUpe2lmKEoodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KDAsZSk7Zm9yKGxldCB0PTE7dDx0aGlzLnJvd3M7dCsrKXRoaXMuZ2V0KHQsZSk+cyYmKHM9dGhpcy5nZXQodCxlKSk7cmV0dXJuIHN9bWF4Q29sdW1uSW5kZXgoZSl7Sih0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KDAsZSksdD1bMCxlXTtmb3IobGV0IHI9MTtyPHRoaXMucm93cztyKyspdGhpcy5nZXQocixlKT5zJiYocz10aGlzLmdldChyLGUpLHRbMF09cik7cmV0dXJuIHR9bWluQ29sdW1uKGUpe2lmKEoodGhpcyxlKSx0aGlzLmlzRW1wdHkoKSlyZXR1cm4gTmFOO2xldCBzPXRoaXMuZ2V0KDAsZSk7Zm9yKGxldCB0PTE7dDx0aGlzLnJvd3M7dCsrKXRoaXMuZ2V0KHQsZSk8cyYmKHM9dGhpcy5nZXQodCxlKSk7cmV0dXJuIHN9bWluQ29sdW1uSW5kZXgoZSl7Sih0aGlzLGUpLHR0KHRoaXMpO2xldCBzPXRoaXMuZ2V0KDAsZSksdD1bMCxlXTtmb3IobGV0IHI9MTtyPHRoaXMucm93cztyKyspdGhpcy5nZXQocixlKTxzJiYocz10aGlzLmdldChyLGUpLHRbMF09cik7cmV0dXJuIHR9ZGlhZygpe2xldCBlPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLHM9W107Zm9yKGxldCB0PTA7dDxlO3QrKylzLnB1c2godGhpcy5nZXQodCx0KSk7cmV0dXJuIHN9bm9ybShlPSJmcm9iZW5pdXMiKXtsZXQgcz0wO2lmKGU9PT0ibWF4IilyZXR1cm4gdGhpcy5tYXgoKTtpZihlPT09ImZyb2Jlbml1cyIpe2ZvcihsZXQgdD0wO3Q8dGhpcy5yb3dzO3QrKylmb3IobGV0IHI9MDtyPHRoaXMuY29sdW1ucztyKyspcz1zK3RoaXMuZ2V0KHQscikqdGhpcy5nZXQodCxyKTtyZXR1cm4gTWF0aC5zcXJ0KHMpfWVsc2UgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYHVua25vd24gbm9ybSB0eXBlOiAke2V9YCl9Y3VtdWxhdGl2ZVN1bSgpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllKz10aGlzLmdldChzLHQpLHRoaXMuc2V0KHMsdCxlKTtyZXR1cm4gdGhpc31kb3QoZSl7cS5pc01hdHJpeChlKSYmKGU9ZS50bzFEQXJyYXkoKSk7bGV0IHM9dGhpcy50bzFEQXJyYXkoKTtpZihzLmxlbmd0aCE9PWUubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJ2ZWN0b3JzIGRvIG5vdCBoYXZlIHRoZSBzYW1lIHNpemUiKTtsZXQgdD0wO2ZvcihsZXQgcj0wO3I8cy5sZW5ndGg7cisrKXQrPXNbcl0qZVtyXTtyZXR1cm4gdH1tbXVsKGUpe2U9VC5jaGVja01hdHJpeChlKTtsZXQgcz10aGlzLnJvd3MsdD10aGlzLmNvbHVtbnMscj1lLmNvbHVtbnMsbz1uZXcgVChzLHIpLGk9bmV3IEZsb2F0NjRBcnJheSh0KTtmb3IobGV0IGg9MDtoPHI7aCsrKXtmb3IobGV0IGE9MDthPHQ7YSsrKWlbYV09ZS5nZXQoYSxoKTtmb3IobGV0IGE9MDthPHM7YSsrKXtsZXQgbD0wO2ZvcihsZXQgZz0wO2c8dDtnKyspbCs9dGhpcy5nZXQoYSxnKSppW2ddO28uc2V0KGEsaCxsKX19cmV0dXJuIG99c3RyYXNzZW4yeDIoZSl7ZT1ULmNoZWNrTWF0cml4KGUpO2xldCBzPW5ldyBUKDIsMik7Y29uc3QgdD10aGlzLmdldCgwLDApLHI9ZS5nZXQoMCwwKSxvPXRoaXMuZ2V0KDAsMSksaT1lLmdldCgwLDEpLGg9dGhpcy5nZXQoMSwwKSxhPWUuZ2V0KDEsMCksbD10aGlzLmdldCgxLDEpLGc9ZS5nZXQoMSwxKSx1PSh0K2wpKihyK2cpLHA9KGgrbCkqcixkPXQqKGktZyksdz1sKihhLXIpLG09KHQrbykqZyx2PShoLXQpKihyK2kpLGY9KG8tbCkqKGErZyksTT11K3ctbStmLGI9ZCttLGs9cCt3LEU9dS1wK2QrdjtyZXR1cm4gcy5zZXQoMCwwLE0pLHMuc2V0KDAsMSxiKSxzLnNldCgxLDAsaykscy5zZXQoMSwxLEUpLHN9c3RyYXNzZW4zeDMoZSl7ZT1ULmNoZWNrTWF0cml4KGUpO2xldCBzPW5ldyBUKDMsMyk7Y29uc3QgdD10aGlzLmdldCgwLDApLHI9dGhpcy5nZXQoMCwxKSxvPXRoaXMuZ2V0KDAsMiksaT10aGlzLmdldCgxLDApLGg9dGhpcy5nZXQoMSwxKSxhPXRoaXMuZ2V0KDEsMiksbD10aGlzLmdldCgyLDApLGc9dGhpcy5nZXQoMiwxKSx1PXRoaXMuZ2V0KDIsMikscD1lLmdldCgwLDApLGQ9ZS5nZXQoMCwxKSx3PWUuZ2V0KDAsMiksbT1lLmdldCgxLDApLHY9ZS5nZXQoMSwxKSxmPWUuZ2V0KDEsMiksTT1lLmdldCgyLDApLGI9ZS5nZXQoMiwxKSxrPWUuZ2V0KDIsMiksRT0odCtyK28taS1oLWctdSkqdixGPSh0LWkpKigtZCt2KSxSPWgqKC1wK2QrbS12LWYtTStrKSxOPSgtdCtpK2gpKihwLWQrdiksST0oaStoKSooLXArZCksYz10KnAseT0oLXQrbCtnKSoocC13K2YpLGo9KC10K2wpKih3LWYpLFM9KGwrZykqKC1wK3cpLFA9KHQrcitvLWgtYS1sLWcpKmYsQz1nKigtcCt3K20tdi1mLU0rYiksTD0oLW8rZyt1KSooditNLWIpLHo9KG8tdSkqKHYtYiksRD1vKk0sQj0oZyt1KSooLU0rYiksTz0oLW8raCthKSooZitNLWspLFk9KG8tYSkqKGYtayksXz0oaCthKSooLU0rayksJD1yKm0sVT1hKmIsWD1pKncsWj1sKmQsVj11KmssSmU9YytEKyQsUWU9RStOK0krYytMK0QrQixLZT1jK3krUytQK0QrTytfLHhlPUYrUitOK2MrRCtPK1ksQWU9RitOK0krYytVLEhlPUQrTytZK18rWCx0cz1jK3kraitDK0wreitELGVzPUwreitEK0IrWixzcz1jK3kraitTK1Y7cmV0dXJuIHMuc2V0KDAsMCxKZSkscy5zZXQoMCwxLFFlKSxzLnNldCgwLDIsS2UpLHMuc2V0KDEsMCx4ZSkscy5zZXQoMSwxLEFlKSxzLnNldCgxLDIsSGUpLHMuc2V0KDIsMCx0cykscy5zZXQoMiwxLGVzKSxzLnNldCgyLDIsc3MpLHN9bW11bFN0cmFzc2VuKGUpe2U9VC5jaGVja01hdHJpeChlKTtsZXQgcz10aGlzLmNsb25lKCksdD1zLnJvd3Mscj1zLmNvbHVtbnMsbz1lLnJvd3MsaT1lLmNvbHVtbnM7ciE9PW8mJmNvbnNvbGUud2FybihgTXVsdGlwbHlpbmcgJHt0fSB4ICR7cn0gYW5kICR7b30geCAke2l9IG1hdHJpeDogZGltZW5zaW9ucyBkbyBub3QgbWF0Y2guYCk7ZnVuY3Rpb24gaCh1LHAsZCl7bGV0IHc9dS5yb3dzLG09dS5jb2x1bW5zO2lmKHc9PT1wJiZtPT09ZClyZXR1cm4gdTt7bGV0IHY9cS56ZXJvcyhwLGQpO3JldHVybiB2PXYuc2V0U3ViTWF0cml4KHUsMCwwKSx2fX1sZXQgYT1NYXRoLm1heCh0LG8pLGw9TWF0aC5tYXgocixpKTtzPWgocyxhLGwpLGU9aChlLGEsbCk7ZnVuY3Rpb24gZyh1LHAsZCx3KXtpZihkPD01MTJ8fHc8PTUxMilyZXR1cm4gdS5tbXVsKHApO2QlMj09MSYmdyUyPT0xPyh1PWgodSxkKzEsdysxKSxwPWgocCxkKzEsdysxKSk6ZCUyPT0xPyh1PWgodSxkKzEsdykscD1oKHAsZCsxLHcpKTp3JTI9PTEmJih1PWgodSxkLHcrMSkscD1oKHAsZCx3KzEpKTtsZXQgbT1wYXJzZUludCh1LnJvd3MvMiwxMCksdj1wYXJzZUludCh1LmNvbHVtbnMvMiwxMCksZj11LnN1Yk1hdHJpeCgwLG0tMSwwLHYtMSksTT1wLnN1Yk1hdHJpeCgwLG0tMSwwLHYtMSksYj11LnN1Yk1hdHJpeCgwLG0tMSx2LHUuY29sdW1ucy0xKSxrPXAuc3ViTWF0cml4KDAsbS0xLHYscC5jb2x1bW5zLTEpLEU9dS5zdWJNYXRyaXgobSx1LnJvd3MtMSwwLHYtMSksRj1wLnN1Yk1hdHJpeChtLHAucm93cy0xLDAsdi0xKSxSPXUuc3ViTWF0cml4KG0sdS5yb3dzLTEsdix1LmNvbHVtbnMtMSksTj1wLnN1Yk1hdHJpeChtLHAucm93cy0xLHYscC5jb2x1bW5zLTEpLEk9ZyhxLmFkZChmLFIpLHEuYWRkKE0sTiksbSx2KSxjPWcocS5hZGQoRSxSKSxNLG0sdikseT1nKGYscS5zdWIoayxOKSxtLHYpLGo9ZyhSLHEuc3ViKEYsTSksbSx2KSxTPWcocS5hZGQoZixiKSxOLG0sdiksUD1nKHEuc3ViKEUsZikscS5hZGQoTSxrKSxtLHYpLEM9ZyhxLnN1YihiLFIpLHEuYWRkKEYsTiksbSx2KSxMPXEuYWRkKEksaik7TC5zdWIoUyksTC5hZGQoQyk7bGV0IHo9cS5hZGQoeSxTKSxEPXEuYWRkKGMsaiksQj1xLnN1YihJLGMpO0IuYWRkKHkpLEIuYWRkKFApO2xldCBPPXEuemVyb3MoMipMLnJvd3MsMipMLmNvbHVtbnMpO3JldHVybiBPPU8uc2V0U3ViTWF0cml4KEwsMCwwKSxPPU8uc2V0U3ViTWF0cml4KHosTC5yb3dzLDApLE89Ty5zZXRTdWJNYXRyaXgoRCwwLEwuY29sdW1ucyksTz1PLnNldFN1Yk1hdHJpeChCLEwucm93cyxMLmNvbHVtbnMpLE8uc3ViTWF0cml4KDAsZC0xLDAsdy0xKX1yZXR1cm4gZyhzLGUsYSxsKX1zY2FsZVJvd3MoZT17fSl7aWYodHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46cz0wLG1heDp0PTF9PWU7aWYoIU51bWJlci5pc0Zpbml0ZShzKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihzPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IHI9bmV3IFQodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBvPTA7bzx0aGlzLnJvd3M7bysrKXtjb25zdCBpPXRoaXMuZ2V0Um93KG8pO2kubGVuZ3RoPjAmJmR0KGkse21pbjpzLG1heDp0LG91dHB1dDppfSksci5zZXRSb3cobyxpKX1yZXR1cm4gcn1zY2FsZUNvbHVtbnMoZT17fSl7aWYodHlwZW9mIGUhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHttaW46cz0wLG1heDp0PTF9PWU7aWYoIU51bWJlci5pc0Zpbml0ZShzKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJtaW4gbXVzdCBiZSBhIG51bWJlciIpO2lmKCFOdW1iZXIuaXNGaW5pdGUodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigibWF4IG11c3QgYmUgYSBudW1iZXIiKTtpZihzPj10KXRocm93IG5ldyBSYW5nZUVycm9yKCJtaW4gbXVzdCBiZSBzbWFsbGVyIHRoYW4gbWF4Iik7bGV0IHI9bmV3IFQodGhpcy5yb3dzLHRoaXMuY29sdW1ucyk7Zm9yKGxldCBvPTA7bzx0aGlzLmNvbHVtbnM7bysrKXtjb25zdCBpPXRoaXMuZ2V0Q29sdW1uKG8pO2kubGVuZ3RoJiZkdChpLHttaW46cyxtYXg6dCxvdXRwdXQ6aX0pLHIuc2V0Q29sdW1uKG8saSl9cmV0dXJuIHJ9ZmxpcFJvd3MoKXtjb25zdCBlPU1hdGguY2VpbCh0aGlzLmNvbHVtbnMvMik7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8ZTt0Kyspe2xldCByPXRoaXMuZ2V0KHMsdCksbz10aGlzLmdldChzLHRoaXMuY29sdW1ucy0xLXQpO3RoaXMuc2V0KHMsdCxvKSx0aGlzLnNldChzLHRoaXMuY29sdW1ucy0xLXQscil9cmV0dXJuIHRoaXN9ZmxpcENvbHVtbnMoKXtjb25zdCBlPU1hdGguY2VpbCh0aGlzLnJvd3MvMik7Zm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKWZvcihsZXQgdD0wO3Q8ZTt0Kyspe2xldCByPXRoaXMuZ2V0KHQscyksbz10aGlzLmdldCh0aGlzLnJvd3MtMS10LHMpO3RoaXMuc2V0KHQscyxvKSx0aGlzLnNldCh0aGlzLnJvd3MtMS10LHMscil9cmV0dXJuIHRoaXN9a3JvbmVja2VyUHJvZHVjdChlKXtlPVQuY2hlY2tNYXRyaXgoZSk7bGV0IHM9dGhpcy5yb3dzLHQ9dGhpcy5jb2x1bW5zLHI9ZS5yb3dzLG89ZS5jb2x1bW5zLGk9bmV3IFQocypyLHQqbyk7Zm9yKGxldCBoPTA7aDxzO2grKylmb3IobGV0IGE9MDthPHQ7YSsrKWZvcihsZXQgbD0wO2w8cjtsKyspZm9yKGxldCBnPTA7ZzxvO2crKylpLnNldChyKmgrbCxvKmErZyx0aGlzLmdldChoLGEpKmUuZ2V0KGwsZykpO3JldHVybiBpfWtyb25lY2tlclN1bShlKXtpZihlPVQuY2hlY2tNYXRyaXgoZSksIXRoaXMuaXNTcXVhcmUoKXx8IWUuaXNTcXVhcmUoKSl0aHJvdyBuZXcgRXJyb3IoIktyb25lY2tlciBTdW0gbmVlZHMgdHdvIFNxdWFyZSBNYXRyaWNlcyIpO2xldCBzPXRoaXMucm93cyx0PWUucm93cyxyPXRoaXMua3JvbmVja2VyUHJvZHVjdChULmV5ZSh0LHQpKSxvPVQuZXllKHMscykua3JvbmVja2VyUHJvZHVjdChlKTtyZXR1cm4gci5hZGQobyl9dHJhbnNwb3NlKCl7bGV0IGU9bmV3IFQodGhpcy5jb2x1bW5zLHRoaXMucm93cyk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKWZvcihsZXQgdD0wO3Q8dGhpcy5jb2x1bW5zO3QrKyllLnNldCh0LHMsdGhpcy5nZXQocyx0KSk7cmV0dXJuIGV9c29ydFJvd3MoZT1TdCl7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXRoaXMuc2V0Um93KHMsdGhpcy5nZXRSb3cocykuc29ydChlKSk7cmV0dXJuIHRoaXN9c29ydENvbHVtbnMoZT1TdCl7Zm9yKGxldCBzPTA7czx0aGlzLmNvbHVtbnM7cysrKXRoaXMuc2V0Q29sdW1uKHMsdGhpcy5nZXRDb2x1bW4ocykuc29ydChlKSk7cmV0dXJuIHRoaXN9c3ViTWF0cml4KGUscyx0LHIpe010KHRoaXMsZSxzLHQscik7bGV0IG89bmV3IFQocy1lKzEsci10KzEpO2ZvcihsZXQgaT1lO2k8PXM7aSsrKWZvcihsZXQgaD10O2g8PXI7aCsrKW8uc2V0KGktZSxoLXQsdGhpcy5nZXQoaSxoKSk7cmV0dXJuIG99c3ViTWF0cml4Um93KGUscyx0KXtpZihzPT09dm9pZCAwJiYocz0wKSx0PT09dm9pZCAwJiYodD10aGlzLmNvbHVtbnMtMSkscz50fHxzPDB8fHM+PXRoaXMuY29sdW1uc3x8dDwwfHx0Pj10aGlzLmNvbHVtbnMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkFyZ3VtZW50IG91dCBvZiByYW5nZSIpO2xldCByPW5ldyBUKGUubGVuZ3RoLHQtcysxKTtmb3IobGV0IG89MDtvPGUubGVuZ3RoO28rKylmb3IobGV0IGk9cztpPD10O2krKyl7aWYoZVtvXTwwfHxlW29dPj10aGlzLnJvd3MpdGhyb3cgbmV3IFJhbmdlRXJyb3IoYFJvdyBpbmRleCBvdXQgb2YgcmFuZ2U6ICR7ZVtvXX1gKTtyLnNldChvLGktcyx0aGlzLmdldChlW29dLGkpKX1yZXR1cm4gcn1zdWJNYXRyaXhDb2x1bW4oZSxzLHQpe2lmKHM9PT12b2lkIDAmJihzPTApLHQ9PT12b2lkIDAmJih0PXRoaXMucm93cy0xKSxzPnR8fHM8MHx8cz49dGhpcy5yb3dzfHx0PDB8fHQ+PXRoaXMucm93cyl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXJndW1lbnQgb3V0IG9mIHJhbmdlIik7bGV0IHI9bmV3IFQodC1zKzEsZS5sZW5ndGgpO2ZvcihsZXQgbz0wO288ZS5sZW5ndGg7bysrKWZvcihsZXQgaT1zO2k8PXQ7aSsrKXtpZihlW29dPDB8fGVbb10+PXRoaXMuY29sdW1ucyl0aHJvdyBuZXcgUmFuZ2VFcnJvcihgQ29sdW1uIGluZGV4IG91dCBvZiByYW5nZTogJHtlW29dfWApO3Iuc2V0KGktcyxvLHRoaXMuZ2V0KGksZVtvXSkpfXJldHVybiByfXNldFN1Yk1hdHJpeChlLHMsdCl7aWYoZT1ULmNoZWNrTWF0cml4KGUpLGUuaXNFbXB0eSgpKXJldHVybiB0aGlzO2xldCByPXMrZS5yb3dzLTEsbz10K2UuY29sdW1ucy0xO010KHRoaXMscyxyLHQsbyk7Zm9yKGxldCBpPTA7aTxlLnJvd3M7aSsrKWZvcihsZXQgaD0wO2g8ZS5jb2x1bW5zO2grKyl0aGlzLnNldChzK2ksdCtoLGUuZ2V0KGksaCkpO3JldHVybiB0aGlzfXNlbGVjdGlvbihlLHMpe2xldCB0PU90KHRoaXMsZSxzKSxyPW5ldyBUKGUubGVuZ3RoLHMubGVuZ3RoKTtmb3IobGV0IG89MDtvPHQucm93Lmxlbmd0aDtvKyspe2xldCBpPXQucm93W29dO2ZvcihsZXQgaD0wO2g8dC5jb2x1bW4ubGVuZ3RoO2grKyl7bGV0IGE9dC5jb2x1bW5baF07ci5zZXQobyxoLHRoaXMuZ2V0KGksYSkpfX1yZXR1cm4gcn10cmFjZSgpe2xldCBlPU1hdGgubWluKHRoaXMucm93cyx0aGlzLmNvbHVtbnMpLHM9MDtmb3IobGV0IHQ9MDt0PGU7dCsrKXMrPXRoaXMuZ2V0KHQsdCk7cmV0dXJuIHN9Y2xvbmUoKXtsZXQgZT1uZXcgVCh0aGlzLnJvd3MsdGhpcy5jb2x1bW5zKTtmb3IobGV0IHM9MDtzPHRoaXMucm93cztzKyspZm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKWUuc2V0KHMsdCx0aGlzLmdldChzLHQpKTtyZXR1cm4gZX1zdW0oZSl7c3dpdGNoKGUpe2Nhc2Uicm93IjpyZXR1cm4gVnQodGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBCdCh0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gWXQodGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke2V9YCl9fXByb2R1Y3QoZSl7c3dpdGNoKGUpe2Nhc2Uicm93IjpyZXR1cm4gX3QodGhpcyk7Y2FzZSJjb2x1bW4iOnJldHVybiBYdCh0aGlzKTtjYXNlIHZvaWQgMDpyZXR1cm4gWnQodGhpcyk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke2V9YCl9fW1lYW4oZSl7Y29uc3Qgcz10aGlzLnN1bShlKTtzd2l0Y2goZSl7Y2FzZSJyb3ciOntmb3IobGV0IHQ9MDt0PHRoaXMucm93czt0Kyspc1t0XS89dGhpcy5jb2x1bW5zO3JldHVybiBzfWNhc2UiY29sdW1uIjp7Zm9yKGxldCB0PTA7dDx0aGlzLmNvbHVtbnM7dCsrKXNbdF0vPXRoaXMucm93cztyZXR1cm4gc31jYXNlIHZvaWQgMDpyZXR1cm4gcy90aGlzLnNpemU7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYGludmFsaWQgb3B0aW9uOiAke2V9YCl9fXZhcmlhbmNlKGUscz17fSl7aWYodHlwZW9mIGU9PSJvYmplY3QiJiYocz1lLGU9dm9pZCAwKSx0eXBlb2YgcyE9Im9iamVjdCIpdGhyb3cgbmV3IFR5cGVFcnJvcigib3B0aW9ucyBtdXN0IGJlIGFuIG9iamVjdCIpO2NvbnN0e3VuYmlhc2VkOnQ9ITAsbWVhbjpyPXRoaXMubWVhbihlKX09cztpZih0eXBlb2YgdCE9ImJvb2xlYW4iKXRocm93IG5ldyBUeXBlRXJyb3IoInVuYmlhc2VkIG11c3QgYmUgYSBib29sZWFuIik7c3dpdGNoKGUpe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkocikpdGhyb3cgbmV3IFR5cGVFcnJvcigibWVhbiBtdXN0IGJlIGFuIGFycmF5Iik7cmV0dXJuIEd0KHRoaXMsdCxyKX1jYXNlImNvbHVtbiI6e2lmKCFBcnJheS5pc0FycmF5KHIpKXRocm93IG5ldyBUeXBlRXJyb3IoIm1lYW4gbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBXdCh0aGlzLHQscil9Y2FzZSB2b2lkIDA6e2lmKHR5cGVvZiByIT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJtZWFuIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4gSnQodGhpcyx0LHIpfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtlfWApfX1zdGFuZGFyZERldmlhdGlvbihlLHMpe3R5cGVvZiBlPT0ib2JqZWN0IiYmKHM9ZSxlPXZvaWQgMCk7Y29uc3QgdD10aGlzLnZhcmlhbmNlKGUscyk7aWYoZT09PXZvaWQgMClyZXR1cm4gTWF0aC5zcXJ0KHQpO2ZvcihsZXQgcj0wO3I8dC5sZW5ndGg7cisrKXRbcl09TWF0aC5zcXJ0KHRbcl0pO3JldHVybiB0fWNlbnRlcihlLHM9e30pe2lmKHR5cGVvZiBlPT0ib2JqZWN0IiYmKHM9ZSxlPXZvaWQgMCksdHlwZW9mIHMhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtjb25zdHtjZW50ZXI6dD10aGlzLm1lYW4oZSl9PXM7c3dpdGNoKGUpe2Nhc2Uicm93Ijp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gUXQodGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gS3QodGhpcyx0KSx0aGlzfWNhc2Ugdm9pZCAwOntpZih0eXBlb2YgdCE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiY2VudGVyIG11c3QgYmUgYSBudW1iZXIiKTtyZXR1cm4geHQodGhpcyx0KSx0aGlzfWRlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKGBpbnZhbGlkIG9wdGlvbjogJHtlfWApfX1zY2FsZShlLHM9e30pe2lmKHR5cGVvZiBlPT0ib2JqZWN0IiYmKHM9ZSxlPXZvaWQgMCksdHlwZW9mIHMhPSJvYmplY3QiKXRocm93IG5ldyBUeXBlRXJyb3IoIm9wdGlvbnMgbXVzdCBiZSBhbiBvYmplY3QiKTtsZXQgdD1zLnNjYWxlO3N3aXRjaChlKXtjYXNlInJvdyI6e2lmKHQ9PT12b2lkIDApdD1BdCh0aGlzKTtlbHNlIGlmKCFBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoInNjYWxlIG11c3QgYmUgYW4gYXJyYXkiKTtyZXR1cm4gSHQodGhpcyx0KSx0aGlzfWNhc2UiY29sdW1uIjp7aWYodD09PXZvaWQgMCl0PXRlKHRoaXMpO2Vsc2UgaWYoIUFycmF5LmlzQXJyYXkodCkpdGhyb3cgbmV3IFR5cGVFcnJvcigic2NhbGUgbXVzdCBiZSBhbiBhcnJheSIpO3JldHVybiBlZSh0aGlzLHQpLHRoaXN9Y2FzZSB2b2lkIDA6e2lmKHQ9PT12b2lkIDApdD1zZSh0aGlzKTtlbHNlIGlmKHR5cGVvZiB0IT0ibnVtYmVyIil0aHJvdyBuZXcgVHlwZUVycm9yKCJzY2FsZSBtdXN0IGJlIGEgbnVtYmVyIik7cmV0dXJuIHJlKHRoaXMsdCksdGhpc31kZWZhdWx0OnRocm93IG5ldyBFcnJvcihgaW52YWxpZCBvcHRpb246ICR7ZX1gKX19dG9TdHJpbmcoZSl7cmV0dXJuIHZ0KHRoaXMsZSl9fXEucHJvdG90eXBlLmtsYXNzPSJNYXRyaXgiLHR5cGVvZiBTeW1ib2whPSJ1bmRlZmluZWQiJiYocS5wcm90b3R5cGVbU3ltYm9sLmZvcigibm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20iKV09Q3QpO2Z1bmN0aW9uIFN0KG4sZSl7cmV0dXJuIG4tZX1xLnJhbmRvbT1xLnJhbmQscS5yYW5kb21JbnQ9cS5yYW5kSW50LHEuZGlhZ29uYWw9cS5kaWFnLHEucHJvdG90eXBlLmRpYWdvbmFsPXEucHJvdG90eXBlLmRpYWcscS5pZGVudGl0eT1xLmV5ZSxxLnByb3RvdHlwZS5uZWdhdGU9cS5wcm90b3R5cGUubmVnLHEucHJvdG90eXBlLnRlbnNvclByb2R1Y3Q9cS5wcm90b3R5cGUua3JvbmVja2VyUHJvZHVjdDtjbGFzcyBUIGV4dGVuZHMgcXtjb25zdHJ1Y3RvcihlLHMpe3N1cGVyKCk7aWYoVC5pc01hdHJpeChlKSlyZXR1cm4gZS5jbG9uZSgpO2lmKE51bWJlci5pc0ludGVnZXIoZSkmJmU+PTApaWYodGhpcy5kYXRhPVtdLE51bWJlci5pc0ludGVnZXIocykmJnM+PTApZm9yKGxldCB0PTA7dDxlO3QrKyl0aGlzLmRhdGEucHVzaChuZXcgRmxvYXQ2NEFycmF5KHMpKTtlbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIm5Db2x1bW5zIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyIik7ZWxzZSBpZihBcnJheS5pc0FycmF5KGUpKXtjb25zdCB0PWU7aWYoZT10Lmxlbmd0aCxzPWU/dFswXS5sZW5ndGg6MCx0eXBlb2YgcyE9Im51bWJlciIpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGF0YSBtdXN0IGJlIGEgMkQgYXJyYXkgd2l0aCBhdCBsZWFzdCBvbmUgZWxlbWVudCIpO3RoaXMuZGF0YT1bXTtmb3IobGV0IHI9MDtyPGU7cisrKXtpZih0W3JdLmxlbmd0aCE9PXMpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluY29uc2lzdGVudCBhcnJheSBkaW1lbnNpb25zIik7dGhpcy5kYXRhLnB1c2goRmxvYXQ2NEFycmF5LmZyb20odFtyXSkpfX1lbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXIgb3IgYW4gYXJyYXkiKTt0aGlzLnJvd3M9ZSx0aGlzLmNvbHVtbnM9c31zZXQoZSxzLHQpe3JldHVybiB0aGlzLmRhdGFbZV1bc109dCx0aGlzfWdldChlLHMpe3JldHVybiB0aGlzLmRhdGFbZV1bc119cmVtb3ZlUm93KGUpe3JldHVybiBXKHRoaXMsZSksdGhpcy5kYXRhLnNwbGljZShlLDEpLHRoaXMucm93cy09MSx0aGlzfWFkZFJvdyhlLHMpe3JldHVybiBzPT09dm9pZCAwJiYocz1lLGU9dGhpcy5yb3dzKSxXKHRoaXMsZSwhMCkscz1GbG9hdDY0QXJyYXkuZnJvbShBKHRoaXMscykpLHRoaXMuZGF0YS5zcGxpY2UoZSwwLHMpLHRoaXMucm93cys9MSx0aGlzfXJlbW92ZUNvbHVtbihlKXtKKHRoaXMsZSk7Zm9yKGxldCBzPTA7czx0aGlzLnJvd3M7cysrKXtjb25zdCB0PW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zLTEpO2ZvcihsZXQgcj0wO3I8ZTtyKyspdFtyXT10aGlzLmRhdGFbc11bcl07Zm9yKGxldCByPWUrMTtyPHRoaXMuY29sdW1ucztyKyspdFtyLTFdPXRoaXMuZGF0YVtzXVtyXTt0aGlzLmRhdGFbc109dH1yZXR1cm4gdGhpcy5jb2x1bW5zLT0xLHRoaXN9YWRkQ29sdW1uKGUscyl7dHlwZW9mIHM9PSJ1bmRlZmluZWQiJiYocz1lLGU9dGhpcy5jb2x1bW5zKSxKKHRoaXMsZSwhMCkscz1IKHRoaXMscyk7Zm9yKGxldCB0PTA7dDx0aGlzLnJvd3M7dCsrKXtjb25zdCByPW5ldyBGbG9hdDY0QXJyYXkodGhpcy5jb2x1bW5zKzEpO2xldCBvPTA7Zm9yKDtvPGU7bysrKXJbb109dGhpcy5kYXRhW3RdW29dO2ZvcihyW28rK109c1t0XTtvPHRoaXMuY29sdW1ucysxO28rKylyW29dPXRoaXMuZGF0YVt0XVtvLTFdO3RoaXMuZGF0YVt0XT1yfXJldHVybiB0aGlzLmNvbHVtbnMrPTEsdGhpc319enQocSxUKTtjbGFzcyBvZSBleHRlbmRzIHF7Y29uc3RydWN0b3IoZSxzLHQpe3N1cGVyKCk7dGhpcy5tYXRyaXg9ZSx0aGlzLnJvd3M9cyx0aGlzLmNvbHVtbnM9dH19Y2xhc3MgbmUgZXh0ZW5kcyBvZXtjb25zdHJ1Y3RvcihlKXtzdXBlcihlLGUuY29sdW1ucyxlLnJvd3MpfXNldChlLHMsdCl7cmV0dXJuIHRoaXMubWF0cml4LnNldChzLGUsdCksdGhpc31nZXQoZSxzKXtyZXR1cm4gdGhpcy5tYXRyaXguZ2V0KHMsZSl9fWNsYXNzIGx0IGV4dGVuZHMgcXtjb25zdHJ1Y3RvcihlKXtzdXBlcigpO3RoaXMuZGF0YT1lLHRoaXMucm93cz1lLmxlbmd0aCx0aGlzLmNvbHVtbnM9ZVswXS5sZW5ndGh9c2V0KGUscyx0KXtyZXR1cm4gdGhpcy5kYXRhW2VdW3NdPXQsdGhpc31nZXQoZSxzKXtyZXR1cm4gdGhpcy5kYXRhW2VdW3NdfX1mdW5jdGlvbiBLKG4sZSl7bGV0IHM9MDtyZXR1cm4gTWF0aC5hYnMobik+TWF0aC5hYnMoZSk/KHM9ZS9uLE1hdGguYWJzKG4pKk1hdGguc3FydCgxK3MqcykpOmUhPT0wPyhzPW4vZSxNYXRoLmFicyhlKSpNYXRoLnNxcnQoMStzKnMpKTowfWNsYXNzIGlle2NvbnN0cnVjdG9yKGUscz17fSl7aWYoZT1sdC5jaGVja01hdHJpeChlKSxlLmlzRW1wdHkoKSl0aHJvdyBuZXcgRXJyb3IoIk1hdHJpeCBtdXN0IGJlIG5vbi1lbXB0eSIpO2xldCB0PWUucm93cyxyPWUuY29sdW1ucztjb25zdHtjb21wdXRlTGVmdFNpbmd1bGFyVmVjdG9yczpvPSEwLGNvbXB1dGVSaWdodFNpbmd1bGFyVmVjdG9yczppPSEwLGF1dG9UcmFuc3Bvc2U6aD0hMX09cztsZXQgYT1Cb29sZWFuKG8pLGw9Qm9vbGVhbihpKSxnPSExLHU7aWYodDxyKWlmKCFoKXU9ZS5jbG9uZSgpLGNvbnNvbGUud2FybigiQ29tcHV0aW5nIFNWRCBvbiBhIG1hdHJpeCB3aXRoIG1vcmUgY29sdW1ucyB0aGFuIHJvd3MuIENvbnNpZGVyIGVuYWJsaW5nIGF1dG9UcmFuc3Bvc2UiKTtlbHNle3U9ZS50cmFuc3Bvc2UoKSx0PXUucm93cyxyPXUuY29sdW1ucyxnPSEwO2xldCBjPWE7YT1sLGw9Y31lbHNlIHU9ZS5jbG9uZSgpO2xldCBwPU1hdGgubWluKHQsciksZD1NYXRoLm1pbih0KzEsciksdz1uZXcgRmxvYXQ2NEFycmF5KGQpLG09bmV3IFQodCxwKSx2PW5ldyBUKHIsciksZj1uZXcgRmxvYXQ2NEFycmF5KHIpLE09bmV3IEZsb2F0NjRBcnJheSh0KSxiPW5ldyBGbG9hdDY0QXJyYXkoZCk7Zm9yKGxldCBjPTA7YzxkO2MrKyliW2NdPWM7bGV0IGs9TWF0aC5taW4odC0xLHIpLEU9TWF0aC5tYXgoMCxNYXRoLm1pbihyLTIsdCkpLEY9TWF0aC5tYXgoayxFKTtmb3IobGV0IGM9MDtjPEY7YysrKXtpZihjPGspe3dbY109MDtmb3IobGV0IHk9Yzt5PHQ7eSsrKXdbY109Syh3W2NdLHUuZ2V0KHksYykpO2lmKHdbY10hPT0wKXt1LmdldChjLGMpPDAmJih3W2NdPS13W2NdKTtmb3IobGV0IHk9Yzt5PHQ7eSsrKXUuc2V0KHksYyx1LmdldCh5LGMpL3dbY10pO3Uuc2V0KGMsYyx1LmdldChjLGMpKzEpfXdbY109LXdbY119Zm9yKGxldCB5PWMrMTt5PHI7eSsrKXtpZihjPGsmJndbY10hPT0wKXtsZXQgaj0wO2ZvcihsZXQgUz1jO1M8dDtTKyspais9dS5nZXQoUyxjKSp1LmdldChTLHkpO2o9LWovdS5nZXQoYyxjKTtmb3IobGV0IFM9YztTPHQ7UysrKXUuc2V0KFMseSx1LmdldChTLHkpK2oqdS5nZXQoUyxjKSl9Zlt5XT11LmdldChjLHkpfWlmKGEmJmM8aylmb3IobGV0IHk9Yzt5PHQ7eSsrKW0uc2V0KHksYyx1LmdldCh5LGMpKTtpZihjPEUpe2ZbY109MDtmb3IobGV0IHk9YysxO3k8cjt5KyspZltjXT1LKGZbY10sZlt5XSk7aWYoZltjXSE9PTApe2ZbYysxXTwwJiYoZltjXT0wLWZbY10pO2ZvcihsZXQgeT1jKzE7eTxyO3krKylmW3ldLz1mW2NdO2ZbYysxXSs9MX1pZihmW2NdPS1mW2NdLGMrMTx0JiZmW2NdIT09MCl7Zm9yKGxldCB5PWMrMTt5PHQ7eSsrKU1beV09MDtmb3IobGV0IHk9YysxO3k8dDt5KyspZm9yKGxldCBqPWMrMTtqPHI7aisrKU1beV0rPWZbal0qdS5nZXQoeSxqKTtmb3IobGV0IHk9YysxO3k8cjt5Kyspe2xldCBqPS1mW3ldL2ZbYysxXTtmb3IobGV0IFM9YysxO1M8dDtTKyspdS5zZXQoUyx5LHUuZ2V0KFMseSkraipNW1NdKX19aWYobClmb3IobGV0IHk9YysxO3k8cjt5Kyspdi5zZXQoeSxjLGZbeV0pfX1sZXQgUj1NYXRoLm1pbihyLHQrMSk7aWYoazxyJiYod1trXT11LmdldChrLGspKSx0PFImJih3W1ItMV09MCksRSsxPFImJihmW0VdPXUuZ2V0KEUsUi0xKSksZltSLTFdPTAsYSl7Zm9yKGxldCBjPWs7YzxwO2MrKyl7Zm9yKGxldCB5PTA7eTx0O3krKyltLnNldCh5LGMsMCk7bS5zZXQoYyxjLDEpfWZvcihsZXQgYz1rLTE7Yz49MDtjLS0paWYod1tjXSE9PTApe2ZvcihsZXQgeT1jKzE7eTxwO3krKyl7bGV0IGo9MDtmb3IobGV0IFM9YztTPHQ7UysrKWorPW0uZ2V0KFMsYykqbS5nZXQoUyx5KTtqPS1qL20uZ2V0KGMsYyk7Zm9yKGxldCBTPWM7Uzx0O1MrKyltLnNldChTLHksbS5nZXQoUyx5KStqKm0uZ2V0KFMsYykpfWZvcihsZXQgeT1jO3k8dDt5KyspbS5zZXQoeSxjLC1tLmdldCh5LGMpKTttLnNldChjLGMsMSttLmdldChjLGMpKTtmb3IobGV0IHk9MDt5PGMtMTt5KyspbS5zZXQoeSxjLDApfWVsc2V7Zm9yKGxldCB5PTA7eTx0O3krKyltLnNldCh5LGMsMCk7bS5zZXQoYyxjLDEpfX1pZihsKWZvcihsZXQgYz1yLTE7Yz49MDtjLS0pe2lmKGM8RSYmZltjXSE9PTApZm9yKGxldCB5PWMrMTt5PHI7eSsrKXtsZXQgaj0wO2ZvcihsZXQgUz1jKzE7UzxyO1MrKylqKz12LmdldChTLGMpKnYuZ2V0KFMseSk7aj0tai92LmdldChjKzEsYyk7Zm9yKGxldCBTPWMrMTtTPHI7UysrKXYuc2V0KFMseSx2LmdldChTLHkpK2oqdi5nZXQoUyxjKSl9Zm9yKGxldCB5PTA7eTxyO3krKyl2LnNldCh5LGMsMCk7di5zZXQoYyxjLDEpfWxldCBOPVItMSxJPU51bWJlci5FUFNJTE9OO2Zvcig7Uj4wOyl7bGV0IGMseTtmb3IoYz1SLTI7Yz49LTEmJmMhPT0tMTtjLS0pe2NvbnN0IGo9TnVtYmVyLk1JTl9WQUxVRStJKk1hdGguYWJzKHdbY10rTWF0aC5hYnMod1tjKzFdKSk7aWYoTWF0aC5hYnMoZltjXSk8PWp8fE51bWJlci5pc05hTihmW2NdKSl7ZltjXT0wO2JyZWFrfX1pZihjPT09Ui0yKXk9NDtlbHNle2xldCBqO2ZvcihqPVItMTtqPj1jJiZqIT09YztqLS0pe2xldCBTPShqIT09Uj9NYXRoLmFicyhmW2pdKTowKSsoaiE9PWMrMT9NYXRoLmFicyhmW2otMV0pOjApO2lmKE1hdGguYWJzKHdbal0pPD1JKlMpe3dbal09MDticmVha319aj09PWM/eT0zOmo9PT1SLTE/eT0xOih5PTIsYz1qKX1zd2l0Y2goYysrLHkpe2Nhc2UgMTp7bGV0IGo9ZltSLTJdO2ZbUi0yXT0wO2ZvcihsZXQgUz1SLTI7Uz49YztTLS0pe2xldCBQPUsod1tTXSxqKSxDPXdbU10vUCxMPWovUDtpZih3W1NdPVAsUyE9PWMmJihqPS1MKmZbUy0xXSxmW1MtMV09QypmW1MtMV0pLGwpZm9yKGxldCB6PTA7ejxyO3orKylQPUMqdi5nZXQoeixTKStMKnYuZ2V0KHosUi0xKSx2LnNldCh6LFItMSwtTCp2LmdldCh6LFMpK0Mqdi5nZXQoeixSLTEpKSx2LnNldCh6LFMsUCl9YnJlYWt9Y2FzZSAyOntsZXQgaj1mW2MtMV07ZltjLTFdPTA7Zm9yKGxldCBTPWM7UzxSO1MrKyl7bGV0IFA9Syh3W1NdLGopLEM9d1tTXS9QLEw9ai9QO2lmKHdbU109UCxqPS1MKmZbU10sZltTXT1DKmZbU10sYSlmb3IobGV0IHo9MDt6PHQ7eisrKVA9QyptLmdldCh6LFMpK0wqbS5nZXQoeixjLTEpLG0uc2V0KHosYy0xLC1MKm0uZ2V0KHosUykrQyptLmdldCh6LGMtMSkpLG0uc2V0KHosUyxQKX1icmVha31jYXNlIDM6e2NvbnN0IGo9TWF0aC5tYXgoTWF0aC5hYnMod1tSLTFdKSxNYXRoLmFicyh3W1ItMl0pLE1hdGguYWJzKGZbUi0yXSksTWF0aC5hYnMod1tjXSksTWF0aC5hYnMoZltjXSkpLFM9d1tSLTFdL2osUD13W1ItMl0vaixDPWZbUi0yXS9qLEw9d1tjXS9qLHo9ZltjXS9qLEQ9KChQK1MpKihQLVMpK0MqQykvMixCPVMqQyooUypDKTtsZXQgTz0wOyhEIT09MHx8QiE9PTApJiYoRDwwP089MC1NYXRoLnNxcnQoRCpEK0IpOk89TWF0aC5zcXJ0KEQqRCtCKSxPPUIvKEQrTykpO2xldCBZPShMK1MpKihMLVMpK08sXz1MKno7Zm9yKGxldCAkPWM7JDxSLTE7JCsrKXtsZXQgVT1LKFksXyk7VT09PTAmJihVPU51bWJlci5NSU5fVkFMVUUpO2xldCBYPVkvVSxaPV8vVTtpZigkIT09YyYmKGZbJC0xXT1VKSxZPVgqd1skXStaKmZbJF0sZlskXT1YKmZbJF0tWip3WyRdLF89Wip3WyQrMV0sd1skKzFdPVgqd1skKzFdLGwpZm9yKGxldCBWPTA7VjxyO1YrKylVPVgqdi5nZXQoViwkKStaKnYuZ2V0KFYsJCsxKSx2LnNldChWLCQrMSwtWip2LmdldChWLCQpK1gqdi5nZXQoViwkKzEpKSx2LnNldChWLCQsVSk7aWYoVT1LKFksXyksVT09PTAmJihVPU51bWJlci5NSU5fVkFMVUUpLFg9WS9VLFo9Xy9VLHdbJF09VSxZPVgqZlskXStaKndbJCsxXSx3WyQrMV09LVoqZlskXStYKndbJCsxXSxfPVoqZlskKzFdLGZbJCsxXT1YKmZbJCsxXSxhJiYkPHQtMSlmb3IobGV0IFY9MDtWPHQ7VisrKVU9WCptLmdldChWLCQpK1oqbS5nZXQoViwkKzEpLG0uc2V0KFYsJCsxLC1aKm0uZ2V0KFYsJCkrWCptLmdldChWLCQrMSkpLG0uc2V0KFYsJCxVKX1mW1ItMl09WTticmVha31jYXNlIDQ6e2lmKHdbY108PTAmJih3W2NdPXdbY108MD8td1tjXTowLGwpKWZvcihsZXQgaj0wO2o8PU47aisrKXYuc2V0KGosYywtdi5nZXQoaixjKSk7Zm9yKDtjPE4mJiEod1tjXT49d1tjKzFdKTspe2xldCBqPXdbY107aWYod1tjXT13W2MrMV0sd1tjKzFdPWosbCYmYzxyLTEpZm9yKGxldCBTPTA7UzxyO1MrKylqPXYuZ2V0KFMsYysxKSx2LnNldChTLGMrMSx2LmdldChTLGMpKSx2LnNldChTLGMsaik7aWYoYSYmYzx0LTEpZm9yKGxldCBTPTA7Uzx0O1MrKylqPW0uZ2V0KFMsYysxKSxtLnNldChTLGMrMSxtLmdldChTLGMpKSxtLnNldChTLGMsaik7YysrfVItLTticmVha319fWlmKGcpe2xldCBjPXY7dj1tLG09Y310aGlzLm09dCx0aGlzLm49cix0aGlzLnM9dyx0aGlzLlU9bSx0aGlzLlY9dn1zb2x2ZShlKXtsZXQgcz1lLHQ9dGhpcy50aHJlc2hvbGQscj10aGlzLnMubGVuZ3RoLG89VC56ZXJvcyhyLHIpO2ZvcihsZXQgcD0wO3A8cjtwKyspTWF0aC5hYnModGhpcy5zW3BdKTw9dD9vLnNldChwLHAsMCk6by5zZXQocCxwLDEvdGhpcy5zW3BdKTtsZXQgaT10aGlzLlUsaD10aGlzLnJpZ2h0U2luZ3VsYXJWZWN0b3JzLGE9aC5tbXVsKG8pLGw9aC5yb3dzLGc9aS5yb3dzLHU9VC56ZXJvcyhsLGcpO2ZvcihsZXQgcD0wO3A8bDtwKyspZm9yKGxldCBkPTA7ZDxnO2QrKyl7bGV0IHc9MDtmb3IobGV0IG09MDttPHI7bSsrKXcrPWEuZ2V0KHAsbSkqaS5nZXQoZCxtKTt1LnNldChwLGQsdyl9cmV0dXJuIHUubW11bChzKX1zb2x2ZUZvckRpYWdvbmFsKGUpe3JldHVybiB0aGlzLnNvbHZlKFQuZGlhZyhlKSl9aW52ZXJzZSgpe2xldCBlPXRoaXMuVixzPXRoaXMudGhyZXNob2xkLHQ9ZS5yb3dzLHI9ZS5jb2x1bW5zLG89bmV3IFQodCx0aGlzLnMubGVuZ3RoKTtmb3IobGV0IGc9MDtnPHQ7ZysrKWZvcihsZXQgdT0wO3U8cjt1KyspTWF0aC5hYnModGhpcy5zW3VdKT5zJiZvLnNldChnLHUsZS5nZXQoZyx1KS90aGlzLnNbdV0pO2xldCBpPXRoaXMuVSxoPWkucm93cyxhPWkuY29sdW1ucyxsPW5ldyBUKHQsaCk7Zm9yKGxldCBnPTA7Zzx0O2crKylmb3IobGV0IHU9MDt1PGg7dSsrKXtsZXQgcD0wO2ZvcihsZXQgZD0wO2Q8YTtkKyspcCs9by5nZXQoZyxkKSppLmdldCh1LGQpO2wuc2V0KGcsdSxwKX1yZXR1cm4gbH1nZXQgY29uZGl0aW9uKCl7cmV0dXJuIHRoaXMuc1swXS90aGlzLnNbTWF0aC5taW4odGhpcy5tLHRoaXMubiktMV19Z2V0IG5vcm0yKCl7cmV0dXJuIHRoaXMuc1swXX1nZXQgcmFuaygpe2xldCBlPU1hdGgubWF4KHRoaXMubSx0aGlzLm4pKnRoaXMuc1swXSpOdW1iZXIuRVBTSUxPTixzPTAsdD10aGlzLnM7Zm9yKGxldCByPTAsbz10Lmxlbmd0aDtyPG87cisrKXRbcl0+ZSYmcysrO3JldHVybiBzfWdldCBkaWFnb25hbCgpe3JldHVybiBBcnJheS5mcm9tKHRoaXMucyl9Z2V0IHRocmVzaG9sZCgpe3JldHVybiBOdW1iZXIuRVBTSUxPTi8yKk1hdGgubWF4KHRoaXMubSx0aGlzLm4pKnRoaXMuc1swXX1nZXQgbGVmdFNpbmd1bGFyVmVjdG9ycygpe3JldHVybiB0aGlzLlV9Z2V0IHJpZ2h0U2luZ3VsYXJWZWN0b3JzKCl7cmV0dXJuIHRoaXMuVn1nZXQgZGlhZ29uYWxNYXRyaXgoKXtyZXR1cm4gVC5kaWFnKHRoaXMucyl9fWNsYXNzIGxle2NvbnN0cnVjdG9yKGUscz17fSl7Y29uc3R7YXNzdW1lU3ltbWV0cmljOnQ9ITF9PXM7aWYoZT1sdC5jaGVja01hdHJpeChlKSwhZS5pc1NxdWFyZSgpKXRocm93IG5ldyBFcnJvcigiTWF0cml4IGlzIG5vdCBhIHNxdWFyZSBtYXRyaXgiKTtpZihlLmlzRW1wdHkoKSl0aHJvdyBuZXcgRXJyb3IoIk1hdHJpeCBtdXN0IGJlIG5vbi1lbXB0eSIpO2xldCByPWUuY29sdW1ucyxvPW5ldyBUKHIsciksaT1uZXcgRmxvYXQ2NEFycmF5KHIpLGg9bmV3IEZsb2F0NjRBcnJheShyKSxhPWUsbCxnLHU9ITE7aWYodD91PSEwOnU9ZS5pc1N5bW1ldHJpYygpLHUpe2ZvcihsPTA7bDxyO2wrKylmb3IoZz0wO2c8cjtnKyspby5zZXQobCxnLGEuZ2V0KGwsZykpO2hlKHIsaCxpLG8pLHVlKHIsaCxpLG8pfWVsc2V7bGV0IHA9bmV3IFQocixyKSxkPW5ldyBGbG9hdDY0QXJyYXkocik7Zm9yKGc9MDtnPHI7ZysrKWZvcihsPTA7bDxyO2wrKylwLnNldChsLGcsYS5nZXQobCxnKSk7ZmUocixwLGQsbyksYWUocixoLGksbyxwKX10aGlzLm49cix0aGlzLmU9aCx0aGlzLmQ9aSx0aGlzLlY9b31nZXQgcmVhbEVpZ2VudmFsdWVzKCl7cmV0dXJuIEFycmF5LmZyb20odGhpcy5kKX1nZXQgaW1hZ2luYXJ5RWlnZW52YWx1ZXMoKXtyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmUpfWdldCBlaWdlbnZlY3Rvck1hdHJpeCgpe3JldHVybiB0aGlzLlZ9Z2V0IGRpYWdvbmFsTWF0cml4KCl7bGV0IGU9dGhpcy5uLHM9dGhpcy5lLHQ9dGhpcy5kLHI9bmV3IFQoZSxlKSxvLGk7Zm9yKG89MDtvPGU7bysrKXtmb3IoaT0wO2k8ZTtpKyspci5zZXQobyxpLDApO3Iuc2V0KG8sbyx0W29dKSxzW29dPjA/ci5zZXQobyxvKzEsc1tvXSk6c1tvXTwwJiZyLnNldChvLG8tMSxzW29dKX1yZXR1cm4gcn19ZnVuY3Rpb24gaGUobixlLHMsdCl7bGV0IHIsbyxpLGgsYSxsLGcsdTtmb3IoYT0wO2E8bjthKyspc1thXT10LmdldChuLTEsYSk7Zm9yKGg9bi0xO2g+MDtoLS0pe2Zvcih1PTAsaT0wLGw9MDtsPGg7bCsrKXU9dStNYXRoLmFicyhzW2xdKTtpZih1PT09MClmb3IoZVtoXT1zW2gtMV0sYT0wO2E8aDthKyspc1thXT10LmdldChoLTEsYSksdC5zZXQoaCxhLDApLHQuc2V0KGEsaCwwKTtlbHNle2ZvcihsPTA7bDxoO2wrKylzW2xdLz11LGkrPXNbbF0qc1tsXTtmb3Iocj1zW2gtMV0sbz1NYXRoLnNxcnQoaSkscj4wJiYobz0tbyksZVtoXT11Km8saT1pLXIqbyxzW2gtMV09ci1vLGE9MDthPGg7YSsrKWVbYV09MDtmb3IoYT0wO2E8aDthKyspe2ZvcihyPXNbYV0sdC5zZXQoYSxoLHIpLG89ZVthXSt0LmdldChhLGEpKnIsbD1hKzE7bDw9aC0xO2wrKylvKz10LmdldChsLGEpKnNbbF0sZVtsXSs9dC5nZXQobCxhKSpyO2VbYV09b31mb3Iocj0wLGE9MDthPGg7YSsrKWVbYV0vPWkscis9ZVthXSpzW2FdO2ZvcihnPXIvKGkraSksYT0wO2E8aDthKyspZVthXS09ZypzW2FdO2ZvcihhPTA7YTxoO2ErKyl7Zm9yKHI9c1thXSxvPWVbYV0sbD1hO2w8PWgtMTtsKyspdC5zZXQobCxhLHQuZ2V0KGwsYSktKHIqZVtsXStvKnNbbF0pKTtzW2FdPXQuZ2V0KGgtMSxhKSx0LnNldChoLGEsMCl9fXNbaF09aX1mb3IoaD0wO2g8bi0xO2grKyl7aWYodC5zZXQobi0xLGgsdC5nZXQoaCxoKSksdC5zZXQoaCxoLDEpLGk9c1toKzFdLGkhPT0wKXtmb3IobD0wO2w8PWg7bCsrKXNbbF09dC5nZXQobCxoKzEpL2k7Zm9yKGE9MDthPD1oO2ErKyl7Zm9yKG89MCxsPTA7bDw9aDtsKyspbys9dC5nZXQobCxoKzEpKnQuZ2V0KGwsYSk7Zm9yKGw9MDtsPD1oO2wrKyl0LnNldChsLGEsdC5nZXQobCxhKS1vKnNbbF0pfX1mb3IobD0wO2w8PWg7bCsrKXQuc2V0KGwsaCsxLDApfWZvcihhPTA7YTxuO2ErKylzW2FdPXQuZ2V0KG4tMSxhKSx0LnNldChuLTEsYSwwKTt0LnNldChuLTEsbi0xLDEpLGVbMF09MH1mdW5jdGlvbiB1ZShuLGUscyx0KXtsZXQgcixvLGksaCxhLGwsZyx1LHAsZCx3LG0sdixmLE0sYjtmb3IoaT0xO2k8bjtpKyspZVtpLTFdPWVbaV07ZVtuLTFdPTA7bGV0IGs9MCxFPTAsRj1OdW1iZXIuRVBTSUxPTjtmb3IobD0wO2w8bjtsKyspe2ZvcihFPU1hdGgubWF4KEUsTWF0aC5hYnMoc1tsXSkrTWF0aC5hYnMoZVtsXSkpLGc9bDtnPG4mJiEoTWF0aC5hYnMoZVtnXSk8PUYqRSk7KWcrKztpZihnPmwpZG97Zm9yKHI9c1tsXSx1PShzW2wrMV0tcikvKDIqZVtsXSkscD1LKHUsMSksdTwwJiYocD0tcCksc1tsXT1lW2xdLyh1K3ApLHNbbCsxXT1lW2xdKih1K3ApLGQ9c1tsKzFdLG89ci1zW2xdLGk9bCsyO2k8bjtpKyspc1tpXS09bztmb3Ioaz1rK28sdT1zW2ddLHc9MSxtPXcsdj13LGY9ZVtsKzFdLE09MCxiPTAsaT1nLTE7aT49bDtpLS0pZm9yKHY9bSxtPXcsYj1NLHI9dyplW2ldLG89dyp1LHA9Syh1LGVbaV0pLGVbaSsxXT1NKnAsTT1lW2ldL3Asdz11L3AsdT13KnNbaV0tTSpyLHNbaSsxXT1vK00qKHcqcitNKnNbaV0pLGE9MDthPG47YSsrKW89dC5nZXQoYSxpKzEpLHQuc2V0KGEsaSsxLE0qdC5nZXQoYSxpKSt3Km8pLHQuc2V0KGEsaSx3KnQuZ2V0KGEsaSktTSpvKTt1PS1NKmIqdipmKmVbbF0vZCxlW2xdPU0qdSxzW2xdPXcqdX13aGlsZShNYXRoLmFicyhlW2xdKT5GKkUpO3NbbF09c1tsXStrLGVbbF09MH1mb3IoaT0wO2k8bi0xO2krKyl7Zm9yKGE9aSx1PXNbaV0saD1pKzE7aDxuO2grKylzW2hdPHUmJihhPWgsdT1zW2hdKTtpZihhIT09aSlmb3Ioc1thXT1zW2ldLHNbaV09dSxoPTA7aDxuO2grKyl1PXQuZ2V0KGgsaSksdC5zZXQoaCxpLHQuZ2V0KGgsYSkpLHQuc2V0KGgsYSx1KX19ZnVuY3Rpb24gZmUobixlLHMsdCl7bGV0IHI9MCxvPW4tMSxpLGgsYSxsLGcsdSxwO2Zvcih1PXIrMTt1PD1vLTE7dSsrKXtmb3IocD0wLGw9dTtsPD1vO2wrKylwPXArTWF0aC5hYnMoZS5nZXQobCx1LTEpKTtpZihwIT09MCl7Zm9yKGE9MCxsPW87bD49dTtsLS0pc1tsXT1lLmdldChsLHUtMSkvcCxhKz1zW2xdKnNbbF07Zm9yKGg9TWF0aC5zcXJ0KGEpLHNbdV0+MCYmKGg9LWgpLGE9YS1zW3VdKmgsc1t1XT1zW3VdLWgsZz11O2c8bjtnKyspe2ZvcihpPTAsbD1vO2w+PXU7bC0tKWkrPXNbbF0qZS5nZXQobCxnKTtmb3IoaT1pL2EsbD11O2w8PW87bCsrKWUuc2V0KGwsZyxlLmdldChsLGcpLWkqc1tsXSl9Zm9yKGw9MDtsPD1vO2wrKyl7Zm9yKGk9MCxnPW87Zz49dTtnLS0paSs9c1tnXSplLmdldChsLGcpO2ZvcihpPWkvYSxnPXU7Zzw9bztnKyspZS5zZXQobCxnLGUuZ2V0KGwsZyktaSpzW2ddKX1zW3VdPXAqc1t1XSxlLnNldCh1LHUtMSxwKmgpfX1mb3IobD0wO2w8bjtsKyspZm9yKGc9MDtnPG47ZysrKXQuc2V0KGwsZyxsPT09Zz8xOjApO2Zvcih1PW8tMTt1Pj1yKzE7dS0tKWlmKGUuZ2V0KHUsdS0xKSE9PTApe2ZvcihsPXUrMTtsPD1vO2wrKylzW2xdPWUuZ2V0KGwsdS0xKTtmb3IoZz11O2c8PW87ZysrKXtmb3IoaD0wLGw9dTtsPD1vO2wrKyloKz1zW2xdKnQuZ2V0KGwsZyk7Zm9yKGg9aC9zW3VdL2UuZ2V0KHUsdS0xKSxsPXU7bDw9bztsKyspdC5zZXQobCxnLHQuZ2V0KGwsZykraCpzW2xdKX19fWZ1bmN0aW9uIGFlKG4sZSxzLHQscil7bGV0IG89bi0xLGk9MCxoPW4tMSxhPU51bWJlci5FUFNJTE9OLGw9MCxnPTAsdT0wLHA9MCxkPTAsdz0wLG09MCx2PTAsZixNLGIsayxFLEYsUixOLEksYyx5LGosUyxQLEM7Zm9yKGY9MDtmPG47ZisrKWZvcigoZjxpfHxmPmgpJiYoc1tmXT1yLmdldChmLGYpLGVbZl09MCksTT1NYXRoLm1heChmLTEsMCk7TTxuO00rKylnPWcrTWF0aC5hYnMoci5nZXQoZixNKSk7Zm9yKDtvPj1pOyl7Zm9yKGs9bztrPmkmJih3PU1hdGguYWJzKHIuZ2V0KGstMSxrLTEpKStNYXRoLmFicyhyLmdldChrLGspKSx3PT09MCYmKHc9ZyksIShNYXRoLmFicyhyLmdldChrLGstMSkpPGEqdykpOylrLS07aWYoaz09PW8pci5zZXQobyxvLHIuZ2V0KG8sbykrbCksc1tvXT1yLmdldChvLG8pLGVbb109MCxvLS0sdj0wO2Vsc2UgaWYoaz09PW8tMSl7aWYoUj1yLmdldChvLG8tMSkqci5nZXQoby0xLG8pLHU9KHIuZ2V0KG8tMSxvLTEpLXIuZ2V0KG8sbykpLzIscD11KnUrUixtPU1hdGguc3FydChNYXRoLmFicyhwKSksci5zZXQobyxvLHIuZ2V0KG8sbykrbCksci5zZXQoby0xLG8tMSxyLmdldChvLTEsby0xKStsKSxOPXIuZ2V0KG8sbykscD49MCl7Zm9yKG09dT49MD91K206dS1tLHNbby0xXT1OK20sc1tvXT1zW28tMV0sbSE9PTAmJihzW29dPU4tUi9tKSxlW28tMV09MCxlW29dPTAsTj1yLmdldChvLG8tMSksdz1NYXRoLmFicyhOKStNYXRoLmFicyhtKSx1PU4vdyxwPW0vdyxkPU1hdGguc3FydCh1KnUrcCpwKSx1PXUvZCxwPXAvZCxNPW8tMTtNPG47TSsrKW09ci5nZXQoby0xLE0pLHIuc2V0KG8tMSxNLHAqbSt1KnIuZ2V0KG8sTSkpLHIuc2V0KG8sTSxwKnIuZ2V0KG8sTSktdSptKTtmb3IoZj0wO2Y8PW87ZisrKW09ci5nZXQoZixvLTEpLHIuc2V0KGYsby0xLHAqbSt1KnIuZ2V0KGYsbykpLHIuc2V0KGYsbyxwKnIuZ2V0KGYsbyktdSptKTtmb3IoZj1pO2Y8PWg7ZisrKW09dC5nZXQoZixvLTEpLHQuc2V0KGYsby0xLHAqbSt1KnQuZ2V0KGYsbykpLHQuc2V0KGYsbyxwKnQuZ2V0KGYsbyktdSptKX1lbHNlIHNbby0xXT1OK3Usc1tvXT1OK3UsZVtvLTFdPW0sZVtvXT0tbTtvPW8tMix2PTB9ZWxzZXtpZihOPXIuZ2V0KG8sbyksST0wLFI9MCxrPG8mJihJPXIuZ2V0KG8tMSxvLTEpLFI9ci5nZXQobyxvLTEpKnIuZ2V0KG8tMSxvKSksdj09PTEwKXtmb3IobCs9TixmPWk7Zjw9bztmKyspci5zZXQoZixmLHIuZ2V0KGYsZiktTik7dz1NYXRoLmFicyhyLmdldChvLG8tMSkpK01hdGguYWJzKHIuZ2V0KG8tMSxvLTIpKSxOPUk9Ljc1KncsUj0tLjQzNzUqdyp3fWlmKHY9PT0zMCYmKHc9KEktTikvMix3PXcqdytSLHc+MCkpe2Zvcih3PU1hdGguc3FydCh3KSxJPE4mJih3PS13KSx3PU4tUi8oKEktTikvMit3KSxmPWk7Zjw9bztmKyspci5zZXQoZixmLHIuZ2V0KGYsZiktdyk7bCs9dyxOPUk9Uj0uOTY0fWZvcih2PXYrMSxFPW8tMjtFPj1rJiYobT1yLmdldChFLEUpLGQ9Ti1tLHc9SS1tLHU9KGQqdy1SKS9yLmdldChFKzEsRSkrci5nZXQoRSxFKzEpLHA9ci5nZXQoRSsxLEUrMSktbS1kLXcsZD1yLmdldChFKzIsRSsxKSx3PU1hdGguYWJzKHUpK01hdGguYWJzKHApK01hdGguYWJzKGQpLHU9dS93LHA9cC93LGQ9ZC93LCEoRT09PWt8fE1hdGguYWJzKHIuZ2V0KEUsRS0xKSkqKE1hdGguYWJzKHApK01hdGguYWJzKGQpKTxhKihNYXRoLmFicyh1KSooTWF0aC5hYnMoci5nZXQoRS0xLEUtMSkpK01hdGguYWJzKG0pK01hdGguYWJzKHIuZ2V0KEUrMSxFKzEpKSkpKSk7KUUtLTtmb3IoZj1FKzI7Zjw9bztmKyspci5zZXQoZixmLTIsMCksZj5FKzImJnIuc2V0KGYsZi0zLDApO2ZvcihiPUU7Yjw9by0xJiYoUD1iIT09by0xLGIhPT1FJiYodT1yLmdldChiLGItMSkscD1yLmdldChiKzEsYi0xKSxkPVA/ci5nZXQoYisyLGItMSk6MCxOPU1hdGguYWJzKHUpK01hdGguYWJzKHApK01hdGguYWJzKGQpLE4hPT0wJiYodT11L04scD1wL04sZD1kL04pKSxOIT09MCk7YisrKWlmKHc9TWF0aC5zcXJ0KHUqdStwKnArZCpkKSx1PDAmJih3PS13KSx3IT09MCl7Zm9yKGIhPT1FP3Iuc2V0KGIsYi0xLC13Kk4pOmshPT1FJiZyLnNldChiLGItMSwtci5nZXQoYixiLTEpKSx1PXUrdyxOPXUvdyxJPXAvdyxtPWQvdyxwPXAvdSxkPWQvdSxNPWI7TTxuO00rKyl1PXIuZ2V0KGIsTSkrcCpyLmdldChiKzEsTSksUCYmKHU9dStkKnIuZ2V0KGIrMixNKSxyLnNldChiKzIsTSxyLmdldChiKzIsTSktdSptKSksci5zZXQoYixNLHIuZ2V0KGIsTSktdSpOKSxyLnNldChiKzEsTSxyLmdldChiKzEsTSktdSpJKTtmb3IoZj0wO2Y8PU1hdGgubWluKG8sYiszKTtmKyspdT1OKnIuZ2V0KGYsYikrSSpyLmdldChmLGIrMSksUCYmKHU9dSttKnIuZ2V0KGYsYisyKSxyLnNldChmLGIrMixyLmdldChmLGIrMiktdSpkKSksci5zZXQoZixiLHIuZ2V0KGYsYiktdSksci5zZXQoZixiKzEsci5nZXQoZixiKzEpLXUqcCk7Zm9yKGY9aTtmPD1oO2YrKyl1PU4qdC5nZXQoZixiKStJKnQuZ2V0KGYsYisxKSxQJiYodT11K20qdC5nZXQoZixiKzIpLHQuc2V0KGYsYisyLHQuZ2V0KGYsYisyKS11KmQpKSx0LnNldChmLGIsdC5nZXQoZixiKS11KSx0LnNldChmLGIrMSx0LmdldChmLGIrMSktdSpwKX19fWlmKGchPT0wKXtmb3Iobz1uLTE7bz49MDtvLS0paWYodT1zW29dLHA9ZVtvXSxwPT09MClmb3Ioaz1vLHIuc2V0KG8sbywxKSxmPW8tMTtmPj0wO2YtLSl7Zm9yKFI9ci5nZXQoZixmKS11LGQ9MCxNPWs7TTw9bztNKyspZD1kK3IuZ2V0KGYsTSkqci5nZXQoTSxvKTtpZihlW2ZdPDApbT1SLHc9ZDtlbHNlIGlmKGs9ZixlW2ZdPT09MD9yLnNldChmLG8sUiE9PTA/LWQvUjotZC8oYSpnKSk6KE49ci5nZXQoZixmKzEpLEk9ci5nZXQoZisxLGYpLHA9KHNbZl0tdSkqKHNbZl0tdSkrZVtmXSplW2ZdLEY9KE4qdy1tKmQpL3Asci5zZXQoZixvLEYpLHIuc2V0KGYrMSxvLE1hdGguYWJzKE4pPk1hdGguYWJzKG0pPygtZC1SKkYpL046KC13LUkqRikvbSkpLEY9TWF0aC5hYnMoci5nZXQoZixvKSksYSpGKkY+MSlmb3IoTT1mO008PW87TSsrKXIuc2V0KE0sbyxyLmdldChNLG8pL0YpfWVsc2UgaWYocDwwKWZvcihrPW8tMSxNYXRoLmFicyhyLmdldChvLG8tMSkpPk1hdGguYWJzKHIuZ2V0KG8tMSxvKSk/KHIuc2V0KG8tMSxvLTEscC9yLmdldChvLG8tMSkpLHIuc2V0KG8tMSxvLC0oci5nZXQobyxvKS11KS9yLmdldChvLG8tMSkpKTooQz1odCgwLC1yLmdldChvLTEsbyksci5nZXQoby0xLG8tMSktdSxwKSxyLnNldChvLTEsby0xLENbMF0pLHIuc2V0KG8tMSxvLENbMV0pKSxyLnNldChvLG8tMSwwKSxyLnNldChvLG8sMSksZj1vLTI7Zj49MDtmLS0pe2ZvcihjPTAseT0wLE09aztNPD1vO00rKyljPWMrci5nZXQoZixNKSpyLmdldChNLG8tMSkseT15K3IuZ2V0KGYsTSkqci5nZXQoTSxvKTtpZihSPXIuZ2V0KGYsZiktdSxlW2ZdPDApbT1SLGQ9Yyx3PXk7ZWxzZSBpZihrPWYsZVtmXT09PTA/KEM9aHQoLWMsLXksUixwKSxyLnNldChmLG8tMSxDWzBdKSxyLnNldChmLG8sQ1sxXSkpOihOPXIuZ2V0KGYsZisxKSxJPXIuZ2V0KGYrMSxmKSxqPShzW2ZdLXUpKihzW2ZdLXUpK2VbZl0qZVtmXS1wKnAsUz0oc1tmXS11KSoyKnAsaj09PTAmJlM9PT0wJiYoaj1hKmcqKE1hdGguYWJzKFIpK01hdGguYWJzKHApK01hdGguYWJzKE4pK01hdGguYWJzKEkpK01hdGguYWJzKG0pKSksQz1odChOKmQtbSpjK3AqeSxOKnctbSp5LXAqYyxqLFMpLHIuc2V0KGYsby0xLENbMF0pLHIuc2V0KGYsbyxDWzFdKSxNYXRoLmFicyhOKT5NYXRoLmFicyhtKStNYXRoLmFicyhwKT8oci5zZXQoZisxLG8tMSwoLWMtUipyLmdldChmLG8tMSkrcCpyLmdldChmLG8pKS9OKSxyLnNldChmKzEsbywoLXktUipyLmdldChmLG8pLXAqci5nZXQoZixvLTEpKS9OKSk6KEM9aHQoLWQtSSpyLmdldChmLG8tMSksLXctSSpyLmdldChmLG8pLG0scCksci5zZXQoZisxLG8tMSxDWzBdKSxyLnNldChmKzEsbyxDWzFdKSkpLEY9TWF0aC5tYXgoTWF0aC5hYnMoci5nZXQoZixvLTEpKSxNYXRoLmFicyhyLmdldChmLG8pKSksYSpGKkY+MSlmb3IoTT1mO008PW87TSsrKXIuc2V0KE0sby0xLHIuZ2V0KE0sby0xKS9GKSxyLnNldChNLG8sci5nZXQoTSxvKS9GKX1mb3IoZj0wO2Y8bjtmKyspaWYoZjxpfHxmPmgpZm9yKE09ZjtNPG47TSsrKXQuc2V0KGYsTSxyLmdldChmLE0pKTtmb3IoTT1uLTE7TT49aTtNLS0pZm9yKGY9aTtmPD1oO2YrKyl7Zm9yKG09MCxiPWk7Yjw9TWF0aC5taW4oTSxoKTtiKyspbT1tK3QuZ2V0KGYsYikqci5nZXQoYixNKTt0LnNldChmLE0sbSl9fX1mdW5jdGlvbiBodChuLGUscyx0KXtsZXQgcixvO3JldHVybiBNYXRoLmFicyhzKT5NYXRoLmFicyh0KT8ocj10L3Msbz1zK3IqdCxbKG4rciplKS9vLChlLXIqbikvb10pOihyPXMvdCxvPXQrcipzLFsocipuK2UpL28sKHIqZS1uKS9vXSl9Y2xhc3MgY2V7Y29uc3RydWN0b3IoZSxzPXt9KXtlPWx0LmNoZWNrTWF0cml4KGUpO2xldHtZOnR9PXM7Y29uc3R7c2NhbGVTY29yZXM6cj0hMSxtYXhJdGVyYXRpb25zOm89MWUzLHRlcm1pbmF0aW9uQ3JpdGVyaWE6aT0xZS0xMH09cztsZXQgaDtpZih0KXtpZihBcnJheS5pc0FycmF5KHQpJiZ0eXBlb2YgdFswXT09Im51bWJlciI/dD1ULmNvbHVtblZlY3Rvcih0KTp0PWx0LmNoZWNrTWF0cml4KHQpLHQucm93cyE9PWUucm93cyl0aHJvdyBuZXcgRXJyb3IoIlkgc2hvdWxkIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIHJvd3MgYXMgWCIpO2g9dC5nZXRDb2x1bW5WZWN0b3IoMCl9ZWxzZSBoPWUuZ2V0Q29sdW1uVmVjdG9yKDApO2xldCBhPTEsbCxnLHUscDtmb3IobGV0IGQ9MDtkPG8mJmE+aTtkKyspdT1lLnRyYW5zcG9zZSgpLm1tdWwoaCkuZGl2KGgudHJhbnNwb3NlKCkubW11bChoKS5nZXQoMCwwKSksdT11LmRpdih1Lm5vcm0oKSksbD1lLm1tdWwodSkuZGl2KHUudHJhbnNwb3NlKCkubW11bCh1KS5nZXQoMCwwKSksZD4wJiYoYT1sLmNsb25lKCkuc3ViKHApLnBvdygyKS5zdW0oKSkscD1sLmNsb25lKCksdD8oZz10LnRyYW5zcG9zZSgpLm1tdWwobCkuZGl2KGwudHJhbnNwb3NlKCkubW11bChsKS5nZXQoMCwwKSksZz1nLmRpdihnLm5vcm0oKSksaD10Lm1tdWwoZykuZGl2KGcudHJhbnNwb3NlKCkubW11bChnKS5nZXQoMCwwKSkpOmg9bDtpZih0KXtsZXQgZD1lLnRyYW5zcG9zZSgpLm1tdWwobCkuZGl2KGwudHJhbnNwb3NlKCkubW11bChsKS5nZXQoMCwwKSk7ZD1kLmRpdihkLm5vcm0oKSk7bGV0IHc9ZS5jbG9uZSgpLnN1YihsLmNsb25lKCkubW11bChkLnRyYW5zcG9zZSgpKSksbT1oLnRyYW5zcG9zZSgpLm1tdWwobCkuZGl2KGwudHJhbnNwb3NlKCkubW11bChsKS5nZXQoMCwwKSksdj10LmNsb25lKCkuc3ViKGwuY2xvbmUoKS5tdWxTKG0uZ2V0KDAsMCkpLm1tdWwoZy50cmFuc3Bvc2UoKSkpO3RoaXMudD1sLHRoaXMucD1kLnRyYW5zcG9zZSgpLHRoaXMudz11LnRyYW5zcG9zZSgpLHRoaXMucT1nLHRoaXMudT1oLHRoaXMucz1sLnRyYW5zcG9zZSgpLm1tdWwobCksdGhpcy54UmVzaWR1YWw9dyx0aGlzLnlSZXNpZHVhbD12LHRoaXMuYmV0YXM9bX1lbHNlIHRoaXMudz11LnRyYW5zcG9zZSgpLHRoaXMucz1sLnRyYW5zcG9zZSgpLm1tdWwobCkuc3FydCgpLHI/dGhpcy50PWwuY2xvbmUoKS5kaXYodGhpcy5zLmdldCgwLDApKTp0aGlzLnQ9bCx0aGlzLnhSZXNpZHVhbD1lLnN1YihsLm1tdWwodS50cmFuc3Bvc2UoKSkpfX1jbGFzcyBmdHtjb25zdHJ1Y3RvcihlLHM9e30pe2lmKGU9PT0hMCl7Y29uc3QgbD1zO3RoaXMuY2VudGVyPWwuY2VudGVyLHRoaXMuc2NhbGU9bC5zY2FsZSx0aGlzLm1lYW5zPWwubWVhbnMsdGhpcy5zdGRldnM9bC5zdGRldnMsdGhpcy5VPVQuY2hlY2tNYXRyaXgobC5VKSx0aGlzLlM9bC5TLHRoaXMuUj1sLlIsdGhpcy5leGNsdWRlZEZlYXR1cmVzPWwuZXhjbHVkZWRGZWF0dXJlc3x8W107cmV0dXJufWU9bmV3IFQoZSk7Y29uc3R7aXNDb3ZhcmlhbmNlTWF0cml4OnQ9ITEsbWV0aG9kOnI9IlNWRCIsbkNvbXBOSVBBTFM6bz0yLGNlbnRlcjppPSEwLHNjYWxlOmg9ITEsaWdub3JlWmVyb1ZhcmlhbmNlOmE9ITF9PXM7aWYodGhpcy5jZW50ZXI9aSx0aGlzLnNjYWxlPWgsdGhpcy5tZWFucz1udWxsLHRoaXMuc3RkZXZzPW51bGwsdGhpcy5leGNsdWRlZEZlYXR1cmVzPVtdLHQpe3RoaXMuX2NvbXB1dGVGcm9tQ292YXJpYW5jZU1hdHJpeChlKTtyZXR1cm59c3dpdGNoKHRoaXMuX2FkanVzdChlLGEpLHIpe2Nhc2UiY292YXJpYW5jZU1hdHJpeCI6e2NvbnN0IGw9bmV3IG5lKGUpLm1tdWwoZSkuZGl2KGUucm93cy0xKTt0aGlzLl9jb21wdXRlRnJvbUNvdmFyaWFuY2VNYXRyaXgobCk7YnJlYWt9Y2FzZSJOSVBBTFMiOnt0aGlzLl9jb21wdXRlV2l0aE5JUEFMUyhlLG8pO2JyZWFrfWNhc2UiU1ZEIjp7Y29uc3QgbD1uZXcgaWUoZSx7Y29tcHV0ZUxlZnRTaW5ndWxhclZlY3RvcnM6ITEsY29tcHV0ZVJpZ2h0U2luZ3VsYXJWZWN0b3JzOiEwLGF1dG9UcmFuc3Bvc2U6ITB9KTt0aGlzLlU9bC5yaWdodFNpbmd1bGFyVmVjdG9ycztjb25zdCBnPWwuZGlhZ29uYWwsdT1bXTtmb3IoY29uc3QgcCBvZiBnKXUucHVzaChwKnAvKGUucm93cy0xKSk7dGhpcy5TPXU7YnJlYWt9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gbWV0aG9kOiAke3J9YCl9fXN0YXRpYyBsb2FkKGUpe2lmKHR5cGVvZiBlLm5hbWUhPSJzdHJpbmciKXRocm93IG5ldyBUeXBlRXJyb3IoIm1vZGVsIG11c3QgaGF2ZSBhIG5hbWUgcHJvcGVydHkiKTtpZihlLm5hbWUhPT0iUENBIil0aHJvdyBuZXcgUmFuZ2VFcnJvcihgaW52YWxpZCBtb2RlbDogJHtlLm5hbWV9YCk7cmV0dXJuIG5ldyBmdCghMCxlKX1wcmVkaWN0KGUscz17fSl7Y29uc3R7bkNvbXBvbmVudHM6dD10aGlzLlUuY29sdW1uc309cztpZihlPW5ldyBUKGUpLHRoaXMuY2VudGVyJiYoZS5zdWJSb3dWZWN0b3IodGhpcy5tZWFucyksdGhpcy5zY2FsZSkpe2ZvcihsZXQgbyBvZiB0aGlzLmV4Y2x1ZGVkRmVhdHVyZXMpZS5yZW1vdmVDb2x1bW4obyk7ZS5kaXZSb3dWZWN0b3IodGhpcy5zdGRldnMpfWxldCByPWUubW11bCh0aGlzLlUpO3JldHVybiByLnN1Yk1hdHJpeCgwLHIucm93cy0xLDAsdC0xKX1pbnZlcnQoZSl7ZT1ULmNoZWNrTWF0cml4KGUpO2xldCBzPWUubW11bCh0aGlzLlUudHJhbnNwb3NlKCkpO3JldHVybiB0aGlzLmNlbnRlciYmKHRoaXMuc2NhbGUmJnMubXVsUm93VmVjdG9yKHRoaXMuc3RkZXZzKSxzLmFkZFJvd1ZlY3Rvcih0aGlzLm1lYW5zKSksc31nZXRFeHBsYWluZWRWYXJpYW5jZSgpe2xldCBlPTA7Zm9yKGNvbnN0IHMgb2YgdGhpcy5TKWUrPXM7cmV0dXJuIHRoaXMuUy5tYXAocz0+cy9lKX1nZXRDdW11bGF0aXZlVmFyaWFuY2UoKXtsZXQgZT10aGlzLmdldEV4cGxhaW5lZFZhcmlhbmNlKCk7Zm9yKGxldCBzPTE7czxlLmxlbmd0aDtzKyspZVtzXSs9ZVtzLTFdO3JldHVybiBlfWdldEVpZ2VudmVjdG9ycygpe3JldHVybiB0aGlzLlV9Z2V0RWlnZW52YWx1ZXMoKXtyZXR1cm4gdGhpcy5TfWdldFN0YW5kYXJkRGV2aWF0aW9ucygpe3JldHVybiB0aGlzLlMubWFwKGU9Pk1hdGguc3FydChlKSl9Z2V0TG9hZGluZ3MoKXtyZXR1cm4gdGhpcy5VLnRyYW5zcG9zZSgpfXRvSlNPTigpe3JldHVybntuYW1lOiJQQ0EiLGNlbnRlcjp0aGlzLmNlbnRlcixzY2FsZTp0aGlzLnNjYWxlLG1lYW5zOnRoaXMubWVhbnMsc3RkZXZzOnRoaXMuc3RkZXZzLFU6dGhpcy5VLFM6dGhpcy5TLGV4Y2x1ZGVkRmVhdHVyZXM6dGhpcy5leGNsdWRlZEZlYXR1cmVzfX1fYWRqdXN0KGUscyl7aWYodGhpcy5jZW50ZXIpe2NvbnN0IHQ9ZS5tZWFuKCJjb2x1bW4iKSxyPXRoaXMuc2NhbGU/ZS5zdGFuZGFyZERldmlhdGlvbigiY29sdW1uIix7bWVhbjp0fSk6bnVsbDtpZih0aGlzLm1lYW5zPXQsZS5zdWJSb3dWZWN0b3IodCksdGhpcy5zY2FsZSl7Zm9yKGxldCBvPTA7bzxyLmxlbmd0aDtvKyspaWYocltvXT09PTApaWYocyllLnJlbW92ZUNvbHVtbihvKSxyLnNwbGljZShvLDEpLHRoaXMuZXhjbHVkZWRGZWF0dXJlcy5wdXNoKG8pLG8tLTtlbHNlIHRocm93IG5ldyBSYW5nZUVycm9yKGBDYW5ub3Qgc2NhbGUgdGhlIGRhdGFzZXQgKHN0YW5kYXJkIGRldmlhdGlvbiBpcyB6ZXJvIGF0IGluZGV4ICR7b31gKTt0aGlzLnN0ZGV2cz1yLGUuZGl2Um93VmVjdG9yKHIpfX19X2NvbXB1dGVGcm9tQ292YXJpYW5jZU1hdHJpeChlKXtjb25zdCBzPW5ldyBsZShlLHthc3N1bWVTeW1tZXRyaWM6ITB9KTt0aGlzLlU9cy5laWdlbnZlY3Rvck1hdHJpeCx0aGlzLlUuZmxpcFJvd3MoKSx0aGlzLlM9cy5yZWFsRWlnZW52YWx1ZXMsdGhpcy5TLnJldmVyc2UoKX1fY29tcHV0ZVdpdGhOSVBBTFMoZSxzKXt0aGlzLlU9bmV3IFQocyxlLmNvbHVtbnMpLHRoaXMuUz1bXTtsZXQgdD1lO2ZvcihsZXQgcj0wO3I8cztyKyspe2xldCBvPW5ldyBjZSh0KTt0aGlzLlUuc2V0Um93KHIsby53LnRyYW5zcG9zZSgpKSx0aGlzLlMucHVzaChNYXRoLnBvdyhvLnMuZ2V0KDAsMCksMikpLHQ9by54UmVzaWR1YWx9dGhpcy5VPXRoaXMuVS50cmFuc3Bvc2UoKX19ZnVuY3Rpb24gZ2UobixlKXtyZXR1cm4gbitNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtbisxKSl9ZnVuY3Rpb24gYXQobil7bnx8KG49Z2UoMCxNYXRoLnBvdygyLDMxKS0xKSksdGhpcy5zZWVkPW4lMjE0NzQ4MzY0Nyx0aGlzLnNlZWQ8PTAmJih0aGlzLnNlZWQrPTIxNDc0ODM2NDYpfWF0LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VlZD10aGlzLnNlZWQqMTY4MDclMjE0NzQ4MzY0Nyx0aGlzLnNlZWR9LGF0LnByb3RvdHlwZS5uZXh0RmxvYXQ9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5uZXh0KCktMSkvMjE0NzQ4MzY0Nn07dmFyIG1lPWF0LFE9e30sRz17S246MTgsWG46Ljk1MDQ3LFluOjEsWm46MS4wODg4Myx0MDouMTM3OTMxMDM0LHQxOi4yMDY4OTY1NTIsdDI6LjEyODQxODU1LHQzOi4wMDg4NTY0NTJ9O2Z1bmN0aW9uIGN0KG4pe3JldHVybiBNYXRoLnJvdW5kKDI1NSoobjw9LjAwMzA0PzEyLjkyKm46MS4wNTUqTWF0aC5wb3cobiwxLzIuNCktLjA1NSkpfWZ1bmN0aW9uIGd0KG4pe3JldHVybihuLz0yNTUpPD0uMDQwNDU/bi8xMi45MjpNYXRoLnBvdygobisuMDU1KS8xLjA1NSwyLjQpfWZ1bmN0aW9uIG10KG4pe3JldHVybiBuPkcudDM/TWF0aC5wb3cobiwxLzMpOm4vRy50MitHLnQwfWZ1bmN0aW9uIHdlKG4pe3ZhciBlPW5bMF0scz1uWzFdLHQ9blsyXTtlPWd0KGUpLHM9Z3QocyksdD1ndCh0KTt2YXIgcj1tdCgoLjQxMjQ1NjQqZSsuMzU3NTc2MSpzKy4xODA0Mzc1KnQpL0cuWG4pLG89bXQoKC4yMTI2NzI5KmUrLjcxNTE1MjIqcysuMDcyMTc1KnQpL0cuWW4pLGk9bXQoKC4wMTkzMzM5KmUrLjExOTE5MipzKy45NTAzMDQxKnQpL0cuWm4pO3JldHVybltyLG8saV19ZnVuY3Rpb24gd3Qobil7cmV0dXJuIG4+Ry50MT9uKm4qbjpHLnQyKihuLUcudDApfWZ1bmN0aW9uIGJ0KG4pe3ZhciBlPW5bMF0scz1uWzFdLHQ9blsyXSxyPShlKzE2KS8xMTYsbz1pc05hTihzKT9yOnIrcy81MDAsaT1pc05hTih0KT9yOnItdC8yMDA7cj1HLlluKnd0KHIpLG89Ry5Ybip3dChvKSxpPUcuWm4qd3QoaSk7dmFyIGg9Y3QoMy4yNDA0NTQyKm8tMS41MzcxMzg1KnItLjQ5ODUzMTQqaSksYT1jdCgtLjk2OTI2NipvKzEuODc2MDEwOCpyKy4wNDE1NTYqaSk7cmV0dXJuIHQ9Y3QoLjA1NTY0MzQqby0uMjA0MDI1OSpyKzEuMDU3MjI1MippKSxbaCxhLHRdfWZ1bmN0aW9uIHBlKG4pe3ZhciBlPXdlKG4pLHM9ZVswXSx0PWVbMV0scj1lWzJdLG89MTE2KnQtMTY7cmV0dXJuW288MD8wOm8sNTAwKihzLXQpLDIwMCoodC1yKV19ZnVuY3Rpb24gZGUobil7dmFyIGU9blswXSxzPW5bMV0sdD1uWzJdO3JldHVybiBlPj0wJiZlPD0yNTUmJnM+PTAmJnM8PTI1NSYmdD49MCYmdDw9MjU1fWZ1bmN0aW9uIHB0KG4pe3JldHVybigiMCIrbi50b1N0cmluZygxNikpLnNsaWNlKC0yKX1mdW5jdGlvbiB5ZShuKXt2YXIgZT1idChuKTtyZXR1cm4iIyIrcHQoZVswXSkrcHQoZVsxXSkrcHQoZVsyXSl9dmFyIHZlPTE4MC9NYXRoLlBJO2Z1bmN0aW9uIE1lKG4pe3ZhciBlPW5bMF0scz1uWzFdLHQ9blsyXSxyPU1hdGguc3FydChzKnMrdCp0KSxvPShNYXRoLmF0YW4yKHQscykqdmUrMzYwKSUzNjA7cmV0dXJuIE1hdGgucm91bmQocioxZTQpPT09MCYmKG89TmFOKSxbbyxyLGVdfWZ1bmN0aW9uIFNlKG4sZSl7ZT1lLnNsaWNlKCk7Zm9yKHZhciBzPVtlLnNoaWZ0KCldLHQscixvLGksaCxhLGw7ZS5sZW5ndGg+MDspe2Zvcih0PS0xLHI9LTEvMCxvPTA7bzxlLmxlbmd0aDtvKyspZm9yKGk9ZVtvXSxsPTA7bDxzLmxlbmd0aDtsKyspaD1zW2xdLGE9bihpLGgpLGE+ciYmKHI9YSx0PW8pO3MucHVzaChlW3RdKSxlLnNwbGljZSh0LDEpfXJldHVybiBzfWZ1bmN0aW9uIGJlKG4sZSl7dmFyIHMsdCxyLG89MS8wLGksaD0wLGE9MDtmb3Iocz0wLHI9ZS5sZW5ndGg7czxyO3MrKylmb3IodD1zKzE7dDxyO3QrKylpPW4oZVtzXSxlW3RdKSxpPG8mJihvPWkpLGgrPWksYSsrO3JldHVybnttaW46byxtZWFuOmgvYX19US52YWxpZGF0ZVJnYj1kZSxRLmxhYlRvUmdiPWJ0LFEubGFiVG9SZ2JIZXg9eWUsUS5yZ2JUb0xhYj1wZSxRLmxhYlRvSGNsPU1lLFEuZGlmZlNvcnQ9U2UsUS5jb21wdXRlUXVhbGl0eU1ldHJpY3M9YmU7dmFyIGp0PVEsZXQ9e3Byb3Rhbm9wZTp7eDouNzQ2NSx5Oi4yNTM1LG06MS4yNzM0NjMseWludDotLjA3Mzg5NH0sZGV1dGVyYW5vcGU6e3g6MS40LHk6LS40LG06Ljk2ODQzNyx5aW50Oi4wMDMzMzF9LHRyaXRhbm9wZTp7eDouMTc0OCx5OjAsbTouMDYyOTIxLHlpbnQ6LjI5MjExOX19O2Z1bmN0aW9uIGplKG4sZSl7cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhuWzBdLWVbMF0sMikrTWF0aC5wb3coblsxXS1lWzFdLDIpK01hdGgucG93KG5bMl0tZVsyXSwyKSl9ZnVuY3Rpb24gRWUobixlLHMsdCl7Zm9yKHZhciByPXNbMF0sbz10WzBdLGk9c1sxXSxoPXRbMV0sYT1zWzJdLGw9dFsyXSxnPU1hdGguc3FydChNYXRoLnBvdyhpLDIpK01hdGgucG93KGEsMikpLHU9TWF0aC5zcXJ0KE1hdGgucG93KGgsMikrTWF0aC5wb3cobCwyKSkscD1nLXUsZD1yLW8sdz1pLWgsbT1hLWwsdj1NYXRoLnNxcnQoTWF0aC5wb3codywyKStNYXRoLnBvdyhtLDIpK01hdGgucG93KHAsMikpLGY9TWF0aC5hdGFuMihhLGkpKigxODAvTWF0aC5QSSk7ZjwwOylmKz0zNjA7dmFyIE09TWF0aC5zcXJ0KE1hdGgucG93KGcsNCkvKE1hdGgucG93KGcsNCkrMTkwMCkpLGI9Zj49MTY0JiZmPD0zNDU/LjU2K01hdGguYWJzKC4yKk1hdGguY29zKGYrMTY4KSk6LjM2K01hdGguYWJzKC40Kk1hdGguY29zKGYrMzUpKSxrPXNbMF08MTY/LjUxMTouMDQwOTc1KnIvKDErLjAxNzY1KnIpLEU9LjA2MzgqZy8oMSsuMDEzMSpnKSsuNjM4LEY9RSooTSpiKzEtTSksUj1NYXRoLnNxcnQoTWF0aC5wb3coZC8obiprKSwyKStNYXRoLnBvdyhwLyhlKkUpLDIpK01hdGgucG93KHYvRiwyKSk7cmV0dXJuIFJ9ZnVuY3Rpb24geCgpe3RoaXMuY2FjaGU9e319eC5wcm90b3R5cGUuc2ltdWxhdGU9ZnVuY3Rpb24obixlLHMpe3M9c3x8MTt2YXIgdD1uLmpvaW4oIi0iKSsiLSIrZSsiLSIrcyxyPXRoaXMuY2FjaGVbdF07aWYocilyZXR1cm4gcjt2YXIgbz1ldFtlXS54LGk9ZXRbZV0ueSxoPWV0W2VdLm0sYT1ldFtlXS55aW50LGw9anQubGFiVG9SZ2IobiksZz1sWzBdLHU9bFsxXSxwPWxbMl0sZD1nLHc9dSxtPXAsdj1NYXRoLnBvdyhnLDIuMiksZj1NYXRoLnBvdyh1LDIuMiksTT1NYXRoLnBvdyhwLDIuMiksYj12Ki40MTI0MjQrZiouMzU3NTc5K00qLjE4MDQ2NCxrPXYqLjIxMjY1NitmKi43MTUxNTgrTSouMDcyMTg1NixFPXYqLjAxOTMzMjQrZiouMTE5MTkzK00qLjk1MDQ0NCxGPWIvKGIraytFKSxSPWsvKGIraytFKSxOPShSLWkpLyhGLW8pLEk9Ui1GKk4sYz0oYS1JKS8oTi1oKSx5PU4qYytJO2I9YyprL3ksRT0oMS0oYyt5KSkqay95O3ZhciBqPS4zMTI3MTMqay8uMzI5MDE2LFM9LjM1ODI3MSprLy4zMjkwMTYsUD1qLWIsQz1TLUUsTD1QKjMuMjQwNzErQyotLjQ5ODU3MSx6PVAqLS45NjkyNTgrQyouMDQxNTU1NyxEPVAqLjA1NTYzNTIrQyoxLjA1NzA3O2Q9YiozLjI0MDcxK2sqLTEuNTM3MjYrRSotLjQ5ODU3MSx3PWIqLS45NjkyNTgrayoxLjg3NTk5K0UqLjA0MTU1NTcsbT1iKi4wNTU2MzUyK2sqLS4yMDM5OTYrRSoxLjA1NzA3O3ZhciBCPSgoZDwwPzA6MSktZCkvTCxPPSgodzwwPzA6MSktdykveixZPSgobTwwPzA6MSktbSkvRCxfPU1hdGgubWF4KEI+MXx8QjwwPzA6QixPPjF8fE88MD8wOk8sWT4xfHxZPDA/MDpZKTtkPWQrXypMLHc9dytfKnosbT1tK18qRCxkPU1hdGgucG93KGQsMS8yLjIpLHc9TWF0aC5wb3codywxLzIuMiksbT1NYXRoLnBvdyhtLDEvMi4yKSxkPWcqKDEtcykrZCpzLHc9dSooMS1zKSt3KnMsbT1wKigxLXMpK20qczt2YXIgJD1bZCx3LG1dLFU9anQucmdiVG9MYWIoJCk7cmV0dXJuIHRoaXMuY2FjaGVbdF09VSxVfSx4LnByb3RvdHlwZS5ldWNsaWRlYW49amUseC5wcm90b3R5cGUuY21jPUVlLmJpbmQobnVsbCwyLDEpLHgucHJvdG90eXBlLmNvbG9yYmxpbmQ9ZnVuY3Rpb24obixlLHMpe3JldHVybiBlPXRoaXMuc2ltdWxhdGUoZSxuKSxzPXRoaXMuc2ltdWxhdGUocyxuKSx0aGlzLmNtYyhlLHMpfSxPYmplY3Qua2V5cyhldCkuZm9yRWFjaChmdW5jdGlvbihuKXt4LnByb3RvdHlwZVtuXT1mdW5jdGlvbihlLHMpe3JldHVybiB0aGlzLmNvbG9yYmxpbmQobixlLHMpfX0pO3ZhciBSZT0xZTMrMTAwKzUwMCsxO3gucHJvdG90eXBlLmNvbXByb21pc2U9ZnVuY3Rpb24obixlKXt2YXIgcz0wLHQ9dGhpcy5jbWMobixlKTtyZXR1cm4gcys9dCoxZTMsdD10aGlzLmNvbG9yYmxpbmQoInByb3Rhbm9wZSIsbixlKSxpc05hTih0KXx8KHMrPXQqMTAwKSx0PXRoaXMuY29sb3JibGluZCgiZGV1dGVyYW5vcGUiLG4sZSksaXNOYU4odCl8fChzKz10KjUwMCksdD10aGlzLmNvbG9yYmxpbmQoInRyaXRhbm9wZSIsbixlKSxpc05hTih0KXx8KHMrPXQqMSkscy9SZX0seC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKG4pe3JldHVybiBuIGluIGV0P3RoaXMuY29sb3JibGluZC5iaW5kKHRoaXMsbik6dGhpc1tuXS5iaW5kKHRoaXMpfTt2YXIga2U9eCxOZT17YWxsOlswLDM2MCwwLDEwMCwwLDEwMF0sZGVmYXVsdDpbMCwzNjAsMzAsODAsMzUsODBdLGNvbG9yYmxpbmQ6WzAsMzYwLDQwLDcwLDE1LDg1XSwiZmFuY3ktbGlnaHQiOlswLDM2MCwxNSw0MCw3MCwxMDBdLCJmYW5jeS1kYXJrIjpbMCwzNjAsOCw0MCw3LDQwXSxzaGFkZXM6WzAsMjQwLDAsMTUsMCwxMDBdLHRhcm5pc2g6WzAsMzYwLDAsMTUsMzAsNzBdLHBhc3RlbDpbMCwzNjAsMCwzMCw3MCwxMDBdLHBpbXA6WzAsMzYwLDMwLDEwMCwyNSw3MF0saW50ZW5zZTpbMCwzNjAsMjAsMTAwLDE1LDgwXSxmbHVvOlswLDMwMCwzNSwxMDAsNzUsMTAwXSwicmVkLXJvc2VzIjpbMzMwLDIwLDEwLDEwMCwzNSwxMDBdLCJvY2hyZS1zYW5kIjpbMjAsNjAsMjAsNTAsMzUsMTAwXSwieWVsbG93LWxpbWUiOls2MCw5MCwxMCwxMDAsMzUsMTAwXSwiZ3JlZW4tbWludCI6WzkwLDE1MCwxMCwxMDAsMzUsMTAwXSwiaWNlLWN1YmUiOlsxNTAsMjAwLDAsMTAwLDM1LDEwMF0sImJsdWUtb2NlYW4iOlsyMjAsMjYwLDgsODAsMCw1MF0sImluZGlnby1uaWdodCI6WzI2MCwyOTAsNDAsMTAwLDM1LDEwMF0sInB1cnBsZS13aW5lIjpbMjkwLDMzMCwwLDEwMCwwLDQwXX0sVGU9TmUsSWU9bWUscWU9a2Usc3Q9USxFdD1UZSxGZT1zdC52YWxpZGF0ZVJnYix1dD1zdC5sYWJUb1JnYiwkZT1zdC5sYWJUb1JnYkhleCxSdD1zdC5sYWJUb0hjbCxDZT1zdC5kaWZmU29ydCxQZT17YXR0ZW1wdHM6MSxjb2xvckZpbHRlcjpudWxsLGNvbG9yU3BhY2U6ImRlZmF1bHQiLGNsdXN0ZXJpbmc6ImstbWVhbnMiLHF1YWxpdHk6NTAsdWx0cmFQcmVjaXNpb246ITEsZGlzdGFuY2U6ImV1Y2xpZGVhbiIsc2VlZDpudWxsfSxMZT1uZXcgU2V0KFsiZm9yY2UtdmVjdG9yIiwiay1tZWFucyJdKSx6ZT1uZXcgU2V0KFsiZXVjbGlkZWFuIiwiY21jIiwiY29tcHJvbWlzZSIsInByb3Rhbm9wZSIsImRldXRlcmFub3BlIiwidHJpdGFub3BlIl0pLE9lPW5ldyBTZXQoT2JqZWN0LmtleXMoRXQpKTtmdW5jdGlvbiBEZShuKXtmb3IodmFyIGU9MCxzPTAsdD1uLmxlbmd0aDtzPHQ7cysrKWUrPW4uY2hhckNvZGVBdChzKTtyZXR1cm4gZX1mdW5jdGlvbiBVZShuKXt2YXIgZT1PYmplY3QuYXNzaWduKHt9LFBlLG4pO2lmKHR5cGVvZiBlLmF0dGVtcHRzIT0ibnVtYmVyInx8ZS5hdHRlbXB0czw9MCl0aHJvdyBuZXcgRXJyb3IoIml3YW50aHVlOiBpbnZhbGlkIGBhdHRlbXB0c2Agc2V0dGluZy4gRXhwZWN0aW5nIGEgcG9zaXRpdmUgbnVtYmVyLiIpO2lmKGUuY29sb3JGaWx0ZXImJnR5cGVvZiBlLmNvbG9yRmlsdGVyIT0iZnVuY3Rpb24iKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGludmFsaWQgYGNvbG9yRmlsdGVyYCBzZXR0aW5nLiBFeHBlY3RpbmcgYSBmdW5jdGlvbi4iKTtpZighTGUuaGFzKGUuY2x1c3RlcmluZykpdGhyb3cgbmV3IEVycm9yKCdpd2FudGh1ZTogdW5rbm93biBgY2x1c3RlcmluZ2AgIicrZS5jbHVzdGVyaW5nKyciLicpO2lmKHR5cGVvZiBlLnF1YWxpdHkhPSJudW1iZXIifHxpc05hTihlLnF1YWxpdHkpfHxlLnF1YWxpdHk8MSl0aHJvdyBuZXcgRXJyb3IoIml3YW50aHVlOiBpbnZhbGlkIGBxdWFsaXR5YC4gRXhwZWN0aW5nIGEgbnVtYmVyID4gMC4iKTtpZih0eXBlb2YgZS51bHRyYVByZWNpc2lvbiE9ImJvb2xlYW4iKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGludmFsaWQgYHVsdHJhUHJlY2lzaW9uYC4gRXhwZWN0aW5nIGEgYm9vbGVhbi4iKTtpZighemUuaGFzKGUuZGlzdGFuY2UpKXRocm93IG5ldyBFcnJvcignaXdhbnRodWU6IHVua25vd24gYGRpc3RhbmNlYCAiJytlLmRpc3RhbmNlKyciLicpO2lmKHR5cGVvZiBlLnNlZWQ9PSJzdHJpbmciJiYoZS5zZWVkPURlKGUuc2VlZCkpLGUuc2VlZCE9PW51bGwmJnR5cGVvZiBlLnNlZWQhPSJudW1iZXIiKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGludmFsaWQgYHNlZWRgLiBFeHBlY3RpbmcgYW4gaW50ZWdlciBvciBhIHN0cmluZy4iKTtpZighZS5jb2xvckZpbHRlciYmZS5jb2xvclNwYWNlJiZlLmNvbG9yU3BhY2UhPT0iYWxsIil7dmFyIHM7aWYodHlwZW9mIGUuY29sb3JTcGFjZT09InN0cmluZyIpe2lmKCFPZS5oYXMoZS5jb2xvclNwYWNlKSl0aHJvdyBuZXcgRXJyb3IoJ2l3YW50aHVlOiB1bmtub3duIGBjb2xvclNwYWNlYCAiJytlLmNvbG9yU3BhY2UrJyIuJyk7cz1FdFtlLmNvbG9yU3BhY2VdfWVsc2UgaWYoQXJyYXkuaXNBcnJheShlLmNvbG9yU3BhY2UpKXtpZihlLmNvbG9yU3BhY2UubGVuZ3RoIT09Nil0aHJvdyBuZXcgRXJyb3IoIml3YW50aHVlOiBleHBlY3RpbmcgYSBgY29sb3JTcGFjZWAgYXJyYXkgb2YgbGVuZ3RoIDYgKFtobWluLCBobWF4LCBjbWluLCBjbWF4LCBsbWluLCBsbWF4XSkuIik7cz1lLmNvbG9yU3BhY2V9ZWxzZSBzPVtlLmNvbG9yU3BhY2UuaG1pbnx8MCxlLmNvbG9yU3BhY2UuaG1heHx8MzYwLGUuY29sb3JTcGFjZS5jbWlufHwwLGUuY29sb3JTcGFjZS5jbWF4fHwxMDAsZS5jb2xvclNwYWNlLmxtaW58fDAsZS5jb2xvclNwYWNlLmxtYXh8fDEwMF07c1swXTxzWzFdP2UuY29sb3JGaWx0ZXI9ZnVuY3Rpb24odCxyKXt2YXIgbz1SdChyKTtyZXR1cm4gb1swXT49c1swXSYmb1swXTw9c1sxXSYmb1sxXT49c1syXSYmb1sxXTw9c1szXSYmb1syXT49c1s0XSYmb1syXTw9c1s1XX06ZS5jb2xvckZpbHRlcj1mdW5jdGlvbih0LHIpe3ZhciBvPVJ0KHIpO3JldHVybihvWzBdPj1zWzBdfHxvWzBdPD1zWzFdKSYmb1sxXT49c1syXSYmb1sxXTw9c1szXSYmb1syXT49c1s0XSYmb1syXTw9c1s1XX19cmV0dXJuIGV9ZnVuY3Rpb24gVmUobixlLHMpe2Zvcih2YXIgdD1uZXcgQXJyYXkoZSkscixvLGk9MDtpPGU7aSsrKXtkbyByPVsxMDAqbigpLDEwMCooMipuKCktMSksMTAwKigyKm4oKS0xKV0sbz11dChyKTt3aGlsZSghcyhvLHIpKTt0W2ldPXJ9cmV0dXJuIHR9dmFyIEJlPTEwMCxrdD0xMDA7ZnVuY3Rpb24gWWUobixlLHMsdCxyKXtmb3IodmFyIG89bmV3IEFycmF5KHQubGVuZ3RoKSxpPXIucXVhbGl0eSoyMCxoLGEsbD10Lmxlbmd0aCxnLHUscCxkLHcsbSx2LGYsTSxiLGssRTtpLS0gPjA7KXtmb3IoaD0wO2g8bDtoKyspb1toXT17ZGw6MCxkYTowLGRiOjB9O2ZvcihoPTA7aDxsO2grKylmb3IoZz10W2hdLGE9MDthPGg7YSsrKXU9dFthXSxwPWUoZyx1KSxwPjA/KGQ9Z1swXS11WzBdLHc9Z1sxXS11WzFdLG09Z1syXS11WzJdLHY9QmUvTWF0aC5wb3cocCwyKSxvW2hdLmRsKz1kKnYvcCxvW2hdLmRhKz13KnYvcCxvW2hdLmRiKz1tKnYvcCxvW2FdLmRsLT1kKnYvcCxvW2FdLmRhLT13KnYvcCxvW2FdLmRiLT1tKnYvcCk6KG9bYV0uZGwrPTItNCpuKCksb1thXS5kYSs9Mi00Km4oKSxvW2FdLmRiKz0yLTQqbigpKTtmb3IoaD0wO2g8bDtoKyspTT10W2hdLGs9a3QqTWF0aC5zcXJ0KE1hdGgucG93KG9baF0uZGwsMikrTWF0aC5wb3cob1toXS5kYSwyKStNYXRoLnBvdyhvW2hdLmRiLDIpKSxrPjAmJihiPWt0Kk1hdGgubWluKC4xLGspL2ssZj1bTVswXStvW2hdLmRsKmIsTVsxXStvW2hdLmRhKmIsTVsyXStvW2hdLmRiKmJdLEU9dXQoZikscyhFLGYpJiYodFtoXT1mKSl9fWZ1bmN0aW9uIF9lKG4sZSxzLHQpe3ZhciByPVtdLG89W10saSxoLGEsbCxnLHU9NSxwPTEwLGQ9MTA7Zm9yKHQudWx0cmFQcmVjaXNpb24mJih1PTEscD01LGQ9NSksaT0wO2k8PTEwMDtpKz11KWZvcihoPS0xMDA7aDw9MTAwO2grPXApZm9yKGE9LTEwMDthPD0xMDA7YSs9ZClsPVtpLGgsYV0sZz11dChsKSwhIWUoZyxsKSYmKHIucHVzaChsKSxvLnB1c2gobnVsbCkpO2Zvcih2YXIgdz10LnF1YWxpdHksbSx2LGYsTSxiPXIubGVuZ3RoLGs9cy5sZW5ndGgsRSxGLFIsTixJLGM7dy0tID4wOyl7Zm9yKG09MDttPGI7bSsrKWZvcihNPXJbbV0sRj0xLzAsdj0wO3Y8azt2KyspZj1zW3ZdLEU9bihmLE0pLEU8RiYmKEY9RSxvW21dPXYpO2ZvcihSPXIuc2xpY2UoKSx2PTA7djxrO3YrKyl7Zm9yKE49MCxJPVswLDAsMF0sbT0wO208YjttKyspb1ttXT09PXYmJihOKyssSVswXSs9clttXVswXSxJWzFdKz1yW21dWzFdLElbMl0rPXJbbV1bMl0pO2lmKE4hPT0wKWlmKElbMF0vPU4sSVsxXS89TixJWzJdLz1OLGc9dXQoSSksZShnLEkpKXNbdl09STtlbHNle2lmKFIubGVuZ3RoPjApe2ZvcihGPTEvMCxjPS0xLG09MDttPFIubGVuZ3RoO20rKylFPW4oUlttXSxJKSxFPEYmJihGPUUsYz1tKTtzW3ZdPXJbY119ZWxzZXtmb3IoRj0xLzAsYz0tMSxtPTA7bTxyLmxlbmd0aDttKyspRT1uKHJbbV0sSSksRTxGJiYoRj1FLGM9bSk7c1t2XT1yW2NdfVI9Ui5maWx0ZXIoZnVuY3Rpb24oeSl7cmV0dXJuIHlbMF0hPT1zW3ZdWzBdfHx5WzFdIT09c1t2XVsxXXx8eVsyXSE9PXNbdl1bMl19KX19fXJldHVybiBzfXZhciBOdD1mdW5jdGlvbihlLHMpe2lmKHR5cGVvZiBlIT0ibnVtYmVyInx8ZTwyKXRocm93IG5ldyBFcnJvcigiaXdhbnRodWU6IGV4cGVjdGluZyBhIGNvbG9yIGNvdW50ID4gMi4iKTtzPVVlKHMpO2Zvcih2YXIgdD1uZXcgSWUocy5zZWVkKSxyPWZ1bmN0aW9uKCl7cmV0dXJuIHQubmV4dEZsb2F0KCl9LG89bmV3IHFlLGk9by5nZXQocy5kaXN0YW5jZSksaD1mdW5jdGlvbihkLHcpe3JldHVybiBGZShkKT9zLmNvbG9yRmlsdGVyPyEhcy5jb2xvckZpbHRlcihkLHcpOiEwOiExfSxhPXMuYXR0ZW1wdHMsbCxnLHU9LTEvMCxwO2E+MDspbD1WZShyLGUsaCkscy5jbHVzdGVyaW5nPT09ImZvcmNlLXZlY3RvciI/WWUocixpLGgsbCxzKTpfZShpLGgsbCxzKSxnPXN0LmNvbXB1dGVRdWFsaXR5TWV0cmljcyhpLGwpLGcubWluPnUmJih1PWcubWluLHA9bCksYS0tO3JldHVybiBsPXAsbD1DZShpLGwpLGwubWFwKCRlKX07ZnVuY3Rpb24gWGUobil7cmV0dXJuIG49PT0xP1tOdCgyKVswXV06TnQobix7c2VlZDoxfSl9ZnVuY3Rpb24gWmUobil7cmV0dXJuIHR5cGVvZiBuPT0ibnVtYmVyIiYmIWlzTmFOKG4pfWZ1bmN0aW9uIFR0KG4sZT1bXSxzPVtdKXtjb25zdCB0PShnLHUpPT5lLmluY2x1ZGVzKGcpP3U6dm9pZCAwO2xldCByPVtdO2UubGVuZ3RoPjAmJihyPWUubWFwKHQpLmZpbHRlcihaZSkpO2NvbnN0IG89KGcsdSk9PnIuaW5jbHVkZXModSksaT1nPT5wYXJzZUZsb2F0KGcpLGg9Zz0+e2NvbnN0Wyx1XT1nO2xldCBwPXU7cmV0dXJuIGUmJnIubGVuZ3RoPjAmJihwPXUuZmlsdGVyKG8pKSxwLm1hcChpKX07cmV0dXJuIHMubWFwKGc9PltnLG5bZ11dKS5tYXAoaCl9ZnVuY3Rpb24gR2UobixlPVtdLHM9W10pe2NvbnN0IHQ9VHQobixlLHMpO3JldHVybiB0WzBdLm1hcCgobyxpKT0+dC5tYXAoaD0+aFtpXSkpfWNvbnN0IEl0PW49PihNYXRoLnJvdW5kKG4qMWUzKS8xZTMpLnRvRml4ZWQoMyk7ZnVuY3Rpb24gV2UobixlLHMsdCxyLG89ITEpe2NvbnN0IGk9bz9UdChuLGUscyk6R2UobixlLHMpLGg9bmV3IGZ0KGkpLGE9aC5wcmVkaWN0KGkpLGc9KG8/czplKS5yZWR1Y2UoKG0sdixmKT0+e2NvbnN0IE09di5zcGxpdCh0KSxiPW8/djpgJHtNWzBdfSR7dH0ke01bMV19YDtyZXR1cm4gbVtiXT8obVtiXS54LnB1c2goYS5nZXRSb3coZilbMF0pLG1bYl0ueS5wdXNoKGEuZ2V0Um93KGYpWzFdKSxtW2JdLnRleHQucHVzaCh2KSk6bVtiXT17eDpbYS5nZXRSb3coZilbMF1dLHk6W2EuZ2V0Um93KGYpWzFdXSx0eXBlOiJzY2F0dGVyIixtb2RlOiJtYXJrZXJzIixtYXJrZXI6e3NpemU6OX0sbmFtZTpiKyIgICAgICAgIix0ZXh0Olt2XSx0ZXh0Zm9udDp7ZmFtaWx5OiJUaW1lcyBOZXcgUm9tYW4ifSx0ZXh0cG9zaXRpb246ImJvdHRvbSBjZW50ZXIifSxtfSx7fSksdT1YZShPYmplY3Qua2V5cyhnKS5sZW5ndGgpLHA9T2JqZWN0LnZhbHVlcyhnKSxkPWguZ2V0RXhwbGFpbmVkVmFyaWFuY2UoKSx3PXt0aXRsZTp7dGV4dDpyLGZvbnQ6e3NpemU6MjB9fSx4YXhpczp7dGl0bGU6e3RleHQ6YFBDLTEgKGZyYWN0aW9uIG9mIHZhcmlhbmNlIGV4cGxhaW5lZDogfiR7SXQoZFswXSl9KWB9fSx5YXhpczp7dGl0bGU6e3RleHQ6YFBDLTIgKGZyYWN0aW9uIG9mIHZhcmlhbmNlIGV4cGxhaW5lZDogfiR7SXQoZFsxXSl9KWB9fSxzaG93bGVnZW5kOiEwLGF1dG9zaXplOiEwLGhvdmVybW9kZToiY2xvc2VzdCIsY29sb3J3YXk6dX07cmV0dXJue2RhdGE6cCxsYXlvdXQ6d319b25tZXNzYWdlPWZ1bmN0aW9uKG4pe2NvbnN0e2RhdGFSb3dzOmUsc3JjUmVwbGljYXRlTmFtZXM6cyxzcmNBY2Nlc3Npb25JZHM6dCxtdWx0aUhlYWRlclNlcDpyLHRyYW5zcG9zZTpvLHBsb3RUaXRsZTppfT1uLmRhdGEsaD1XZShlLHMsdCxyLGksbyk7cG9zdE1lc3NhZ2UoaCx2b2lkIDApfX0pKCk7fSkoKTsK",Qt=typeof window!="undefined"&&window.Blob&&new Blob([atob(kt)],{type:"text/javascript;charset=utf-8"});function Rd(){const l=Qt&&(window.URL||window.webkitURL).createObjectURL(Qt);try{return l?new Worker(l):new Worker("data:application/javascript;base64,"+kt,{type:"module"})}finally{l&&(window.URL||window.webkitURL).revokeObjectURL(l)}}const Md=(l,t)=>{const c=[];return l.forEach(d=>{const a=I.getRowAsTree(d),o=[[],[]],n=[],b=[];h.groupOrder.forEach(s=>{h.sampleOrder.forEach(i=>{const m=a[s][i];m&&(o[0].push(s),o[1].push(i),n.push(tl(m)),b.push(pl(m)))})}),c.push({x:o,y:n,error_y:{type:"data",array:b,visible:!0},type:"bar",name:d,showlegend:t.showlegend})}),c};function Td(l){l.setAttribute("xlink","http://www.w3.org/1999/xlink");const t=Yd(l),c=document.createElement("style");c.setAttribute("type","text/css"),c.innerHTML=t;const d=l.hasChildNodes()?l.children[0]:null;l.insertBefore(c,d);let o=new XMLSerializer().serializeToString(l);return o=o.replace(/(\w+)?:?xlink=/g,"xmlns:xlink="),o=o.replace(/NS\d+:href/g,"xlink:href"),o}function Yd(l){const t=[];t.push("#"+l.id);for(let a=0;a<l.classList.length;a++)Jl("."+l.classList[a],t)||t.push("."+l.classList[a]);const c=l.getElementsByTagName("*");for(let a=0;a<c.length;a++){const o=c[a].id;Jl("#"+o,t)||t.push("#"+o);const n=c[a].classList;for(let b=0;b<n.length;b++)Jl("."+n[b],t)||t.push("."+n[b])}let d="";for(let a=0;a<document.styleSheets.length;a++){const o=document.styleSheets[a];try{if(!o.cssRules)continue}catch(b){if(b.name!=="SecurityError")throw b;continue}const n=o.cssRules;for(let b=0;b<n.length;b++){const s=n[b];Jl(s.selectorText,t)&&(d+=n[b].cssText)}}return d}function Jl(l,t){return t.indexOf(l)!==-1}const ml=a=>{var o=a,{status:l,figureRef:t,plotType:c}=o,d=D(o,["status","figureRef","plotType"]);const n=()=>{var p;const s=(p=t==null?void 0:t.current)==null?void 0:p.getElementsByClassName("main-svg")[0],i=s?Td(s):"",m=new Blob([i],{type:"image/svg+xml"});ql.exports.saveAs(m,"plot.svg")},b=()=>{J.deletePlot(d.id)};return e.createElement(x,L({_focus:{outline:"none",border:"1px solid",borderColor:"orange.600"},as:"figure",alignItems:"center",backgroundColor:"white",border:"1px solid",borderColor:"transparent",boxShadow:"sm",flexDirection:"column",justifyContent:"center",margin:3,overflow:"hidden",height:800,padding:6,position:"relative",ref:s=>t?t.current=s:s,resize:"horizontal",role:"group",tabIndex:0,width:"100%"},d),l==="idle"?e.createElement(e.Fragment,null,(c==="heatmap"||c==="image")&&e.createElement(g,{_focusWithin:{"& button":{visibility:"visible"}},"aria-label":"Plot actions",as:"section",left:5,position:"absolute",top:5},c==="heatmap"&&e.createElement(Ze,{_focus:{border:"1px solid",borderColor:"orange.600",color:"orange.600",outline:"none",visibility:"visible"},_groupFocus:{visibility:"visible"},_groupHover:{visibility:"visible"},_hover:{color:"orange.600"},"aria-label":"Download plot",color:"gray.600",icon:e.createElement(Xt,null),variant:"outline",size:"lg",onClick:n,visibility:"hidden",zIndex:"modal"}),e.createElement(Ze,{_focus:{border:"1px solid",borderColor:"orange.600",color:"orange.600",outline:"none",visibility:"visible"},_groupFocus:{visibility:"visible"},_groupHover:{visibility:"visible"},_hover:{color:"orange.600"},"aria-label":"Delete plot",color:"gray.600",icon:e.createElement(Rl,null),marginLeft:2,size:"lg",variant:"outline",onClick:b,visibility:"hidden",zIndex:"overlay"})),d.children):e.createElement(sl,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}))},Pl=["#c7566f","#57bf67","#845ec9","#90b83d","#d3a333","#c363ab","#4a7c38","#adab63","#698ccc","#c94f32","#826627","#52b8a4","#d88e61"],Bt=Ye.exports.createContext({hoveredGene:""}),Jd=l=>{const[t,c]=e.useState(""),d=e.useRef(null),a=e.useRef(null),o=e.useRef(),[n,b]=e.useState({title:{text:l.options.plotTitle,font:{size:20},y:.9},showlegend:l.options.showlegend,legend:{orientation:"h",x:0,y:-.3},yaxis:{title:{text:`count [${h.unit}]`},hoverformat:".2f"},autosize:!0,colorway:Pl}),s={toImageButtonOptions:{format:"svg",filename:"plot"},displaylogo:!1,modeBarButtonsToRemove:["zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","hoverClosestGl2d","hoverClosestPie","toggleHover","resetViews","sendDataToCloud","toggleSpikelines"],modeBarButtonsToAdd:[{title:"Delete plot",name:"Delete plot",icon:{width:21,height:21,path:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},click:()=>{J.deletePlot(l.id)}}]};e.useEffect(function(){let K;const r=a.current,y=new ResizeObserver(C=>{clearTimeout(o.current),K=window.setTimeout(()=>{b(G=>E(L({},G),{width:C[0].target.clientWidth}))},250),o.current=K});return r&&y.observe(r),()=>{r&&y.unobserve(r),K&&clearTimeout(K)}},[]);const i=p=>{var y;const{points:K}=p;if(K.length!==1||((y=l.accessions)==null?void 0:y.length)<=1)return;const r=K[0].data.name;c(r)},m=()=>{c("")};return e.createElement(Bt.Provider,{value:{hoveredGene:t}},e.createElement(ml,{status:"idle",figureRef:a,id:l.id},e.createElement(Kt,{ref:p=>d.current=p,data:l.data,layout:n,config:s,onHover:i,onUnhover:m,style:{width:"100%",height:"100%"}}),e.createElement(g,{marginX:"12",width:"full",overflow:"auto",flexShrink:1.3},l.children)))};var Pd=Xl(Jd);const kd=(l,t)=>{const c=[];return l.forEach((d,a)=>{const o=I.getRowAsTree(d),n={color:Pl[a]};h.groupOrder.forEach((b,s)=>{const i=[[],[]],m=[],p=[];h.sampleOrder.forEach(K=>{const r=o[b][K];r&&(i[0].push(b),i[1].push(K),m.push(tl(r)),p.push(pl(r)))}),c.push({x:i,y:m,error_y:{type:"data",array:p,visible:!0},name:d,type:"scatter",showlegend:s>0?!1:t.showlegend,line:n})})}),c},Qd=(l,t)=>{const c=I.getRowAsTree(l),d=[];return h.groupOrder.forEach(a=>{const o=[[],[]],n=[],b=[];h.sampleOrder.forEach(s=>{const i=c[a][s];i&&(o[0].push(a),o[1].push(s),n.push(tl(i)),b.push(pl(i)))}),d.push({x:o,y:n,error_y:{type:"data",array:b,visible:!0},type:"scatter",name:a,showlegend:t.showlegend})}),d},Bd=(l,t)=>{const c=I.getRowAsTree(l),d=[];return h.groupOrder.forEach(a=>{const o=[[],[]],n=[],b=[];h.sampleOrder.forEach(s=>{const i=c[a][s];i&&(o[0].push(a),o[1].push(s),n.push(tl(i)),b.push(pl(i)))}),d.push({x:o,y:n,error_y:{type:"data",array:b,visible:!0},type:"bar",name:a,showlegend:t.showlegend})}),d},Nd=["solid","dot","dash","longdash","dashdot","longdashdot"],wd=["circle","square","diamond","cross","triangle-up","pentagon"],fd=(l,t)=>{const c=[];let d=0,a=0;return l.forEach(o=>{const n=I.getRowAsTree(o);h.groupOrder.forEach(b=>{const s=[],i=[],m=[];t.colorBy==="group"?d++:a++,h.sampleOrder.forEach(p=>{const K=n[b][p];K&&(s.push(p),i.push(tl(K)),m.push(pl(K)))}),c.push({x:s,y:i,error_y:{type:"data",array:m,visible:!0},name:l.length>1?`${b} - ${o}`:b,type:"scatter",showlegend:t.showlegend,line:l.length>1?{color:Pl[d],dash:Nd[a]}:{},marker:l.length>1?{symbol:wd[a]}:{}})}),t.colorBy==="group"?(d=0,a++):(d++,a=0)}),c};async function Nt(l){const t=new DOMParser,d=await(await fetch(l)).text();return t.parseFromString(d,"application/xml")}function Fd(l){var d,a;const t=(d=l.attributes.getNamedItem("x"))==null?void 0:d.nodeValue,c=(a=l.attributes.getNamedItem("y"))==null?void 0:a.nodeValue;if(!t||!c)throw new Error("Missing coordinates in DataArea");return{x:parseInt(t),y:parseInt(c)}}function Ud(l){var d,a;const t=[],c=l.getElementsByTagName("Identifier");for(let o=0;o<c.length;o++){const n=(d=c[o].attributes.getNamedItem("id"))==null?void 0:d.nodeValue,b=(a=c[o].attributes.getNamedItem("recursive"))==null?void 0:a.nodeValue;if(!n||!b)throw new Error("Missing attribues in Identifier");t.push({id:n,recursive:JSON.parse(b)})}return t}function Ed(l){var a;const t=(a=l.attributes.getNamedItem("blockFormat"))==null?void 0:a.nodeValue,c=t==null?void 0:t.substr(0,1),d=t==null?void 0:t.substr(1);if(c&&c!=="x"&&c!=="y")throw new Error(`unallowed blockFormat type ${c}`);return c&&c==="x"&&d?{bformat:"x",fnumber:parseInt(d)}:c&&c==="y"&&d?{bformat:"y",fnumber:parseInt(d)}:{bformat:"x",fnumber:5}}async function Od(l,t,c,d,a){var le,q,te,he,Le,Ie,Ge,ze,ue,se,He,H;const o=5,[n,b]=a?a.split(I.config.multiHeader):[void 0,void 0],s=d==="expressionValue"&&n&&b?I.getMapManMeanValues(n,b):v.getColumn(d),i=await Nt(`mapman-templates/${l}.xml`),m=await Nt(`mapman-templates/${l}.svg`),p=parseInt((te=(q=(le=m.firstElementChild)==null?void 0:le.attributes.getNamedItem("width"))==null?void 0:q.nodeValue)!=null?te:"1024"),K=parseInt((Ie=(Le=(he=m.firstElementChild)==null?void 0:he.attributes.getNamedItem("height"))==null?void 0:Le.nodeValue)!=null?Ie:"800"),r=i.querySelectorAll("DataArea"),y=[],C=[],G=[];r.forEach(w=>{const{x:f,y:V}=Fd(w),{bformat:P,fnumber:O}=Ed(w),Z=Ud(w),z={},F=v.getGenesForMapManBin(t,c,Z[0].id,Z[0].recursive);let B=0,R=0;F.forEach(ce=>{const U=parseFloat(s[ce]);C.push(U),z[ce]=U;const We=P==="x"?f+B%O*o:f+B*o,ie=P==="y"?V+R%O*o:V+R*o;G.push({geneId:ce,bin:Z[0].id,value:U,x:We,y:ie,xOffset:P==="x"?B%O:B,yOffset:P==="y"?R%O:R}),P==="x"?B++:R++,P==="x"&&B!=0&&B%O==0?R++:P==="y"&&R!=0&&R%O==0&&B++}),y.push({bincode:Z[0].id,x:f,y:V,bformat:P,fnumber:O,geneValues:z})});const Q=(Ge=sc(C))!=null?Ge:0,W=(ze=ht(C,.25))!=null?ze:0,M=(ue=ic(C))!=null?ue:0,Y=(se=tl(C))!=null?se:0,Xe=(He=ht(C,.75))!=null?He:0,Ke=(H=mc(C))!=null?H:0;return{rects:G,stats:{min:Q,q1:W,median:M,mean:Y,q3:Xe,max:Ke},width:p,height:K}}class Dd{constructor(){Te(this,"plots",[]);Te(this,"_image",null);Te(this,"countUnit",null);vl(this)}loadCountUnit(t){this.countUnit=t}get hasPlots(){return this.plots.length>0}clearPlots(){this.plots=[]}deletePlot(t){const c=this.plots.findIndex(d=>d.id===t);if(c>-1){const d=this.plots[c];if(d.type==="image"){const a=d;URL.revokeObjectURL(a.src)}this.plots.splice(c,1)}}toJSObject(t){const c=this.plots.find(a=>a.id===t);if(c){const d=c,{id:a,isLoading:o}=d;return D(d,["id","isLoading"])}}plotNamesForExport(){return this.plots.length>0?this.plots.map(t=>`plots/${t.id}_${t.type}.json`):void 0}addRawPlot(t){this.plots.push(t)}addHeatmapPlot({plotTitle:t,accessions:c,distanceMethod:d,replicates:a,clusterBy:o}){const n=me(),b=o!=="replicates",s={id:n,type:"heatmap",isLoading:!0},i=this.plots.push(s)-1,m=new vd,p={dataRows:$l(I.rows),distanceMethod:d,srcReplicateNames:(a==null?void 0:a.length)?a:I.colNames,srcAccessionIds:(c==null?void 0:c.length)?c:I.rowNames,transpose:b};m.postMessage(p),m.onmessage=function(K){Ml(()=>{const r=E(L({},J.plots[i]),{isLoading:!1,binData:K.data.bins,tree:K.data.tree,distanceMethod:d,plotTitle:t});J.plots[i].id===n&&(J.plots[i]=r)})}}addImagePlot(t,c){const d={alt:c,id:me(),isLoading:!1,type:"image",src:t};this.plots.push(d)}addPCAPlot({plotTitle:t,accessions:c,replicates:d,calculateFor:a}){const o=me(),n=a!=="replicates",b={id:o,type:"pca",isLoading:!0},s=this.plots.push(b)-1,i=new Rd,m={dataRows:$l(I.rows),srcReplicateNames:(d==null?void 0:d.length)?d:I.colNames,srcAccessionIds:(c==null?void 0:c.length)?c:I.rowNames,multiHeaderSep:I.config.multiHeader,transpose:n,plotTitle:t};i.postMessage(m),i.onmessage=function(p){Ml(()=>{const K=E(L(L({},J.plots[s]),p.data),{isLoading:!1});J.plots[s].id===o&&(J.plots[s]=K)})}}addSingleGeneBarPlot(t,c){const d=Bd(t[0],c),a={id:me(),type:"plotly",isLoading:!1,accessions:t,data:d,options:c};this.plots.push(a)}addMultiGeneBarPlot(t,c){const d=Md(t,c),a={id:me(),type:"plotly",isLoading:!1,accessions:t,data:d,options:c};this.plots.push(a)}addSingleGeneIndividualLinesPlot(t,c){const d=Qd(t[0],c),a={id:me(),type:"plotly",isLoading:!1,accessions:t,data:d,options:c};this.plots.push(a)}addMultiGeneIndividualLinesPlot(t,c){const d=kd(t,c),a={id:me(),type:"plotly",isLoading:!1,accessions:t,data:d,options:c};this.plots.push(a)}addStackedLinesPlot(t,c){const d=fd(t,c),a={id:me(),type:"plotly",isLoading:!1,accessions:t,data:d,options:c};this.plots.push(a)}async addMapManPlot(t){const{template:c,infoTableColumn:d,infoTableColumnSep:a,valuesFrom:o,sample:n}=t,b=me(),s={id:b,type:"mapman",isLoading:!0},i=this.plots.push(s)-1;Od(c,d,a,o,n).then(m=>{Ml(()=>{const p=L(E(L({},J.plots[i]),{isLoading:!1,rects:m.rects,stats:m.stats,width:m.width,height:m.height}),t);J.plots[i].id===b&&(J.plots[i]=p)})})}}const J=new Dd;async function Fe(l,t,c){const d=await fetch(l,c);if(!d||!d.ok)throw new Error(`Fetching resource "${l}" failed with status "${d.status}: ${d.statusText}"`);switch(t){case"blob":return await d.blob();case"json":return await d.json();case"text":return await d.text();case"url":return d.url;default:throw new Error(`Unsupported read method for ${l}`)}}function Ae(l,t){const c=l.split(/\r?\n|\r/),a=c.splice(0,1)[0].split(t.fieldSeparator).reduce((n,b,s)=>(s===t.rowNameColumn||n.push(b),n),[]),o=c.reduce((n,b)=>{if(!b)return n;const s=b.split(t.fieldSeparator),i=s.splice(t.rowNameColumn,1)[0];return Object.assign(n,{[i]:s})},{});return{header:a,rows:o}}function wt(l,t){const c=l.split(/\r?\n|\r/);return c.splice(0,1)[0],c.reduce((d,a)=>{if(!a)return d;const o=a.split(t);return d.push(o),d},[])}var jd=function(){return function(l){l=l||{};var l=typeof l!="undefined"?l:{},t,c;l.ready=new Promise(function(u,X){t=u,c=X});var d={},a;for(a in l)l.hasOwnProperty(a)&&(d[a]=l[a]);var o=!0,n="",b;typeof document!="undefined"&&document.currentScript&&(n=document.currentScript.src),n.indexOf("blob:")!==0?n=n.substr(0,n.lastIndexOf("/")+1):n="";var s=l.print||console.log.bind(console),i=l.printErr||console.warn.bind(console);for(a in d)d.hasOwnProperty(a)&&(l[a]=d[a]);d=null,l.arguments,l.thisProgram,l.quit;var m;l.wasmBinary&&(m=l.wasmBinary),l.noExitRuntime,typeof WebAssembly!="object"&&z("no native wasm support detected");var p,K=!1;function r(u,X){u||z("Assertion failed: "+X)}function y(u){var X=l["_"+u];return r(X,"Cannot call unknown function "+u+", make sure it is exported"),X}function C(u,X,S,oe,ne){var A={string:function(ve){var nl=0;if(ve!=null&&ve!==0){var yt=(ve.length<<2)+1;nl=Bl(yt),Xe(ve,nl,yt)}return nl},array:function(ve){var nl=Bl(ve.length);return Ke(ve,nl),nl}};function N(ve){return X==="string"?M(ve):X==="boolean"?Boolean(ve):ve}var k=y(u),de=[],$e=0;if(oe)for(var el=0;el<oe.length;el++){var mt=A[S[el]];mt?($e===0&&($e=rl()),de[el]=mt(oe[el])):de[el]=oe[el]}var wl=k.apply(null,de);return wl=N(wl),$e!==0&&it($e),wl}function G(u,X,S,oe){S=S||[];var ne=S.every(function(N){return N==="number"}),A=X!=="string";return A&&ne&&!oe?y(u):function(){return C(u,X,S,arguments)}}var Q=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function W(u,X,S){for(var oe=X+S,ne=X;u[ne]&&!(ne>=oe);)++ne;if(ne-X>16&&u.subarray&&Q)return Q.decode(u.subarray(X,ne));for(var A="";X<ne;){var N=u[X++];if(!(N&128)){A+=String.fromCharCode(N);continue}var k=u[X++]&63;if((N&224)==192){A+=String.fromCharCode((N&31)<<6|k);continue}var de=u[X++]&63;if((N&240)==224?N=(N&15)<<12|k<<6|de:N=(N&7)<<18|k<<12|de<<6|u[X++]&63,N<65536)A+=String.fromCharCode(N);else{var $e=N-65536;A+=String.fromCharCode(55296|$e>>10,56320|$e&1023)}}return A}function M(u,X){return u?W(q,u,X):""}function Y(u,X,S,oe){if(!(oe>0))return 0;for(var ne=S,A=S+oe-1,N=0;N<u.length;++N){var k=u.charCodeAt(N);if(k>=55296&&k<=57343){var de=u.charCodeAt(++N);k=65536+((k&1023)<<10)|de&1023}if(k<=127){if(S>=A)break;X[S++]=k}else if(k<=2047){if(S+1>=A)break;X[S++]=192|k>>6,X[S++]=128|k&63}else if(k<=65535){if(S+2>=A)break;X[S++]=224|k>>12,X[S++]=128|k>>6&63,X[S++]=128|k&63}else{if(S+3>=A)break;X[S++]=240|k>>18,X[S++]=128|k>>12&63,X[S++]=128|k>>6&63,X[S++]=128|k&63}}return X[S]=0,S-ne}function Xe(u,X,S){return Y(u,q,X,S)}typeof TextDecoder!="undefined"&&new TextDecoder("utf-16le");function Ke(u,X){le.set(u,X)}var le,q,te;function he(u){l.HEAP8=le=new Int8Array(u),l.HEAP16=new Int16Array(u),l.HEAP32=te=new Int32Array(u),l.HEAPU8=q=new Uint8Array(u),l.HEAPU16=new Uint16Array(u),l.HEAPU32=new Uint32Array(u),l.HEAPF32=new Float32Array(u),l.HEAPF64=new Float64Array(u)}l.INITIAL_MEMORY;var Le,Ie=[],Ge=[],ze=[];function ue(){if(l.preRun)for(typeof l.preRun=="function"&&(l.preRun=[l.preRun]);l.preRun.length;)H(l.preRun.shift());ie(Ie)}function se(){ie(Ge)}function He(){if(l.postRun)for(typeof l.postRun=="function"&&(l.postRun=[l.postRun]);l.postRun.length;)f(l.postRun.shift());ie(ze)}function H(u){Ie.unshift(u)}function w(u){Ge.unshift(u)}function f(u){ze.unshift(u)}var V=0,P=null;function O(u){V++,l.monitorRunDependencies&&l.monitorRunDependencies(V)}function Z(u){if(V--,l.monitorRunDependencies&&l.monitorRunDependencies(V),V==0&&P){var X=P;P=null,X()}}l.preloadedImages={},l.preloadedAudios={};function z(u){l.onAbort&&l.onAbort(u),u+="",i(u),K=!0,u="abort("+u+"). Build with -s ASSERTIONS=1 for more info.";var X=new WebAssembly.RuntimeError(u);throw c(X),X}var F="data:application/octet-stream;base64,";function B(u){return u.startsWith(F)}var R,R;R="/GeneExpressionPlots/gsl.wasm";function ce(u){try{if(u==R&&m)return new Uint8Array(m);if(!b)throw"both async and sync fetching of the wasm failed"}catch(X){z(X)}}function U(){return!m&&o&&typeof fetch=="function"?fetch(R,{credentials:"same-origin"}).then(function(u){if(!u.ok)throw"failed to load wasm binary file at '"+R+"'";return u.arrayBuffer()}).catch(function(){return ce(R)}):Promise.resolve().then(function(){return ce(R)})}function We(){var u={env:Hl,wasi_snapshot_preview1:Hl};function X(N,k){var de=N.exports;l.asm=de,p=l.asm.memory,he(p.buffer),Le=l.asm.__indirect_function_table,w(l.asm.__wasm_call_ctors),Z()}O();function S(N){X(N.instance)}function oe(N){return U().then(function(k){var de=WebAssembly.instantiate(k,u);return de}).then(N,function(k){i("failed to asynchronously prepare wasm: "+k),z(k)})}function ne(){return!m&&typeof WebAssembly.instantiateStreaming=="function"&&!B(R)&&typeof fetch=="function"?fetch(R,{credentials:"same-origin"}).then(function(N){var k=WebAssembly.instantiateStreaming(N,u);return k.then(S,function(de){return i("wasm streaming compile failed: "+de),i("falling back to ArrayBuffer instantiation"),oe(S)})}):oe(S)}if(l.instantiateWasm)try{var A=l.instantiateWasm(u,X);return A}catch(N){return i("Module.instantiateWasm callback failed with error: "+N),!1}return ne().catch(c),{}}function ie(u){for(;u.length>0;){var X=u.shift();if(typeof X=="function"){X(l);continue}var S=X.func;typeof S=="number"?X.arg===void 0?Le.get(S)():Le.get(S)(X.arg):S(X.arg===void 0?null:X.arg)}}function Se(){z()}function ke(u,X,S){q.copyWithin(u,X,X+S)}var qe={mappings:{},buffers:[null,[],[]],printChar:function(u,X){var S=qe.buffers[u];X===0||X===10?((u===1?s:i)(W(S,0)),S.length=0):S.push(X)},varargs:void 0,get:function(){qe.varargs+=4;var u=te[qe.varargs-4>>2];return u},getStr:function(u){var X=M(u);return X},get64:function(u,X){return u}};function Gl(u){return 0}function ul(u,X,S,oe,ne){}function st(u,X,S,oe){for(var ne=0,A=0;A<S;A++){for(var N=te[X+A*8>>2],k=te[X+(A*8+4)>>2],de=0;de<k;de++)qe.printChar(u,q[N+de]);ne+=k}return te[oe>>2]=ne,0}function Ql(u){}var Hl={abort:Se,emscripten_memcpy_big:ke,fd_close:Gl,fd_seek:ul,fd_write:st,setTempRet0:Ql};We(),l.___wasm_call_ctors=function(){return(l.___wasm_call_ctors=l.asm.__wasm_call_ctors).apply(null,arguments)},l._gsl_ran_hypergeometric_pdf=function(){return(l._gsl_ran_hypergeometric_pdf=l.asm.gsl_ran_hypergeometric_pdf).apply(null,arguments)},l.___errno_location=function(){return(l.___errno_location=l.asm.__errno_location).apply(null,arguments)};var rl=l.stackSave=function(){return(rl=l.stackSave=l.asm.stackSave).apply(null,arguments)},it=l.stackRestore=function(){return(it=l.stackRestore=l.asm.stackRestore).apply(null,arguments)},Bl=l.stackAlloc=function(){return(Bl=l.stackAlloc=l.asm.stackAlloc).apply(null,arguments)};l.dynCall_jiji=function(){return(l.dynCall_jiji=l.asm.dynCall_jiji).apply(null,arguments)},l.ccall=C,l.cwrap=G;var Cl;P=function u(){Cl||Nl(),Cl||(P=u)};function Nl(u){if(V>0||(ue(),V>0))return;function X(){Cl||(Cl=!0,l.calledRun=!0,!K&&(se(),t(l),l.onRuntimeInitialized&&l.onRuntimeInitialized(),He()))}l.setStatus?(l.setStatus("Running..."),setTimeout(function(){setTimeout(function(){l.setStatus("")},1),X()},1)):X()}if(l.run=Nl,l.preInit)for(typeof l.preInit=="function"&&(l.preInit=[l.preInit]);l.preInit.length>0;)l.preInit.pop()();return Nl(),l.ready}}();jd();function Ad(l,t){switch(l){case"<":return c=>Object.entries(c).filter(d=>parseFloat(d[1])<parseFloat(t)).map(d=>d[0]);case">":return c=>Object.entries(c).filter(d=>parseFloat(d[1])>parseFloat(t)).map(d=>d[0]);case"<=":return c=>Object.entries(c).filter(d=>parseFloat(d[1])<=parseFloat(t)).map(d=>d[0]);case">=":return c=>Object.entries(c).filter(d=>parseFloat(d[1])>=parseFloat(t)).map(d=>d[0]);case"==":return c=>Object.entries(c).filter(d=>d[1]==t).map(d=>d[0]);case"regexp":return c=>Object.entries(c).filter(d=>{const a=new RegExp(t);return!!d[1].match(a)}).map(d=>d[0]);default:throw new Error(`unsupported selector ${l}`)}}function _d(){return new Worker("/GeneExpressionPlots/assets/enrichment.cc6e84b3.js",{type:"module"})}class qd{constructor(){Te(this,"analyses",[]);vl(this)}getAnalysisById(t){return this.analyses.find(c=>c.id===t)}clearAnalyses(){this.analyses=[]}deleteAnalysis(t){const c=this.analyses.findIndex(d=>d.id===t);c>-1&&this.analyses.splice(c,1)}addRawEnrichmentAnalysis(t){this.analyses.push(t)}metadataToJSON(){return this.analyses.length>0?this.analyses.map(t=>{const{options:c}=t;return E(L({},c),{rawData:`enrichment_analyses/${c.title.replace(/\s+/g,"_")}.txt`})}):void 0}dataToCSV(t,c){var o;const d=`Test Entry${c}p_Value${c}adjusted p_Value
`,a=(o=t.data)==null?void 0:o.map(n=>n.join(c));return d+(a==null?void 0:a.join(`
`))}addEnrichmentAnalysis(t){if(this.analyses.findIndex(i=>i.options.title===t.title)!=-1)throw new Error(`Analysis with title ${t.title} already exists. Please select a unique name.`);const c=me(),d={id:c,isLoading:!0,options:t},a=this.analyses.push(d)-1;let o=new Set,n=new Set;if(t.filterGeneIds)o=new Set(t.filterGeneIds);else if(t.TEFselector&&t.TEFselectorValue){const i=Ad(t.TEFselector,t.TEFselectorValue),m=v.getColumn(t.TEFcolumn);o=new Set(i(m))}n=new Set(Object.keys(v.rows).filter(i=>!o.has(i)));const b=v.getColumn(t.TEIcolumn),s=new _d;s.postMessage({geneIdsTEFpos:o,geneIdsTEFneg:n,TEIpayload:b,options:t}),s.onmessage=function(i){Ml(()=>{const m=E(L({},ye.analyses[a]),{isLoading:!1,data:i.data});ye.analyses[a].id===c&&(ye.analyses[a]=m)})}}}const ye=new qd;function ft(l){const t=l.split("	");return t[0]==="BINCODE"&&t[1]==="NAME"&&t[2]==="IDENTIFIER"&&t[3]==="DESCRIPTION"&&t[4]==="TYPE"}function $d(l,t,c){if(l)if(Array.isArray(v.rows[l])||(v.rows[l]=[]),v.rows[l].length<=c)v.rows[l].push(...t);else for(let d=c;d<t.length+c;d++)v.rows[l][d]+=`,${t[d-c]}`}function Ft(l,t){const c=l.split(`
`).map(function(b){return b.split("	")}),d=v.header.length,a=1+(t.addName?1:0)+(t.addDescription?1:0),o={};v.hasData?v.rowNames.forEach((b,s)=>{o[b.toLowerCase()]=s}):I.rowNames.forEach((b,s)=>{o[b.toLowerCase()]=s});const n=v.rowNames.slice();v.addMercatorHeaderAndPrepareColumns(t.addName,t.addDescription),c.forEach((b,s)=>{if(s!==0&&b[0].length!==0&&b[2].length!==0){const i=b[0].replace(/[']+/g,""),m=b[1].replace(/[']+/g,""),p=b[2].replace(/[']+/g,""),K=b[3].replace(/[']+/g,"");if(p.length!==0){const r=[i],y=o[p],C=n[y];(t==null?void 0:t.addName)&&r.push(m),(t==null?void 0:t.addDescription)&&r.push(K),$d(C,r,d)}}}),v.hasData?v.rowNames.forEach(b=>{if(v.rows[b].length<v.header.length){const s=v.header.length-v.rows[b].length;v.rows[b].push(...Array(s).fill(""))}}):I.rowNames.forEach(b=>{v.rows[b]||(v.rows[b]=Array(a).fill(""))})}const Ut=l=>{const t=c=>{if(!c)return"A file input is required"};return e.createElement(xe,{initialValues:{addName:!1,addDescription:!1},validateOnBlur:!1,onSubmit:l.onSubmit},c=>e.createElement(g,{as:ge},e.createElement(Ll,{name:"file",label:"Tabular File",validate:t,isRequired:!0}),e.createElement(Pe,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"add-name",name:"addName",label:"add Mercator Name column"}),e.createElement(Pe,{controlProps:{marginTop:"1rem"},color:"orange.600",id:"add-description",name:"addDescription",label:"add Mercator Description column"}),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},ea=()=>{const l=bl({base:"100%",lg:"45%",xl:"30%"}),[t,c]=e.useState([]),d=Tl(),a=H=>{I.removeColumns(H)},o=(H,w)=>{c(w?[...t,H]:t.filter(f=>f!==H))},n=e.useRef(null),{isOpen:b,onOpen:s,onClose:i}=be(),m=(H,w)=>{J.loadCountUnit(fe(H.countUnit)),h.loadgxpSettings({unit:H.countUnit,expression_field_sep:fe(H.columnSep),expression_header_sep:fe(H.headerSep)});const f=H.file;if(f)try{const V=new FileReader;V.onload=()=>{const P=Ae(V.result,{fieldSeparator:fe(H.columnSep),rowNameColumn:0});I.loadFromObject(P,{multiHeader:H.headerSep}),h.setGroupOrder(I.groupsAsArray),h.setSampleOrder(I.samplesAsArray)},V.onloadend=()=>{w.setSubmitting(!1),i()},V.onerror=()=>{w.setSubmitting(!1),console.error("There was an error while reading the file")},V.readAsText(f)}catch(V){w.setSubmitting(!1),console.error(V)}},p=e.useRef(null),{isOpen:K,onOpen:r,onClose:y}=be(),C=(H,w)=>{const f=H.file;if(f)try{h.loadgxpSettings({info_field_sep:fe(H.columnSep)});const V=new FileReader;V.onload=()=>{const P=Ae(V.result,{fieldSeparator:fe(H.columnSep),rowNameColumn:0});v.loadFromObject(P)},V.onloadend=()=>{w.setSubmitting(!1),y()},V.onerror=()=>{w.setSubmitting(!1),console.error("There was an error while reading the file")},V.readAsText(f)}catch{w.setSubmitting(!1),console.error("There was an error while reading the file")}},G=e.useRef(null),{isOpen:Q,onOpen:W,onClose:M}=be(),Y=(H,w)=>{const f=H.file;if(f)try{const V=new FileReader;V.onload=()=>{const P=V.result.split(`
`,1)[0];if(ft(P))Ft(V.result,{addDescription:H.addDescription,addName:H.addName}),d({title:"Successfully imported Mercator table",status:"success",description:"The provided Mercator tabular output was successfully imported into the application.",isClosable:!0});else{d({title:"Error",status:"error",description:"Invalid Mercator Input.",isClosable:!0});return}},V.onloadend=()=>{w.setSubmitting(!1),M()},V.onerror=()=>{w.setSubmitting(!1),console.error("There was an error while reading the file")},V.readAsText(f)}catch(V){w.setSubmitting(!1),console.error(V)}},Xe=e.useRef(null),{isOpen:Ke,onOpen:le,onClose:q}=be(),te=async(H,w)=>{var V;const f=H.file;if(f)try{const P=new _l,O=await P.loadAsync(f),z=await O.files["GXP_settings.json"].async("string"),F=JSON.parse(z);h.loadgxpSettings(F);const R=await O.files["expression_table.txt"].async("string"),ce=Ae(R,{fieldSeparator:h.gxpSettings.expression_field_sep,rowNameColumn:0});if(I.loadFromObject(ce,{multiHeader:h.gxpSettings.expression_header_sep}),!h.gxpSettings.groupOrder||h.gxpSettings.groupOrder.length===0){const Se=I.groupsAsArray;h.setGroupOrder(Se)}if(!h.gxpSettings.sampleOrder||h.gxpSettings.sampleOrder.length===0){const Se=I.samplesAsArray;h.setSampleOrder(Se)}const U=O.files["info_table.txt"];if(U){const Se=await U.async("string"),ke=Ae(Se,{fieldSeparator:h.gxpSettings.info_field_sep,rowNameColumn:0});v.loadFromObject(ke)}const We=O.files["image.png"];if(We){const Se=await We.async("blob"),ke=URL.createObjectURL(Se);J.addImagePlot(ke,"Database Image")}const ie=O.files["enrichment_analyses.json"];if(ie){const Se=await ie.async("string"),ke=JSON.parse(Se);await Promise.all(ke.map(async qe=>{const rl=qe,{rawData:Gl}=rl,ul=D(rl,["rawData"]),Ql=await O.files[Gl].async("string"),Hl=wt(Ql,h.gxpSettings.expression_field_sep);ye.addRawEnrichmentAnalysis({id:me(),isLoading:!1,options:ul,data:Hl})}))}(V=P.folder("plots"))==null||V.forEach(async(Se,ke)=>{const Gl=await O.files[ke.name].async("string"),ul=JSON.parse(Gl);J.addRawPlot(L({id:me(),isLoading:!1},ul))}),w.setSubmitting(!1),q()}catch(P){w.setSubmitting(!1),console.error(P)}},he=e.useRef(null),{isOpen:Le,onOpen:Ie,onClose:Ge}=be(),ze=async(H,w)=>{try{const f=I.toString(fe(H.columnSep)),V=v.hasData?v.toString(h.gxpSettings.info_field_sep):null,P=J.plots.find(F=>F.type==="image"),O=JSON.stringify(Object.assign({},h.gxpSettings,{expression_field_sep:fe(H.columnSep)}),null,2),Z=new _l;if(Z.file("GXP_settings.json",O),Z.file("expression_table.txt",f),H.exportEnrichments){const F=H.exportEnrichments?JSON.stringify(ye.metadataToJSON(),null,2):void 0;F&&(Z.file("enrichment_analyses.json",F),Z.folder("enrichment_analyses"),ye.analyses.forEach(B=>{const R=ye.dataToCSV(B,fe(H.columnSep));Z.file(`enrichment_analyses/${B.options.title.replace(/\s+/g,"_")}.txt`,R)}))}if(H.exportPlots){const F=JSON.stringify(J.plotNamesForExport());F&&(Z.file("plots.json",F),Z.folder("plots"),J.plots.forEach(B=>{const R=JSON.stringify(J.toJSObject(B.id),null,2);R&&Z.file(`plots/${B.id}_${B.type}.json`,R)}))}if(V&&Z.file("info_table.txt",V),P){const F=await Fe(P.src,"blob");F&&Z.file("image.png",F,{base64:!0})}const z=await Z.generateAsync({type:"blob"});ql.exports.saveAs(z,H.fileName+".zip"),w.setSubmitting(!1),Ge()}catch(f){w.setSubmitting(!1),console.error(f)}},ue=I.hasData,se=()=>{t.length>0?(I.removeColumns(...t),c([])):(I.clearData(),v.clearData())},He=async()=>{J.loadCountUnit("raw"),h.loadgxpSettings({unit:"raw",expression_field_sep:"	",expression_header_sep:"*",info_field_sep:"	"});try{const w=await(await fetch("upload_expression_table.tsv")).text(),f=Ae(w,{fieldSeparator:"	",rowNameColumn:0});I.loadFromObject(f,{multiHeader:"*"}),h.setGroupOrder(I.groupsAsArray),h.setSampleOrder(I.samplesAsArray);const P=await(await fetch("upload_info_table.tsv")).text(),O=Ae(P,{fieldSeparator:"	",rowNameColumn:0});v.loadFromObject(O),d({title:"Example data has been loaded",description:'Click on the above "Plots" button and start plotting!',status:"success",duration:9e3,isClosable:!0})}catch{console.error("There was an error while loading the examle data")}};return e.createElement(x,{as:"main",flexGrow:1},e.createElement(vt,{maxWidth:"17rem"},!h.preloaded.data&&e.createElement(pe,{text:"Load Expression Table",icon:yc,onClick:s}),!h.preloaded.data&&e.createElement(pe,{text:"Load Gene Info Table",icon:Gc,onClick:r}),!h.preloaded.data&&e.createElement(pe,{text:"Load Mercator Table",icon:Lt,onClick:W,disabled:!ue}),!h.preloaded.data&&e.createElement(pe,{text:"Import GXP Database",icon:uc,onClick:le}),e.createElement(pe,{text:"Export GXP Database",icon:rc,onClick:Ie}),!h.preloaded.data&&e.createElement(pe,{text:t.length>0?"Remove selected":"Remove All Data",icon:Rl,onClick:se,disabled:!ue}),e.createElement(il,null),e.createElement(at,{to:"/tools/gene-browser",_hover:{textColor:"orange.600"}},e.createElement(pe,{text:"Gene Browser",icon:Wt,disabled:!ue}))),e.createElement(x,{alignItems:"center",flexDirection:"column",padding:"2rem",width:"100%"},!ue&&e.createElement(Ue,{alignItems:"center",flexDirection:"column",minHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"info",textAlign:"center",variant:"subtle",colorScheme:"orange"},e.createElement(Ee,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(we,{maxWidth:"xl"},"It seems no data has been loaded into the application yet."),e.createElement(we,{maxWidth:"xl",marginTop:3},"Load your data via the Sidebar or play around with some examples using the button below."),e.createElement(T,{colorScheme:"orange",variant:"solid",marginTop:3,onClick:He},"Load example data")),e.createElement(Zc,{role:"region","aria-label":"Loaded replicates",justify:"center",spacing:"1rem",width:"100%"},I.colNames.map(H=>e.createElement(pc,{key:H,width:l},e.createElement(yd,{"aria-label":H,key:H,name:H,onDelete:h.preloaded.data?void 0:a,onSelect:h.preloaded.data?void 0:o,tabIndex:h.preloaded.data?0:void 0}))))),e.createElement(Ve,{initialFocusRef:n,isOpen:b,onClose:i,title:"Load Expression Table"},e.createElement(Sd,{initialFocusRef:n,onCancel:i,onSubmit:m})),e.createElement(Ve,{initialFocusRef:p,isOpen:K,onClose:y,title:"Load Gene-Info Table"},e.createElement(zd,{initialFocusRef:p,onCancel:y,onSubmit:C})),e.createElement(Ve,{initialFocusRef:G,isOpen:Q,onClose:M,title:"Load Mercator Table"},e.createElement(Ut,{initialFocusRef:G,onCancel:M,onSubmit:Y})),e.createElement(Ve,{initialFocusRef:Xe,isOpen:Ke,onClose:q,title:"Import GXP Database"},e.createElement(Cd,{initialFocusRef:Xe,onCancel:q,onSubmit:te})),e.createElement(Ve,{initialFocusRef:he,isOpen:Le,onClose:Ge,title:"Export GXP Database"},e.createElement(Hd,{initialFocusRef:he,onCancel:Ge,onSubmit:ze})))};var la=Xl(ea);const ta=()=>e.createElement(Kl,null,e.createElement(Re,{path:"/",element:e.createElement(la,null)})),ca=ll(x),da=ll(g),Et=a=>{var o=a,{label:l,text:t,icon:c}=o,d=D(o,["label","text","icon"]);return e.createElement(rt,E(L({},d),{_focus:L({outline:"none",borderLeftColor:"orange.600"},d._focus),_hover:L({borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},d._hover),backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"xs",display:"flex",padding:5,rel:"noopener noreferrer",target:"_blank",tabIndex:0,width:"100%"}),c&&e.createElement(re,{as:c,color:"gray.600",height:"1.5rem",marginTop:1,marginRight:"1rem",width:"1.5rem"}),e.createElement(ca,{as:"section",alignItems:"center",flexGrow:1,whileHover:"hover"},e.createElement(g,{width:"100%"},e.createElement(_,{as:"h1",fontSize:"xl",fontWeight:"semibold"},l),e.createElement(_,{marginTop:"1.5"},t)),e.createElement(da,{marginX:"1rem",variants:{hover:{x:[0,10],transition:{duration:.8,repeat:1/0,repeatType:"mirror"}}}},e.createElement(re,{as:et,color:"orange.600",height:"1.5rem",width:"1.5rem"}))))},aa=()=>e.createElement(g,{as:"main",padding:6,width:"100%",__css:{"& a:not(:first-of-type)":{marginTop:"2rem"}}},e.createElement(Et,{icon:Xc,label:"User Manual",text:`
          The user manual contains detailed information on how to load data
          and create new plots. All the data loaded in the application is kept
          private to your browser tab and will never be uploaded to the
          internet.
        `,href:"https://zendro-dev.gitbook.io/geneexpressionplots/documentation/user-manual"}),e.createElement(Et,{_hover:{textDecoration:"none"},icon:Kc,label:"API",text:`
          The application programming interface contains instructions for
          advanced users that want to deploy this application with data
          already pre-loaded. This type of deployment is useful to showcase
          public datasets.
        `,href:"https://zendro-dev.gitbook.io/geneexpressionplots/documentation/api"})),oa=()=>e.createElement(Kl,null,e.createElement(Re,{path:"/",element:e.createElement(aa,null)}));function na(l){const t=e.useCallback(d=>{const a=I.rowNames,o=10,n=[];for(let b=0;b<a.length&&(a[b].includes(d)&&n.push(a[b]),!(n.length>=o));b++);return n},[]),c=e.useMemo(()=>{if((l==null?void 0:l.accession)!==void 0)return t(l==null?void 0:l.accession)},[t,l==null?void 0:l.accession]);return c!=null?c:t}function ba(l){const t=e.useCallback(d=>{const a=I.colNames,o=10,n=[];for(let b=0;b<a.length&&(a[b].includes(d)&&n.push(a[b]),!(n.length>=o));b++);return n},[]),c=e.useMemo(()=>{if((l==null?void 0:l.replicate)!==void 0)return t(l==null?void 0:l.replicate)},[t,l==null?void 0:l.replicate]);return c!=null?c:t}const Wl=p=>{var K=p,{children:l,controlProps:t,groupProps:c,hideLabel:d,initialFocusRef:a,label:o,leftChildren:n,name:b,rightChildren:s,validate:i}=K,m=D(K,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate"]);const[r,y]=Qe({name:b,validate:i}),C=na({accession:r.value});return e.createElement(Be,E(L({},t),{isInvalid:y.error!==void 0&&y.touched!==void 0,isRequired:m.isRequired}),d?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},o)):e.createElement(j,{fontWeight:"semibold"},o),e.createElement(Sl,L({as:"span"},c),n,e.createElement(Zl,E(L({ref:G=>a?a.current=G:G,name:r.name,onBlur:r.onBlur,onChange:r.onChange,multiple:r.multiple,value:r.value},m),{list:`${r.name}-list`})),e.createElement(g,{as:"datalist",id:`${r.name}-list`},C.map(G=>e.createElement(g,{as:"option",key:G,value:G}))),l,s),e.createElement(Ne,{as:"span"},y.error))},sa=l=>{const t=c=>{if(!I.getRow(c))return"The identifier does not exist";if(!c)return"The identifier cannot be empty"};return e.createElement(xe,{initialValues:{accessions:[""],plotTitle:"",withCaption:!0,withLegend:!0},onSubmit:l.onSubmit,validateOnBlur:!1},c=>e.createElement(g,{as:ge},e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Legend and caption switches"),e.createElement(x,{as:"ul",listStyleType:"none"},e.createElement(Pe,{controlProps:{as:"li"},color:"orange.600",id:"plot-legend",label:"Legend",name:"withLegend"}),e.createElement(Pe,{controlProps:{as:"li"},color:"orange.600",id:"plot-caption",label:"Caption",name:"withCaption"}))),e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(cl,{name:"accessions"},d=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Gene Accessions"),c.values.accessions&&c.values.accessions.length>0&&c.values.accessions.map((a,o)=>e.createElement(Wl,{controlProps:{as:"p",marginTop:"1rem"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:o,label:`Identifier (gene/metabolite/accession) ${o+1}`,name:`accessions.${o}`,rightChildren:c.values.accessions.length>1&&e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${a}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>d.remove(o),size:"md",variant:"unstyled"})),validate:t},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>d.insert(o+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:"1rem",type:"button",onClick:()=>d.push(""),variant:"ghost"},"Add New"))),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},ot=({controlProps:l,direction:t,hideLabel:c,label:d,name:a,options:o,validate:n})=>{const[b,s,i]=Qe({name:a,validate:n}),m=p=>{i.setValue(p)};return e.createElement(Be,E(L({},l),{isInvalid:s.error!==void 0&&s.touched!==void 0}),c?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},d)):e.createElement(j,{fontWeight:"semibold"},d),e.createElement(hc,{name:b.name,value:b.value,onChange:m,defaultValue:o[0].value},e.createElement(Zt,{direction:t},o.map((p,K)=>e.createElement(Lc,L({colorScheme:"orange",key:`${p.label}-${K}`,value:p.value,isDisabled:p.disabled},p),p.label)))),e.createElement(Ne,{as:"span"},s.error))},Ot=p=>{var K=p,{children:l,controlProps:t,groupProps:c,hideLabel:d,initialFocusRef:a,label:o,leftChildren:n,name:b,rightChildren:s,validate:i}=K,m=D(K,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate"]);const[r,y]=Qe({name:b,validate:i}),C=ba({replicate:r.value});return e.createElement(Be,E(L({},t),{isInvalid:y.error!==void 0&&y.touched!==void 0,isRequired:m.isRequired}),d?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},o)):e.createElement(j,{fontWeight:"semibold"},o),e.createElement(Sl,L({as:"span"},c),n,e.createElement(Zl,E(L({ref:G=>a?a.current=G:G,name:r.name,onBlur:r.onBlur,onChange:r.onChange,multiple:r.multiple,value:r.value},m),{list:`${r.name}-list`})),e.createElement(g,{as:"datalist",id:`${r.name}-list`},C.map(G=>e.createElement(g,{as:"option",key:G,value:G}))),l,s),e.createElement(Ne,{as:"span"},y.error))},Me=s=>{var i=s,{controlProps:l,hideLabel:t,label:c,name:d,validate:a,options:o,tooltip:n}=i,b=D(i,["controlProps","hideLabel","label","name","validate","options","tooltip"]);const[m,p,K]=Qe({name:d,validate:a});return e.createElement(Be,E(L({},l),{isInvalid:p.error!==void 0&&p.touched!==void 0}),t?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},c)):e.createElement(Al,{label:n,placement:"auto"},e.createElement(j,{fontWeight:"semibold"},c)),e.createElement(Wc,L({value:m.value,onChange:r=>K.setValue(r.target.value),onBlur:m.onBlur},b),o.map(r=>e.createElement("option",{key:r.value,value:r.value},r.label))),e.createElement(Ne,{as:"span"},p.error))},xl=s=>{var i=s,{controlProps:l,hideLabel:t,label:c,name:d,validate:a,initialFocusRef:o,tooltip:n}=i,b=D(i,["controlProps","hideLabel","label","name","validate","initialFocusRef","tooltip"]);const[m,p]=Qe({name:d,validate:a});return e.createElement(Be,E(L({},l),{isInvalid:p.error!==void 0&&p.touched!==void 0,isRequired:b.isRequired}),t?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},c)):e.createElement(Al,{label:n,placement:"auto"},e.createElement(j,{fontWeight:"semibold"},c)),e.createElement(xc,L({ref:K=>o?o.current=K:K,name:m.name,value:m.value,onChange:m.onChange,onBlur:m.onBlur},b)),e.createElement(Ne,{as:"span"},p.error))};var _e;(function(l){l.EMPTY_REPLICATE="A replicate field cannot be empty",l.EMPTY_ACCESSION="A gene accession field cannot be empty",l.MIN_OPTIONAL_REPLICATES="At least two replicates must be selected",l.MIN_OPTIONAL_ACCESSIONS="At least two genes must be selected"})(_e||(_e={}));const ia=l=>{const t=a=>{if(a.replicates.length===1&&a.clusterBy==="replicates")return{replicates:[_e.MIN_OPTIONAL_REPLICATES]};if(a.accessions.length===1&&a.clusterBy==="genes")return{accessions:[_e.MIN_OPTIONAL_ACCESSIONS]}},c=a=>{if(!a)return _e.EMPTY_REPLICATE},d=a=>{if(!a)return _e.EMPTY_ACCESSION};return e.createElement(xe,{initialValues:{accessions:[],accessionsList:"",clusterBy:"replicates",distanceMethod:"correlation",replicates:[],replicatesList:"",plotTitle:""},validateOnBlur:!1,validate:t,onSubmit:l.onSubmit},a=>{var o;return e.createElement(e.Fragment,null,((o=a.errors.replicates)==null?void 0:o[0])===_e.MIN_OPTIONAL_REPLICATES&&e.createElement($,null,e.createElement(Ue,{status:"error",variant:"subtle",alignItems:"center"},e.createElement(Ee,{mr:4}),e.createElement(g,{flex:"1"},e.createElement(Oe,{fontSize:"lg"},"Errors"),e.createElement(we,{display:"block"},_e.MIN_OPTIONAL_REPLICATES)),e.createElement(gc,{position:"absolute",right:"8px",top:"8px"}))),e.createElement(g,{as:ge},e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(Me,{controlProps:{marginTop:"2rem"},label:"Likelihood measure",name:"distanceMethod",options:[{value:"correlation",label:"correlation"},{value:"euclidean",label:"euclidean distance"}]}),e.createElement(ot,{controlProps:{marginTop:"2rem"},label:"Cluster",name:"clusterBy",options:[{label:"Replicates",value:"replicates"},{label:"Genes",value:"genes"}],direction:"row"}),e.createElement(cl,{name:"replicates"},n=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Replicates"),e.createElement(j,{as:"p",marginTop:"2rem",fontWeight:"semibold"},"Optionally filter replicates"),e.createElement(xl,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"replicatesList",label:"replicates",hideLabel:!0,placeholder:"List your replicates here, separated by a newline.",isDisabled:a.values.replicates.length>0}),a.values.replicates.length>0&&a.values.replicates.map((b,s)=>e.createElement(Ot,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:s,label:`Replicate ${s+1}`,name:`replicates.${s}`,rightChildren:e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${b}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>n.remove(s),size:"md",variant:"unstyled"})),validate:c},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>n.insert(s+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",type:"button",onClick:()=>{a.values.replicates.length===0&&n.push(""),n.push("")},variant:"ghost",marginTop:".5rem",disabled:a.values.replicatesList!==""},a.values.replicates.length===0?"Select Replicates":"Add Another Replicate"))),e.createElement(cl,{name:"accessions"},n=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Genes"),e.createElement(j,{as:"p",marginTop:"1rem",fontWeight:"semibold"},"Optionally filter genes"),e.createElement(xl,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"accessionsList",label:"accession",hideLabel:!0,placeholder:"List your identifiers here, separated by a newline.",isDisabled:a.values.accessions.length>0}),a.values.accessions&&a.values.accessions.length>0&&a.values.accessions.map((b,s)=>e.createElement(Wl,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:s,label:`Gene Identifier ${s+1}`,name:`accessions.${s}`,rightChildren:e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${b}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>n.remove(s),size:"md",variant:"unstyled"})),validate:d},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>n.insert(s+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:".5rem",type:"button",onClick:()=>{a.values.accessions.length===0&&n.push(""),n.push("")},variant:"ghost",disabled:a.values.accessionsList!==""},a.values.accessions.length===0?"Select Genes":"Add Another Genes"))),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))})},Dt=({colorScale:l,id:t,minVal:c,maxVal:d,label:a,width:o,height:n,x:b,y:s,reverse:i,labelOffset:m})=>{const p=Ye.exports.useRef(null);return Ye.exports.useLayoutEffect(()=>{const K=Vc().domain([c,d]).range([n,0]),r=Ic(K).scale(K).tickValues([c,d]),y=Je(p.current),G=y.append("defs").append("linearGradient").attr("id",`linear-gradient-${t}`);G.attr("x1","0%").attr("y1",`${i?"0":"100"}%`).attr("x2","0%").attr("y2",`${i?"110":"0"}%`),G.selectAll("stop").data(l.ticks().map((Q,W,M)=>({offset:`${100*W/M.length}%`,color:l(Q)}))).enter().append("stop").attr("offset",Q=>Q.offset).attr("stop-color",Q=>Q.color),y.append("rect").attr("width",o).attr("height",n).attr("x",b).attr("y",s).style("fill",`url(#linear-gradient-${t})`),y.append("g").style("font-size","1rem").attr("transform",`translate(${b-10}, ${s})`).call(r),y.append("text").attr("class","y label").attr("text-anchor","end").attr("transform",`translate (${b-20},${s+80-(m!=null?m:0)}) rotate(-90)`).text(a)},[]),e.createElement("svg",{ref:p})},ma="#b4fbde",ya="#f33d15";function jt(l,t){return Math.max(...l.map(t))}function At(l,t){return Math.min(...l.map(t))}const _t=l=>l.bins,qt=l=>l.count,Ga=l=>{var Q;const{tooltipData:t,tooltipLeft:c,tooltipTop:d,tooltipOpen:a,showTooltip:o,hideTooltip:n}=Hc(),{containerRef:b,TooltipInPortal:s}=Cc({detectBounds:!0,scroll:!0}),i=At(l.binData,W=>At(_t(W),qt)),m=jt(l.binData,W=>jt(_t(W),qt)),p=l.distanceMethod==="correlation"?xt([1,-1],gt):Yl({range:[ma,ya],domain:[i,m]}),K=e.useRef(null),r=e.useRef(),[y,C]=e.useState(),G=Ye.exports.useMemo(()=>zc(l.tree),[l.tree]);return e.useEffect(function(){let M;const Y=K.current,Xe=new ResizeObserver(Ke=>{r.current&&clearTimeout(r.current),C(void 0),M=window.setTimeout(()=>{const le=window.getComputedStyle(Ke[0].target,null),q=parseFloat(le.getPropertyValue("padding-top")),te=parseFloat(le.getPropertyValue("padding-bottom")),he=parseFloat(le.getPropertyValue("padding-left")),Ie=parseFloat(le.getPropertyValue("padding-right"))+he,Ge=q+te,ze=l.plotTitle?30:0,ue=20,se=Math.max(...l.binData.map(R=>R.bin.length))*6+5,He=Ke[0].target.clientWidth-Ie-ue-(se!=null?se:0),H=Ke[0].target.clientHeight-Ge-(se!=null?se:0)-ze*2,w=H/6,f=H-w,V=l.binData.length,P=He/V,O=f/V,Z=Yl({domain:[0,l.binData.length],range:[0,He]}),z=Yl({domain:[0,l.binData.length],range:[0,f]}),F=Vt({domain:l.binData.map(R=>R.bin),range:[0,He]}),B=Vt({domain:l.binData[0].bins.map(R=>R.bin),range:[0,f]});C({binWidth:P,binHeight:O,tickLineSize:ue,titleHeight:ze,tickLabelSize:se,xScaleAxis:F,xScalePlot:Z,yScaleAxis:B,yScalePlot:z,xMax:He,yMax:H,treeBoundsY:w,heatmapBoundsY:f})},100),r.current=M});return Y&&Xe.observe(Y),()=>{Y&&Xe.unobserve(Y),M&&clearTimeout(M)}},[l.binData,l.plotTitle]),e.createElement(ml,{justifyContent:"center",status:y?"idle":"loading",figureRef:K,position:"relative",height:1200,plotType:"heatmap",id:l.id},y&&e.createElement(e.Fragment,null,e.createElement("svg",{className:"main-svg",width:"100%",height:"100%",ref:b},e.createElement(Dt,{colorScale:p,id:me(),minVal:l.distanceMethod==="euclidean"?i:-1,maxVal:l.distanceMethod==="euclidean"?m:1,width:20,height:225,x:60,y:10,labelOffset:30,reverse:l.distanceMethod==="correlation",label:l.distanceMethod==="euclidean"?"euclidean distance":"correlation coefficient"}),e.createElement(hl,null,e.createElement(It,{x:y.xMax/2+y.tickLabelSize,y:15,textAnchor:"middle",fontSize:20},l.plotTitle)),e.createElement(hl,{top:y.titleHeight,left:y.tickLabelSize+y.tickLineSize},e.createElement(Sc,{root:G,size:[y.xMax,y.treeBoundsY],separation:()=>5},W=>e.createElement(hl,null,W.links().map((M,Y)=>e.createElement(vc,{key:`cluster-link-${Y}`,data:M,stroke:"black",strokeWidth:"1",fill:"none",percent:0})),W.descendants().map((M,Y)=>e.createElement(hl,{top:M.y,left:M.x,key:`cluster-node-${Y}`},!M.children&&e.createElement(It,{dy:3,fontSize:10,fontFamily:"Arial",textAnchor:"end",angle:270,dx:4},M.data.name)))))),e.createElement(hl,{top:y.titleHeight+y.treeBoundsY+y.tickLabelSize,left:y.tickLabelSize+y.tickLineSize},e.createElement(Rc,{data:l.binData,xScale:W=>(y==null?void 0:y.xScalePlot)?y.xScalePlot(W):0,yScale:W=>(y==null?void 0:y.yScalePlot)?y.yScalePlot(W):0,colorScale:p,binWidth:y==null?void 0:y.binWidth,binHeight:y==null?void 0:y.binHeight,bins:W=>W&&W.bins,count:W=>W&&W.count,gap:1},W=>W.map(M=>M.map(Y=>e.createElement("rect",{key:`heatmap-rect-${Y.row}-${Y.column}`,width:Y.width,height:Y.height,x:Y.x,y:Y.y,fill:Y.color,fillOpacity:Y.opacity,onMouseOver:()=>{o({tooltipData:Y,tooltipTop:Y.y+y.titleHeight+y.treeBoundsY+y.tickLabelSize,tooltipLeft:Y.x})},onMouseOut:n})))),e.createElement(Mc,{left:-10,numTicks:l.binData.length,tickLabelProps:()=>({lengthAdjust:"spacing",fontSize:10,textAnchor:"end",dy:3,dx:-3}),scale:y.yScaleAxis})))),a&&t&&e.createElement(s,{left:c,top:d},e.createElement("p",null,e.createElement(_,{as:"span",fontWeight:"semibold"},"Column"),e.createElement(_,{as:"span",ml:1},l.binData[t.column].bin)),e.createElement("p",null,e.createElement(_,{as:"span",fontWeight:"semibold"},"Row"),e.createElement(_,{as:"span",ml:1},l.binData[t.column].bins[t.row].bin)),e.createElement("p",null,e.createElement(_,{as:"span",fontWeight:"semibold"},l.distanceMethod.charAt(0).toUpperCase()+l.distanceMethod.slice(1)),e.createElement(_,{as:"span",ml:1},(Q=t.count)==null?void 0:Q.toFixed(4)))))},ua=a=>{var o=a,{alt:l,src:t,id:c}=o,d=D(o,["alt","src","id"]);return e.createElement(ml,{"aria-label":l,id:c,plotType:"image",status:"idle"},e.createElement(Tc,L({alt:l,backgroundColor:"white",objectFit:"scale-down",src:t,width:"100%"},d)))};var gl;(function(l){l.FILE_EMPTY="An image file is required",l.FILE_FORMAT="Supported formats are: png",l.ALT_EMPTY="An image label is required"})(gl||(gl={}));const ra=l=>{const t=d=>{if(!d)return gl.FILE_EMPTY;if(d.type!=="image/png")return gl.FILE_FORMAT},c=d=>{if(!d)return gl.ALT_EMPTY};return e.createElement(xe,{initialValues:{alt:""},validateOnBlur:!1,onSubmit:l.onSubmit},d=>e.createElement(g,{as:ge},e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem",marginBottom:"1rem"},initialFocusRef:l.initialFocusRef,isRequired:!0,label:"Image label",name:"alt",validate:c}),e.createElement(Ll,{name:"file",label:"Image file",validate:t,isRequired:!0}),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:d.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Add"))))},Za=l=>{const t=e.useRef(null),c=e.useRef(null),d=e.useRef(),[a,o]=e.useState(l.layout),n={toImageButtonOptions:{format:"svg",filename:"plot"},displaylogo:!1,modeBarButtonsToRemove:["zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","hoverClosestGl2d","hoverClosestPie","toggleHover","resetViews","sendDataToCloud","toggleSpikelines"],modeBarButtonsToAdd:[{title:"Delete plot",name:"Delete plot",icon:{width:21,height:21,path:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},click:()=>{J.deletePlot(l.id)}}]};return e.useEffect(function(){let s;const i=c.current,m=new ResizeObserver(p=>{clearTimeout(d.current),s=window.setTimeout(()=>{o(K=>E(L({},K),{width:p[0].target.clientWidth}))},250),d.current=s});return i&&m.observe(i),()=>{i&&m.unobserve(i),s&&clearTimeout(s)}},[]),e.createElement(ml,{status:"idle",figureRef:c,id:l.id},e.createElement(Kt,{ref:b=>t.current=b,data:l.data,layout:a,config:n,style:{width:"100%",height:"100%"}}))};var pa=Xl(Za);const Xa="#f33d15",Ka="#b4fbde",nt=5,ha=l=>{const t=Ye.exports.useRef(null),c=Ye.exports.useRef(null),[d,a]=Ye.exports.useState(5),[o,n]=Ye.exports.useState("loading");let b=0,s=0;switch(l.colorScale){case"diverging_-xx":b=-l.colorScaleValueX,s=l.colorScaleValueX;break;case"continuous_0q3":b=0,s=l.stats.q3;break;case"continuous_q1q3":b=l.stats.q1,s=l.stats.q3;break;case"continuous_xy":b=l.colorScaleValueX,s=l.colorScaleValueY;break}const i=[b,s],m=l.colorScale==="diverging_-xx"?xt(i.reverse(),gt):Yl({range:[Ka,Xa],domain:i});return Ye.exports.useLayoutEffect(()=>{Yc(`mapman-templates/${l.template}.svg`).then(p=>{const K=l.plotTitle?l.height+30:l.height,r=Je(c.current).attr("width","90%").attr("height","100%").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 ${l.plotTitle?-30:0} ${l.width+100} ${K}`).classed("main-svg",!0);r.node().append(p.documentElement);const y=Je(c.current).append("g").attr("id","viz-layer");r.append("text").attr("x",l.width/2).attr("y",0).attr("text-anchor","middle").style("font-size",l.height/25).text(`${l.plotTitle}`),y.selectAll("rect").data(l.rects).enter().append("rect").attr("x",({x:G})=>G).attr("y",({y:G})=>G).attr("height",nt).attr("width",nt).attr("xOffset",({xOffset:G})=>G).attr("yOffset",({yOffset:G})=>G).attr("value",({value:G})=>G).style("stroke","lightgray").style("stroke-width",nt*.1).style("fill",({value:G})=>m(G)).append("title").text(({geneId:G,bin:Q,value:W})=>`Gene-ID: ${G}
MapMan_BINCODE: ${Q}
${l.valuesFrom}: ${W}`),n("idle")})},[]),Ye.exports.useLayoutEffect(()=>{const p=Je(c.current).select("#viz-layer").selectAll("rect");p.attr("x",function(){const K=parseInt(Je(this).attr("x")),r=parseInt(Je(this).attr("xOffset")),y=d-parseInt(Je(this).attr("width"));return K+r*y}),p.attr("y",function(){const K=parseInt(Je(this).attr("y")),r=parseInt(Je(this).attr("yOffset")),y=d-parseInt(Je(this).attr("width"));return K+r*y}),p.style("stroke-width",function(){return d*.1}),p.attr("height",d).attr("width",d)},[d]),e.createElement(ml,{figureRef:t,position:"relative",height:800,plotType:"heatmap",status:"idle",id:l.id,overflow:"auto"},e.createElement(x,{justifyContent:"center",height:"100%",flexDirection:"column",alignItems:"center"},o==="loading"&&e.createElement(sl,{position:"absolute",thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),e.createElement("svg",{ref:c},e.createElement(Dt,{colorScale:m,id:me(),minVal:b,maxVal:s,width:20,height:250,x:l.width+50,y:10,label:l.valuesFrom,reverse:l.colorScale==="diverging_-xx"})),e.createElement(x,{marginTop:"2rem",marginRight:"8rem",flexDirection:"row",justifyContent:"space-around",width:"full"},e.createElement(lt,{variant:"simple",size:"sm",width:"25rem"},e.createElement(Ht,null,`Distribution of ${l.valuesFrom}`),e.createElement(tt,null,e.createElement(je,null,e.createElement(ee,{isNumeric:!0},"Min"),e.createElement(ee,{isNumeric:!0},"Q1"),e.createElement(ee,{isNumeric:!0},"Median"),e.createElement(ee,{isNumeric:!0},"Mean"),e.createElement(ee,{isNumeric:!0},"Q3"),e.createElement(ee,{isNumeric:!0},"Max"))),e.createElement(ct,null,e.createElement(je,null,e.createElement(Ce,{isNumeric:!0},l.stats.min.toFixed(2)),e.createElement(Ce,{isNumeric:!0},l.stats.q1.toFixed(2)),e.createElement(Ce,{isNumeric:!0},l.stats.median.toFixed(2)),e.createElement(Ce,{isNumeric:!0},l.stats.mean.toFixed(2)),e.createElement(Ce,{isNumeric:!0},l.stats.q3.toFixed(2)),e.createElement(Ce,{isNumeric:!0},l.stats.max.toFixed(2))))),e.createElement(x,{flexDirection:"column"},e.createElement(x,{justifyContent:"center",alignItems:"center",gridGap:2},e.createElement(Ze,{"aria-label":"decrease rect size",isRound:!0,colorScheme:"black",variant:"outline",size:"sm",icon:e.createElement(Jc,null),onClick:()=>a(Math.max(1,d-1))}),e.createElement(_,null,`[ ${d} ]`),e.createElement(Ze,{"aria-label":"increase rect size",isRound:!0,colorScheme:"black",variant:"outline",size:"sm",icon:e.createElement(Pc,null),onClick:()=>a(d+1)})),e.createElement(_,null,"Adjust Box Size")))))},La=l=>{const t=c=>{if(!I.getRow(c))return"The identifier does not exist";if(!c)return"The identifier cannot be empty"};return e.createElement(xe,{initialValues:{accessions:[""],plotTitle:"",withCaption:!0,withLegend:!0},onSubmit:l.onSubmit,validateOnBlur:!1},c=>e.createElement(g,{as:ge},e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Legend and caption switches"),e.createElement(x,{as:"ul",listStyleType:"none"},e.createElement(Pe,{controlProps:{as:"li"},color:"orange.600",id:"plot-legend",label:"Legend",name:"withLegend"}),e.createElement(Pe,{controlProps:{as:"li"},color:"orange.600",id:"plot-caption",label:"Caption",name:"withCaption"}))),e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(cl,{name:"accessions"},d=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Gene Accessions"),c.values.accessions&&c.values.accessions.length>0&&c.values.accessions.map((a,o)=>e.createElement(Wl,{controlProps:{as:"p",marginTop:"1rem"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:o,label:`Identifier (gene/metabolite/accession) ${o+1}`,name:`accessions.${o}`,rightChildren:c.values.accessions.length>1&&e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${a}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>d.remove(o),size:"md",variant:"unstyled"})),validate:t},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>d.insert(o+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:"1rem",type:"button",onClick:()=>d.push(""),variant:"ghost"},"Add New"))),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Wa=l=>{const t=c=>{if(!I.getRow(c))return"The identifier does not exist";if(!c)return"The identifier cannot be empty"};return e.createElement(xe,{initialValues:{accessions:[""],plotTitle:"",withCaption:!0,withLegend:!0,colorBy:"group"},onSubmit:l.onSubmit,validateOnBlur:!1},c=>e.createElement(g,{as:ge},e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Legend and caption switches"),e.createElement(x,{as:"ul",listStyleType:"none"},e.createElement(Pe,{controlProps:{as:"li"},color:"orange.600",id:"plot-legend",label:"Legend",name:"withLegend"}),e.createElement(Pe,{controlProps:{as:"li"},color:"orange.600",id:"plot-caption",label:"Caption",name:"withCaption"}))),e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(ot,{controlProps:{as:"p",marginTop:"1rem"},direction:"row",label:"Color by",name:"colorBy",options:[{label:"Group",value:"group",disabled:!1},{label:"Gene",value:"accession",disabled:c.values.accessions.length===1}]}),e.createElement(cl,{name:"accessions"},d=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Gene Accessions"),c.values.accessions&&c.values.accessions.length>0&&c.values.accessions.map((a,o)=>e.createElement(Wl,{controlProps:{as:"p",marginTop:"1rem"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:o,label:`Identifier (gene/metabolite/accession) ${o+1}`,name:`accessions.${o}`,rightChildren:c.values.accessions.length>1&&e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${a}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>d.remove(o),size:"md",variant:"unstyled"})),validate:t},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>d.insert(o+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:"1rem",type:"button",onClick:()=>d.push(""),variant:"ghost"},"Add New"))),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:c.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},xa=({color:l,accession:t,geneInfo:c})=>e.createElement(g,{as:"div",px:"2"},e.createElement(x,{alignItems:"center",mb:"4"},e.createElement(g,{fontWeight:"semibold",fontSize:"lg",px:"2",color:l},t)),c.size>0?[...c.entries()].map(([d,a])=>e.createElement(x,{key:`${t}-${d}`},e.createElement(x,{flexShrink:"unset",ml:"2",py:"1",w:"36",textTransform:"uppercase",textColor:"yellow.700",wordBreak:"break-all"},d),e.createElement(x,{ml:"5",py:"1",wordBreak:"break-all"},a))):"No information available for this gene."),ga=l=>e.createElement(Bt.Consumer,null,({hoveredGene:t})=>e.createElement(x,{as:"figcaption",py:"5",textColor:"gray.600",textAlign:"justify",fontSize:"sm",_hover:{backgroundColor:"yellow.100"},_odd:{backgroundColor:"gray.100"}},e.createElement(xa,{accession:l.accession,geneInfo:l.caption,color:l.color})));var yl;(function(l){l.EMPTY_REPLICATE="A replicate field cannot be empty",l.EMPTY_ACCESSION="A gene accession field cannot be empty",l.MIN_OPTIONAL_REPLICATES="At least two replicates must be selected",l.MIN_OPTIONAL_ACCESSIONS="At least two genes must be selected"})(yl||(yl={}));const Va=l=>{const t=a=>{if(a.replicates.length===1&&a.calculateFor==="replicates")return{replicates:[yl.MIN_OPTIONAL_REPLICATES]};if(a.accessions.length===1&&a.calculateFor==="genes")return{accessions:[yl.MIN_OPTIONAL_ACCESSIONS]}},c=a=>{if(!a)return yl.EMPTY_REPLICATE},d=a=>{if(!a)return yl.EMPTY_ACCESSION};return e.createElement(xe,{initialValues:{accessions:[],accessionsList:"",calculateFor:"replicates",replicates:[],replicatesList:"",plotTitle:""},validateOnBlur:!1,validate:t,onSubmit:l.onSubmit},a=>e.createElement(g,{as:ge},e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(ot,{controlProps:{marginTop:"2rem"},label:"Calculate For",name:"calculateFor",options:[{label:"Replicates",value:"replicates"},{label:"Genes",value:"genes"}],direction:"row"}),e.createElement(cl,{name:"replicates"},o=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Replicates"),e.createElement(j,{as:"p",marginTop:"2rem",fontWeight:"semibold"},"Optionally filter replicates"),e.createElement(xl,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"replicatesList",label:"replicates",hideLabel:!0,placeholder:"List your replicates here, separated by a newline.",isDisabled:a.values.replicates.length>0}),a.values.replicates.length>0&&a.values.replicates.map((n,b)=>e.createElement(Ot,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:b,label:`Replicate ${b+1}`,name:`replicates.${b}`,rightChildren:e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${n}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>o.remove(b),size:"md",variant:"unstyled"})),validate:c},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>o.insert(b+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:".5rem",type:"button",onClick:()=>{a.values.replicates.length===0&&o.push(""),o.push("")},variant:"ghost",disabled:a.values.replicatesList!==""},a.values.replicates.length===0?"Select Replicates":"Add Another Replicate"))),e.createElement(cl,{name:"accessions"},o=>e.createElement(g,{as:"fieldset"},e.createElement($,{as:"legend"},"Genes"),e.createElement(j,{as:"p",marginTop:"1rem",fontWeight:"semibold"},"Optionally filter genes"),e.createElement(xl,{controlProps:{marginTop:"1rem",marginLeft:".5rem"},focusBorderColor:"orange.300",name:"accessionsList",label:"accession",hideLabel:!0,placeholder:"List your identifiers here, separated by a newline.",isDisabled:a.values.accessions.length>0}),a.values.accessions&&a.values.accessions.length>0&&a.values.accessions.map((n,b)=>e.createElement(Wl,{controlProps:{as:"p"},groupProps:{_focusWithin:{"& > button":{display:"inline-flex"}}},isRequired:!0,key:b,label:`Gene Identifier ${b+1}`,name:`accessions.${b}`,rightChildren:e.createElement(dl,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"red.600",outline:"none"},_groupHover:{color:"red.600"},"aria-label":`Remove ${n}`,color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(al,null),onClick:()=>o.remove(b),size:"md",variant:"unstyled"})),validate:d},e.createElement(g,{display:"none",color:"gray.500",_groupFocus:{display:"inline-flex"},_groupHover:{display:"inline-flex"},_focus:{backgroundColor:"orange.600",color:"white",outline:"none"},_hover:{backgroundColor:"orange.600",color:"white"},alignItems:"center",as:"button","aria-label":"Insert new below",backgroundColor:"white",height:"1rem",justifyContent:"center",left:"43%",padding:".75rem",position:"absolute",rounded:"full",top:"28px",type:"button",width:"1rem",zIndex:"popover",onClick:()=>o.insert(b+1,"")},e.createElement(re,{as:De})))),e.createElement(T,{_focus:{outline:"none",backgroundColor:"orange.100"},_hover:{backgroundColor:"orange.100"},colorScheme:"orange",marginTop:".5rem",type:"button",onClick:()=>{a.values.accessions.length===0&&o.push(""),o.push("")},variant:"ghost",disabled:a.values.accessionsList!==""},a.values.accessions.length===0?"Select Genes":"Add Another Genes"))),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Vl=p=>{var K=p,{children:l,controlProps:t,groupProps:c,hideLabel:d,initialFocusRef:a,label:o,leftChildren:n,name:b,rightChildren:s,validate:i}=K,m=D(K,["children","controlProps","groupProps","hideLabel","initialFocusRef","label","leftChildren","name","rightChildren","validate"]);const[r,y,C]=Qe({name:b,validate:i});return e.createElement(Be,E(L({},t),{isInvalid:y.error!==void 0&&y.touched!==void 0,isRequired:m.isRequired}),d?e.createElement($,null,e.createElement(j,{fontWeight:"semibold"},o)):e.createElement(j,{fontWeight:"semibold"},o),e.createElement(Sl,L({},c),n,e.createElement(kc,E(L({},m),{name:r.name,value:r.value,onChange:G=>C.setValue(G?parseFloat(G):"")}),e.createElement(Qc,{ref:G=>a?a.current=G:G}),e.createElement(Bc,null,e.createElement(Nc,null),e.createElement(wc,null))),l,s),e.createElement(Ne,{as:"span"},y.error))},Ia=[{label:"Amino acid metabolism",value:"X4.3_Amino_acid_metabolism_R3.0"},{label:"Carbohydrate metabolism",value:"X4.3_Carbohydrate_metabolism_R3.0"},{label:"Cellular respiration",value:"X4.3_Cellular_respiration_R3.0"},{label:"Coenzyme metabolism",value:"X4.3_Coenzyme_metabolism_R3.0"},{label:"GA synthesis",value:"X4.3_GA_synthesis_R3.0"},{label:"JA synthesis",value:"X4.3_JA_synthesis_R3.0"},{label:"Lignin",value:"X4.3_Lignin_R3.0"},{label:"Lipid metabolism",value:"X4.3_Lipid_metabolism_R3.0"},{label:"Metabolism overview",value:"X4.3_Metabolism_overview_R3.0"},{label:"Nucleotide metabolism",value:"X4.3_Nucleotide_metabolism_R3.0"},{label:"Photosynthesis",value:"X4.3_Photosynthesis_R3.0"},{label:"Polyamine metabolism",value:"X4.3_Polyamine_metabolism_R3.0"},{label:"Secondary metabolism",value:"X4.3_Secondary_metabolism_R3.0"},{label:"Tetrapyrrole biosynthesis",value:"X4.3_Tetrapyrrole_biosynthesis_R3.0"},{label:"Tocopherol biosynthesis",value:"X4.3_Tocopherol_biosynthesis_R3.0"},{label:"Vesicle trafficking",value:"X4.3_Vesicle_trafficking_R3.0"}],Ha=l=>{var d;const t=bl({base:"column",sm:"row"}),c=Ye.exports.useMemo(()=>$l(v.sliceColumns(0,9)).reduce((o,n,b)=>{if(rd(n)){const s=v.colNames[b];o.push({value:s,label:s})}return o},[{value:"expressionValue",label:"Mean expression value"}]),[]);return e.createElement(xe,{initialValues:{infoTableColumn:(d=v.colNames.find(a=>a==="MapMan_BINCODE"))!=null?d:v.colNames[0],infoTableColumnSep:",",template:"X4.3_Amino_acid_metabolism_R3.0",valuesFrom:c[0].value,colorScale:"diverging_-xx",sample:I.sampleGroupsAsArray[0],colorScaleValueX:3,colorScaleValueY:3,plotTitle:""},validateOnBlur:!1,onSubmit:l.onSubmit},a=>e.createElement(g,{as:ge},e.createElement(ae,{controlProps:{as:"p"},initialFocusRef:l.initialFocusRef,label:"Plot Title",name:"plotTitle"}),e.createElement(x,{gridGap:"1rem",flexDirection:t,marginTop:"2rem"},e.createElement(Me,{label:"MapMan BINCODE column",name:"infoTableColumn",options:v.colNames.map(o=>({value:o,label:o})),tooltip:"Select the column from your gene info table that holds MapMan BINCODE(s).",width:"20rem"}),e.createElement(ae,{controlProps:{as:"p"},initialFocusRef:l.initialFocusRef,label:"BINCODE separator",name:"infoTableColumnSep",tooltip:"In-column separator for MapMan BINCODEs, in case a gene is annotated with multiple bins.",isRequired:!0})),e.createElement(Me,{controlProps:{marginTop:"1rem"},label:"Values from",name:"valuesFrom",options:c,tooltip:"Select where to get the values to be plotted from. Can be any numeric value from the info table or mean expression values for a specific sample."}),a.values.valuesFrom=="expressionValue"&&e.createElement(Me,{controlProps:{marginTop:"1rem"},label:"Sample",name:"sample",options:I.sampleGroupsAsArray.map(o=>({label:o,value:o})),tooltip:"Select the sample to get the shown values for each gene from"}),e.createElement(x,{marginTop:"2rem",gridGap:"1rem",flexDirection:t},e.createElement(Me,{label:"Color Scale",name:"colorScale",width:"20rem",options:[{value:"diverging_-xx",label:"diverging (-x to x)"},{value:"continuous_0q3",label:"continuous (0 to 3. quartile)"},{value:"continuous_q1q3",label:"continuous (1. quartile to 3. quartile)"},{value:"continuous_xy",label:"continuous (x to y)"}],tooltip:"Select a color scale for your values. For log2FC or similar, choose a divergent scale."}),a.values.colorScale==="diverging_-xx"&&e.createElement(Vl,{label:"Value (x)",name:"colorScaleValueX",min:1,isRequired:!0}),a.values.colorScale==="continuous_xy"&&e.createElement(e.Fragment,null,e.createElement(Vl,{label:"Value (x)",name:"colorScaleValueX",isRequired:!0}),e.createElement(Vl,{label:"Value (y)",name:"colorScaleValueY",isRequired:!0}))),e.createElement(Me,{controlProps:{marginTop:"2rem"},label:"MapMan Template",name:"template",options:Ia,tooltip:"Select the MapMan Pathway File to use as template for plotting your values"}),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:a.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Load"))))},Ca=()=>{const l=Tl(),t=e.useRef(null),{isOpen:c,onOpen:d,onClose:a}=be(),o=(Z,z)=>{Z.accessions.length===1?J.addSingleGeneBarPlot(Z.accessions,{showlegend:Z.withLegend,showCaption:Z.withCaption,plotTitle:Z.plotTitle}):J.addMultiGeneBarPlot(Z.accessions,{showlegend:Z.withLegend,showCaption:Z.withCaption,plotTitle:Z.plotTitle}),z.setSubmitting(!1),a()},n=e.useRef(null),{isOpen:b,onOpen:s,onClose:i}=be(),m=(Z,z)=>{Z.accessions.length===1?J.addSingleGeneIndividualLinesPlot(Z.accessions,{showlegend:Z.withLegend,showCaption:Z.withCaption,plotTitle:Z.plotTitle}):J.addMultiGeneIndividualLinesPlot(Z.accessions,{showlegend:Z.withLegend,showCaption:Z.withCaption,plotTitle:Z.plotTitle}),z.setSubmitting(!1),i()},p=e.useRef(null),{isOpen:K,onOpen:r,onClose:y}=be(),C=(Z,z)=>{J.addStackedLinesPlot(Z.accessions,{showlegend:Z.withLegend,showCaption:Z.withCaption,plotTitle:Z.plotTitle,colorBy:Z.colorBy}),z.setSubmitting(!1),y()},G=e.useRef(null),{isOpen:Q,onOpen:W,onClose:M}=be(),Y=(Z,z)=>{z.setSubmitting(!1);let F=Z.replicates;const B=[];Z.replicatesList!==""&&(F=Z.replicatesList.split(`
`),F.forEach((U,We,ie)=>{U=U.trim(),ie[We]=U,I.colNames.includes(U)||B.push(U)}),B.length>0&&l({title:"Error",description:`Invalid replicates: ${JSON.stringify(B)}`,status:"error",isClosable:!0}));let R=Z.accessions;const ce=[];Z.accessionsList!==""&&(R=Z.accessionsList.split(`
`),R.forEach((U,We,ie)=>{U=U.trim(),ie[We]=U,I.rowNames.includes(U)||ce.push(U)}),ce.length>0&&l({title:"Error",description:`Invalid accessions: ${JSON.stringify(ce)}`,status:"error",isClosable:!0})),!(B.length>0||ce.length>0)&&(M(),setTimeout(()=>J.addHeatmapPlot({accessions:R,clusterBy:Z.clusterBy,distanceMethod:Z.distanceMethod,replicates:F,plotTitle:Z.plotTitle}),10))},Xe=e.useRef(null),{isOpen:Ke,onOpen:le,onClose:q}=be(),te=(Z,z)=>{z.setSubmitting(!1);let F=Z.replicates;const B=[];Z.replicatesList!==""&&(F=Z.replicatesList.split(`
`),F.forEach((U,We,ie)=>{U=U.trim(),ie[We]=U,I.colNames.includes(U)||B.push(U)}),B.length>0&&l({title:"Error",description:`Invalid replicates: ${JSON.stringify(B)}`,status:"error",isClosable:!0}));let R=Z.accessions;const ce=[];Z.accessionsList!==""&&(R=Z.accessionsList.split(`
`),R.forEach((U,We,ie)=>{U=U.trim(),ie[We]=U,I.rowNames.includes(U)||ce.push(U)}),ce.length>0&&l({title:"Error",description:`Invalid accessions: ${JSON.stringify(ce)}`,status:"error",isClosable:!0})),!(B.length>0||ce.length>0)&&(q(),setTimeout(()=>J.addPCAPlot({accessions:R,calculateFor:Z.calculateFor,replicates:F,plotTitle:Z.plotTitle}),10))},he=e.useRef(null),{isOpen:Le,onOpen:Ie,onClose:Ge}=be(),ze=async(Z,z)=>{Ge(),setTimeout(()=>J.addMapManPlot(Z),10),z.setSubmitting(!1)},ue=e.useRef(null),{isOpen:se,onOpen:He,onClose:H}=be(),w=(Z,z)=>{if(z.setSubmitting(!1),H(),Z.file){const F=URL.createObjectURL(Z.file);J.addImagePlot(F,Z.alt)}},f=()=>{J.clearPlots()},V=I.hasData,P=J.hasPlots,O=v.hasData;return e.createElement(x,{as:"main",flexGrow:1},e.createElement(vt,{background:"white",marginTop:5,minWidth:"4.5rem",maxWidth:"14rem",position:"fixed",boxShadow:"2xl",zIndex:"popover"},e.createElement(pe,{text:"Bars",icon:Ct,onClick:d,disabled:!V}),e.createElement(pe,{text:"Individual Lines",icon:fc,onClick:s,disabled:!V}),e.createElement(pe,{text:"Stacked Lines",icon:Fc,onClick:r,disabled:!V}),e.createElement(il,null),e.createElement(pe,{text:"Cluster Heatmap",icon:Uc,onClick:W,disabled:!V}),e.createElement(pe,{text:"PCA",icon:Ec,onClick:le,disabled:!V}),e.createElement(il,null),e.createElement(pe,{text:"MapMan Function",icon:dt,onClick:Ie,disabled:!V||!O}),e.createElement(il,null),e.createElement(pe,{text:"Custom figure",icon:Oc,onClick:He}),e.createElement(pe,{text:"Remove All",icon:Rl,onClick:f,disabled:!P})),e.createElement(x,{"aria-label":"Visualizations",flexWrap:"wrap",role:"region",width:"100%",margin:2,marginLeft:20,overflow:"hidden"},!V&&e.createElement(Ue,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ee,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(we,{maxWidth:"xl"},"It seems no data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above.")),J.plots.map(Z=>{if(Z.isLoading)return e.createElement(ml,{key:Z.id,status:"loading",id:Z.id},e.createElement(sl,{key:`${Z.id}-loading`,thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}));switch(Z.type){case"heatmap":{const z=Z;return e.createElement(Ga,E(L({},z),{key:z.id}))}case"image":{const z=Z;return e.createElement(ua,{key:Z.id,alt:z.alt,id:z.id,src:z.src})}case"plotly":{const z=Z;return e.createElement(Pd,E(L({},z),{key:z.id}),z.options.showCaption&&z.accessions.map((F,B)=>{const R=v.getRowAsMap(F);return R&&e.createElement(ga,{key:`${F}-${B}`,accession:F,caption:R,color:z.accessions.length>1?Pl[B]:void 0})}))}case"pca":{const z=Z;return e.createElement(pa,L({key:z.id},z))}case"mapman":{const z=Z;return e.createElement(ha,L({key:z.id},z))}}})),e.createElement(Ve,{initialFocusRef:t,isOpen:c,onClose:a,size:"xl",title:"Bar Plot",scrollBehavior:"outside"},e.createElement(sa,{initialFocusRef:t,onCancel:a,onSubmit:o})),e.createElement(Ve,{initialFocusRef:n,isOpen:b,onClose:i,size:"xl",title:"Individual Lines Plot",scrollBehavior:"outside"},e.createElement(La,{initialFocusRef:n,onCancel:i,onSubmit:m})),e.createElement(Ve,{initialFocusRef:p,isOpen:K,onClose:y,size:"xl",title:"Stacked Lines Plot",scrollBehavior:"outside"},e.createElement(Wa,{initialFocusRef:p,onCancel:y,onSubmit:C})),e.createElement(Ve,{initialFocusRef:G,isOpen:Q,onClose:M,size:"xl",title:"Heatmap Plot",scrollBehavior:"outside"},e.createElement(ia,{initialFocusRef:G,onCancel:M,onSubmit:Y})),e.createElement(Ve,{initialFocusRef:Xe,isOpen:Ke,onClose:q,size:"xl",title:"PCA Plot",scrollBehavior:"outside"},e.createElement(Va,{initialFocusRef:Xe,onCancel:q,onSubmit:te})),e.createElement(Ve,{initialFocusRef:he,isOpen:Le,onClose:Ge,size:"xl",title:"MapMan Functional Template Plot",scrollBehavior:"outside"},e.createElement(Ha,{initialFocusRef:he,onCancel:Ge,onSubmit:ze})),e.createElement(Ve,{initialFocusRef:ue,isOpen:se,onClose:H,size:"xl",title:"Custom figure",scrollBehavior:"outside"},e.createElement(ra,{initialFocusRef:ue,onCancel:H,onSubmit:w})))};var za=Xl(Ca);const Sa=()=>e.createElement(Kl,null,e.createElement(Re,{path:"/",element:e.createElement(za,null)})),va=ll(x),Ra=ll(g),bt=a=>{var o=a,{label:l,text:t,icon:c}=o,d=D(o,["label","text","icon"]);return e.createElement(at,E(L({},d),{_focus:L({outline:"none",borderLeftColor:"orange.600"},d._focus),_hover:L({borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},d._hover),backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"xs",display:"flex",padding:5,tabIndex:0,width:"100%"}),c&&e.createElement(re,{as:c,color:"gray.600",height:"1.5rem",marginTop:"2",marginRight:"1rem",width:"1.5rem"}),e.createElement(va,{as:"section",alignItems:"center",flexGrow:1,whileHover:"hover"},e.createElement(g,{width:"100%"},e.createElement(_,{as:"h1",fontSize:"xl",fontWeight:"semibold"},l),e.createElement(_,{marginTop:"1.5"},t)),e.createElement(Ra,{marginX:"1rem",variants:{hover:{x:[0,10],transition:{duration:.8,repeat:1/0,repeatType:"mirror"}}}},e.createElement(re,{as:et,color:"orange.600",height:"1.5rem",width:"1.5rem"}))))},Ma=()=>e.createElement(g,{as:"main",padding:6,width:"100%",__css:{"& a:not(:first-of-type)":{marginTop:"2rem"}}},e.createElement(bt,{icon:Wt,label:"Gene Browser",text:`
          The gene browser provides an interface to search and inspect the
          individual gene information stored in the replicates database.
          All searches are privately kept within your browser and will not be
          sent anywhere.
        `,to:"/tools/gene-browser"}),e.createElement(bt,{icon:Dc,label:"Enrichment Analyses",text:`
          The enrichment analyses tool allows you to run enrichment tests for your data.
          Use the "Gene Info Table" to store information about differentially expressed genes.
          All tests and results will be private to your browser and will not be sent anywhere.
        `,to:"/tools/enrichment"}),e.createElement(bt,{icon:dt,label:"MapMan Functional Annotations",text:`
          The MapMan Functional Annotations provide resources to run functional annotations on your
          sequence data via Mercator v4, that can automatically be linked to your supplementary gene information.
          You can then directly use the protein annotation metadata to plot MapMan Classification and expression of your genes. 
        `,to:"/tools/mapman"})),Ta=d=>{var a=d,{accession:l,geneInfo:t}=a,c=D(a,["accession","geneInfo"]);return e.createElement(g,L({as:"section","aria-label":"Gene info card","aria-describedby":l,display:"flex",flexDirection:"column"},c),e.createElement(x,{alignItems:"center",marginBottom:2,gridGap:"1rem"},e.createElement(_,{as:"h1",color:"orange.600",fontWeight:"semibold",fontSize:"lg",id:l},l),e.createElement(jc,{"aria-label":"show tabular transcript expression values",as:Ac,w:5,h:5,color:"gray.600",onClick:c.onDoubleClick,_hover:{color:"gray.800"}})),t.size>0?[...t.entries()].map(([o,n])=>e.createElement(x,{key:`${o}-${l}`,paddingY:1},e.createElement(x,{flexShrink:0,marginLeft:2,maxWidth:36,fontWeight:"semibold",textColor:"gray.600",textTransform:"uppercase",width:36,wordBreak:"break-all"},o),e.createElement(x,{marginLeft:5,wordBreak:"break-all"},n))):e.createElement(_,null,"There is no information available for this gene"))},Ya=l=>{const t=I.getRow(l.accessionId),c=h.gxpSettings.expression_header_sep,d=h.gxpSettings.unit,a=I.colNames.map((o,n)=>[...o.split(c),t[n]]);return e.createElement(lt,{colorScheme:"orange",variant:"striped"},e.createElement(Ht,null,"Expression count per replicate file found for this accession"),e.createElement(tt,null,e.createElement(je,{sx:{"& > th":{fontSize:14}}},e.createElement(ee,null,"Group"),e.createElement(ee,null,"Sample"),e.createElement(ee,null,"Replicate"),e.createElement(ee,{isNumeric:!0},"Count [",d,"]"))),e.createElement(ct,null,a.map(([o,n,b,s])=>e.createElement(je,{key:`${o}-${n}-${b}`,tabIndex:0,"aria-label":`Group: ${o}, Sample: ${n}, Replicate: ${b} Count: ${s}`,_focus:{outline:"2px solid",outlineColor:"orange.600"}},e.createElement(Ce,null,o),e.createElement(Ce,null,n),e.createElement(Ce,null,b),e.createElement(Ce,{isNumeric:!0},s)))),e.createElement(zt,null,e.createElement(je,null,e.createElement(ee,null,"Group"),e.createElement(ee,null,"Sample"),e.createElement(ee,null,"Replicate"),e.createElement(ee,{isNumeric:!0},"Count [",d,"]"))))};var ol;(function(l){l.COUNT_EMPTY="The results value cannot be empty",l.COUNT_LT_ONE="Results cannot be less than 1",l.PAGE_EMPTY="The page number cannot be empty",l.PAGE_GT_MAX="The page number cannot be over the max",l.PAGE_LT_ONE="The page number cannot be less than 1"})(ol||(ol={}));const Ja=a=>{var o=a,{initialFocusRef:l,onSubmit:t,pageMax:c}=o,d=D(o,["initialFocusRef","onSubmit","pageMax"]);const n=s=>{if(typeof s=="string"&&s==="")return ol.PAGE_EMPTY;if(s<1)return ol.PAGE_LT_ONE;if(s>c)return ol.PAGE_GT_MAX},b=s=>{if(typeof s=="string"&&s==="")return ol.COUNT_EMPTY;if(s<1)return ol.COUNT_LT_ONE};return e.createElement(xe,{initialValues:{searchText:"",countView:20,pageNum:1},validateOnBlur:!1,onSubmit:t},s=>e.createElement(x,L({as:ge},d),e.createElement(ae,{controlProps:{flexShrink:.7,marginLeft:2},initialFocusRef:l,label:"Search in accessions",leftChildren:e.createElement(_c,{_focusWithin:{backgroundColor:"white"},_hover:{backgroundColor:"white"},as:"span",padding:0},e.createElement(Ze,{_focus:{color:"orange.600",outline:"none"},_groupHover:{color:"orange.600"},"aria-label":"Search database",color:"gray.600",display:"flex",justifyContent:"center",icon:e.createElement(qc,null),isLoading:s.isSubmitting,size:"md",type:"submit",variant:"unstyled"})),name:"searchText"}),e.createElement(Vl,{allowMouseWheel:!0,controlProps:{marginLeft:3},label:`Page ${s.values.pageNum} / ${c}`,name:"pageNum",min:1,max:c,validate:n,width:"100%"}),e.createElement(Vl,{allowMouseWheel:!0,controlProps:{marginLeft:3},label:"Results per page",name:"countView",min:1,validate:b,width:"100%"})))},Pa=()=>{const l=bl({base:"full",lg:"6xl"}),{isOpen:t,onOpen:c,onClose:d}=be(),a=e.useRef(""),o=r=>()=>{a.current=r,c()},[n,b]=e.useState({geneCards:[],pageMax:1}),[s,i]=e.useState(!0),m=e.useCallback((r,y,C)=>{const G=new RegExp(Vd(r),"i"),Q=I.rowNames.reduce((Ke,le)=>{var Le;const q=le.search(G)>-1,te=(Le=v.getRowAsMap(le))!=null?Le:new Map,he=te?Array.from(te.values()).some(Ie=>Ie.search(G)>-1):!1;return(q||he)&&Ke.push({accession:le,geneInfo:te}),Ke},[]),W=(C-1)*y,M=C*y,Y=Q.slice(W,M),Xe=Math.ceil(Q.length/y)||1;return{geneCards:Y,pageMax:Xe}},[]);e.useEffect(function(){i(!0);const y=m("",20,1);b(y),i(!1)},[m]);const p=(r,y)=>{i(!0),setTimeout(()=>{const C=m(r.searchText,r.countView,r.pageNum);b(C),y.setSubmitting(!1),i(!1)},10)},K=I.hasData;return e.createElement(x,{flexDirection:"column",backgroundColor:"white",flexGrow:1,padding:6},e.createElement(Ja,{alignItems:"start",flexDirection:{base:"column",md:"row"},justifyContent:"space-around",onSubmit:p,pageMax:n.pageMax}),K?s?e.createElement(x,{width:"100%",flexGrow:1,justifyContent:"center",alignItems:"center"},e.createElement(sl,{size:"xl"})):n.geneCards.map(({accession:r,geneInfo:y})=>e.createElement(Ta,{_first:{marginTop:5},_even:{backgroundColor:"orange.50"},_hover:{backgroundColor:"orange.100",cursor:"pointer"},_focus:{outline:"none",border:"1px solid",borderColor:"orange.600",backgroundColor:"orange.100"},accession:r,border:"1px solid",borderColor:"transparent",geneInfo:y,key:r,padding:5,tabIndex:0,onDoubleClick:o(r),onKeyDown:C=>{C.key==="Enter"&&(C.preventDefault(),o(r)())}})):e.createElement(Ue,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ee,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(we,{maxWidth:"xl"},"It seems no data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above.")),e.createElement(Fl,{isOpen:t,onClose:d,size:l},e.createElement(Ul,null),e.createElement(El,{margin:l==="full"?0:void 0,overflow:"auto",rounded:"none"},e.createElement(Ol,{color:"orange.600"},a.current),e.createElement(Dl,null),e.createElement(jl,null,e.createElement(Ya,{accessionId:a.current})),e.createElement(St,null,e.createElement(T,{colorScheme:"orange",mr:3,onClick:d},"Close")))))},ka=({id:l})=>{const t=ye.getAnalysisById(l),c=t?t.data:[];return e.createElement(lt,{colorScheme:"orange",variant:"striped"},e.createElement(tt,null,e.createElement(je,{sx:{"& > th":{fontSize:14}}},e.createElement(ee,null,"Test Entry"),e.createElement(ee,{isNumeric:!0},"p_Value"),e.createElement(ee,{isNumeric:!0},"adjusted p_Value"))),e.createElement(ct,null,c&&c.map(([d,a,o])=>e.createElement(je,{key:`${d}-${a}-${o}`,tabIndex:0,"aria-label":`testEntry: ${d}, pValue: ${a}, adjpValue: ${o} `,_focus:{outline:"2px solid",outlineColor:"orange.600"}},e.createElement(Ce,null,d),e.createElement(Ce,{isNumeric:!0},a),e.createElement(Ce,{isNumeric:!0},o)))),e.createElement(zt,null,e.createElement(je,null,e.createElement(ee,null,"Test Entry"),e.createElement(ee,{isNumeric:!0},"p_Value"),e.createElement(ee,{isNumeric:!0},"adjusted p_Value"))))},$t=["<=",">=","<",">","==","regexp"],Qa=l=>e.createElement(xe,{initialValues:{accessions:[],accessionsList:"",title:"",TEFcolumn:v.colNames[0],TEFselector:"<",TEFselectorValue:"",TEIcolumn:v.colNames[0],TEIselectorBinary:"<",TEIselectorMulti:"delimiter",TEIselectorType:"multinomial",TEIselectorValue:""},validateOnBlur:!1,onSubmit:l.onSubmit},t=>e.createElement(g,{as:ge},e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Enrichment analysis title",name:"title",isRequired:!0}),e.createElement(il,{marginTop:"1rem"}),e.createElement(Me,{controlProps:{marginTop:"1rem"},label:"Test enrichment for",name:"TEFcolumn",options:v.colNames.reduce((c,d)=>(c.push({value:d,label:d}),c),[{value:"filterGeneIds",label:"Filter Gene identifiers"}]),tooltip:"Select a column from your gene info table to test enrichment for"}),t.values.TEFcolumn==="filterGeneIds"?e.createElement(xl,{controlProps:{marginTop:"1rem"},focusBorderColor:"orange.300",name:"filterGeneIds",label:"Identifier List",placeholder:"List your gene identifiers here, separated by a newline.",isDisabled:t.values.accessions.length>0,tooltip:"List your gene identifiers to filter for enrichment"}):e.createElement(x,{alignItems:"center",justifyContent:"center"},e.createElement(Me,{controlProps:{marginTop:"1rem",flexShrink:3,marginRight:"1rem"},label:"Selector",name:"TEFselector",options:$t.map(c=>({value:c,label:c})),tooltip:"Choose a selector function to classify your column values"}),e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem"},initialFocusRef:l.initialFocusRef,label:"Selector Value",name:"TEFselectorValue",isRequired:!0})),e.createElement(il,{marginTop:"1rem"}),e.createElement(Me,{controlProps:{marginTop:"1rem"},label:"Test enrichment in",name:"TEIcolumn",options:v.colNames.map(c=>({value:c,label:c})),tooltip:"Select a column from your gene info table to test enrichment in"}),e.createElement(x,{alignItems:"center",justifyContent:"center"},e.createElement(Me,{controlProps:{marginTop:"1rem",flexShrink:2.8,marginRight:"1rem"},label:"Selector type",name:"TEIselectorType",options:[{value:"multinomial",label:"multinomial"},{value:"binary",label:"binary"}],tooltip:"Choose a selector function to classify your column values."}),t.values.TEIselectorType==="binary"?e.createElement(Me,{controlProps:{marginTop:"1rem",flexShrink:3,marginRight:"1rem"},label:"Selector",name:"TEIselectorBinary",options:$t.map(c=>({value:c,label:c})),tooltip:"Choose a selector function to classify your column values."}):e.createElement(Me,{controlProps:{marginTop:"1rem",flexShrink:3,marginRight:"1rem"},label:"Selector",name:"TEIselectorMulti",options:[{value:"delimiter",label:"delimiter"},{value:"regexp",label:"regexp"}],tooltip:"Choose a selector function to classify your column values."}),e.createElement(ae,{controlProps:{as:"p",marginTop:"1rem",flexShrink:2.2},initialFocusRef:l.initialFocusRef,label:"Selector Value",name:"TEIselectorValue",isRequired:!0})),e.createElement(x,{as:"p",paddingY:6,justifyContent:"flex-end"},e.createElement(T,{onClick:l.onCancel,colorScheme:"red",variant:"ghost"},"Cancel"),e.createElement(T,{colorScheme:"orange",isLoading:t.isSubmitting,marginLeft:".5rem",type:"submit",variant:"solid"},"Run")))),Il=d=>{var a=d,{label:l,value:t}=a,c=D(a,["label","value"]);return e.createElement(x,{paddingY:.5,width:"full"},e.createElement(x,L({flexShrink:0,marginLeft:2,maxWidth:"12rem",fontWeight:"semibold",textColor:"gray.600",width:"12rem",wordBreak:"break-all"},c),l),e.createElement(x,{marginLeft:5,wordBreak:"break-word"},t))},Ba=()=>{var C;const l=bl({base:"full",lg:"6xl"}),t=Tl(),c=v.hasData,d=e.useRef(null),{isOpen:a,onOpen:o,onClose:n}=be(),b=(G,Q)=>{Q.setSubmitting(!1),n();const W={TEFcolumn:G.TEFcolumn,TEFselector:G.TEFselector,TEFselectorValue:G.TEFselectorValue,TEIcolumn:G.TEIcolumn,TEIselectorType:G.TEIselectorType,TEIselector:G.TEIselectorType==="binary"?G.TEIselectorBinary:G.TEIselectorMulti,TEIselectorValue:G.TEIselectorValue,title:G.title,filterGeneIds:G.filterGeneIds?G.filterGeneIds.split(`
`):void 0};setTimeout(()=>{try{ye.addEnrichmentAnalysis(W)}catch(M){t({title:"Error",description:M.message,status:"error",isClosable:!0})}},10)},s=e.useRef(""),{isOpen:i,onOpen:m,onClose:p}=be(),K=G=>()=>{s.current=G,m()},r=G=>Q=>{ye.deleteAnalysis(G),Q.stopPropagation()},y=G=>Q=>{const W=ye.getAnalysisById(G);if(!W)throw new Error("Specified enrichment analysis does not exist.");const M=ye.dataToCSV(W,"	"),Y=new Blob([M],{type:"text/plain"});ql.exports.saveAs(Y,"enrichment.tsv"),Q.stopPropagation()};return e.createElement(x,{alignItems:"center",flexDirection:"column",padding:"2rem",width:"100%",paddingRight:"6rem"},c?ye.analyses.length===0?e.createElement(Ue,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"info",textAlign:"center",variant:"subtle",colorScheme:"orange"},e.createElement(Ee,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"Run your enrichment analysis"),e.createElement(we,{maxWidth:"xl"},"To run an enrichment analysis on the data supplied by your meta information table, click the Button in the bottom right corner and fill out the Form. For more Information see [Documentation]")):ye.analyses.map((G,Q)=>e.createElement(x,{key:Q,_focus:{outline:"none",borderLeftColor:"orange.600"},_hover:{borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},cursor:"pointer",backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"sm",padding:5,tabIndex:0,width:"100%",alignItems:"start",justifyContent:"center",as:"section",flexGrow:1,marginTop:4,onClick:K(G.id),onKeyDown:W=>{W.key==="Enter"&&(W.preventDefault(),K(G.id)())}},G.isLoading?e.createElement(sl,{display:"flex",key:`${G.id}-loading`,thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"md"}):e.createElement(g,{width:"100%"},e.createElement(_,{as:"h1",fontSize:"xl",fontWeight:"semibold",marginBottom:2,textColor:"orange.600"},G.options.title),e.createElement(Il,{label:"Enrichment type",value:G.options.TEIselectorType}),e.createElement(Il,{label:"Tested Enrichment for",value:G.options.TEFcolumn,marginTop:"0.4rem"}),e.createElement(Il,{label:"Selector",value:`"${G.options.TEFselector}" : "${G.options.TEFselectorValue}"`}),e.createElement(Il,{label:"Tested Enrichment in",value:G.options.TEIcolumn,marginTop:"0.4rem"}),e.createElement(Il,{label:"Selector",value:`"${G.options.TEIselector}" : "${G.options.TEIselectorValue}"`})),!G.isLoading&&e.createElement(x,null,e.createElement(Ze,{_hover:{color:"orange.600"},"aria-label":"Delete enrichment analysis",color:"gray.600",icon:e.createElement(Xt,null),marginLeft:2,size:"lg",variant:"ghost",onClick:y(G.id),zIndex:"overlay",as:"a"}),e.createElement(Ze,{_hover:{color:"orange.600"},"aria-label":"Delete enrichment analysis",color:"gray.600",icon:e.createElement(Rl,null),marginLeft:2,size:"lg",variant:"ghost",onClick:r(G.id),zIndex:"overlay"})))):e.createElement(Ue,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",marginLeft:3,marginTop:3,status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ee,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(we,{maxWidth:"xl"},"It seems no gene info data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above.")),e.createElement(Ze,{"aria-label":"add new enrichment analysis",icon:e.createElement(De,{size:"1rem",color:"white"}),position:"fixed",height:"4rem",width:"4rem",variant:"solid",right:"1rem",bottom:"1rem",backgroundColor:"orange.400",borderRadius:"full",shadow:"xl",_hover:{backgroundColor:"orange.300"},onClick:o,disabled:!c}),e.createElement(Ve,{initialFocusRef:d,isOpen:a,onClose:n,size:"xl",title:"New Enrichment Analysis",scrollBehavior:"outside"},e.createElement(Qa,{initialFocusRef:d,onCancel:n,onSubmit:b})),e.createElement(Fl,{isOpen:i,onClose:p,size:l},e.createElement(Ul,null),e.createElement(El,{margin:l==="full"?0:void 0,overflow:"auto",rounded:"none"},e.createElement(Ol,{color:"orange.600"},(C=ye.getAnalysisById(s.current))==null?void 0:C.options.title),e.createElement(Dl,null),e.createElement(jl,null,e.createElement(ka,{id:s.current})),e.createElement(St,null,e.createElement(T,{colorScheme:"orange",mr:3,onClick:p},"Close")))))};var Na=Xl(Ba);const wa=ll(x),fa=ll(g),ec=a=>{var o=a,{label:l,text:t,icon:c}=o,d=D(o,["label","text","icon"]);return e.createElement(g,E(L({textAlign:"start",as:"button"},d),{_focus:L({outline:"none",borderLeftColor:"orange.600"},d._focus),_hover:L({borderLeftColor:"orange.600",boxShadow:"md",textDecoration:"none"},d._hover),backgroundColor:"white",borderLeft:"4px",borderLeftColor:"transparent",boxShadow:"xs",display:"flex",padding:5,tabIndex:0,width:"100%"}),c&&e.createElement(re,{as:c,color:"gray.600",height:"1.5rem",marginTop:"2",marginRight:"1rem",width:"1.5rem"}),e.createElement(wa,{as:"section",alignItems:"center",flexGrow:1,whileHover:"hover"},e.createElement(g,{width:"100%"},e.createElement(_,{as:"h1",fontSize:"xl",fontWeight:"semibold"},l),e.createElement(_,{marginTop:"1.5"},t)),e.createElement(fa,{marginX:"1rem",variants:{hover:{x:[0,10],transition:{duration:.8,repeat:1/0,repeatType:"mirror"}}}},e.createElement(re,{as:et,color:"orange.600",height:"1.5rem",width:"1.5rem"}))))},Fa=()=>{const l=e.useRef(null),{isOpen:t,onOpen:c,onClose:d}=be(),a=Tl(),o=(n,b)=>{const s=n.file;if(s)try{const i=new FileReader;i.onload=()=>{const m=i.result.split(`
`,1)[0];if(ft(m))Ft(i.result,{addDescription:n.addDescription,addName:n.addName}),a({title:"Successfully imported Mercator table",status:"success",description:"The provided Mercator tabular output was successfully imported into the application.",isClosable:!0});else{a({title:"Error",status:"error",description:"Invalid Mercator Input.",isClosable:!0});return}},i.onloadend=()=>{b.setSubmitting(!1),d()},i.onerror=()=>{b.setSubmitting(!1),console.error("There was an error while reading the file")},i.readAsText(s)}catch(i){b.setSubmitting(!1),console.error(i)}};return e.createElement(e.Fragment,null,e.createElement(g,{as:"main",padding:6,width:"100%",__css:{"& button:not(:first-of-type)":{marginTop:"2rem"}}},I.hasData?e.createElement(e.Fragment,null,e.createElement(ec,{icon:dt,label:"Mercator v4",text:`
              Use the Mercator v4 tool to annotate your genes with MapMan Bins. Clicking here
              will bring you to the plabipd online resources to run Mercator on your DNA or protein
              sequences. After running Mercator you can import the output table into GXP by using
              the Card below.
            `,onClick:()=>window.open("https://plabipd.de/portal/mercator4")}),e.createElement(ec,{icon:Lt,label:"Import Mercator output",text:`
              Import Mercator v4 tabular output into the GXP. Importing the file will automatically
              append the Mercator columns to already uploaded gene info. If no gene info was uploaded
              yet, the in memory gene info will be created for you.
            `,onClick:c})):e.createElement(Ue,{alignItems:"center",flexDirection:"column",minHeight:"16rem",maxHeight:"20rem",justifyContent:"center",status:"warning",textAlign:"center",variant:"subtle"},e.createElement(Ee,{boxSize:"3rem",mr:0}),e.createElement(Oe,{mt:4,mb:1,fontSize:"lg"},"No data has been loaded"),e.createElement(we,{maxWidth:"xl"},"It seems no data has been loaded into the application yet. You can load data from various formats in the Data section of the toolbar above."))),e.createElement(Ve,{initialFocusRef:l,isOpen:t,onClose:d,title:"Load Mercator Table"},e.createElement(Ut,{initialFocusRef:l,onCancel:d,onSubmit:o})))},Ua=()=>e.createElement(Kl,null,e.createElement(Re,{path:"/",element:e.createElement(Ma,null)}),e.createElement(Re,{path:"/gene-browser",element:e.createElement(Pa,null)}),e.createElement(Re,{path:"/enrichment",element:e.createElement(Na,null)}),e.createElement(Re,{path:"/mapman",element:e.createElement(Fa,null)})),Ea=()=>e.createElement(Kl,null,e.createElement(Re,{path:"/",element:e.createElement(id,null)}),e.createElement(Re,{path:"/data/*",element:e.createElement(ta,null)}),e.createElement(Re,{path:"/plots/*",element:e.createElement(Sa,null)}),e.createElement(Re,{path:"/tools/*",element:e.createElement(Ua,null)}),e.createElement(Re,{path:"/docs/*",element:e.createElement(oa,null)})),kl=l=>{const t=bl({base:"md",lg:"lg"}),c=$c(),d=(l.urlMatch==="exact"||l.urlMatch===void 0)&&c.pathname===l.href||l.urlMatch==="contains"&&c.pathname.includes(l.href);return e.createElement(ed,null,e.createElement(at,{_focus:{outline:"none",backgroundColor:"gray.100",textColor:"orange.600"},_hover:{backgroundColor:"gray.100",textColor:"orange.600"},alignItems:"center",borderRadius:"md",borderY:"2px",borderColor:d?"white":"transparent",display:"flex",flexDirection:"column",justifyContent:"center",paddingY:2,paddingX:4,textColor:"white",tabIndex:0,to:l.href},e.createElement(re,{as:l.icon,width:5,height:5}),e.createElement(_,{as:"span",fontSize:t,fontWeight:"semibold",userSelect:"none"},l.text)))},Oa=l=>e.createElement(g,L({as:"nav",paddingY:2,paddingX:5,backgroundColor:"orange.600",boxShadow:"xl"},l),e.createElement(ld,{display:"flex",justifyContent:"space-around",listStyleType:"none"},l.children)),Da=l=>e.createElement(x,L({flexDirection:"column",minHeight:"100vh",backgroundColor:"gray.100"},l),e.createElement(Oa,null,e.createElement(kl,{href:"/data",icon:td,text:"Data",urlMatch:"contains"}),e.createElement(kl,{href:"/plots",icon:Ct,text:"Plots",urlMatch:"contains"}),e.createElement(kl,{href:"/tools",icon:cd,text:"Tools",urlMatch:"contains"}),e.createElement(kl,{href:"/docs",icon:dd,text:"Docs",urlMatch:"contains"})),l.children),ja=()=>{const[l,t]=e.useState({status:"idle"}),c=async()=>{var d;t({status:"loading"});try{if(h.preloaded.settings){const a=await Fe(h.preloaded.settings,"json");h.loadgxpSettings(a),J.loadCountUnit(h.gxpSettings.unit)}if(h.preloaded.data){const a=await Fe(h.preloaded.data,"text"),o=Ae(a,{fieldSeparator:h.gxpSettings.expression_field_sep,rowNameColumn:0});I.loadFromObject(o,{multiHeader:h.gxpSettings.expression_header_sep}),h.gxpSettings.groupOrder.length===0&&h.setGroupOrder(I.groupsAsArray),h.gxpSettings.sampleOrder.length===0&&h.setSampleOrder(I.samplesAsArray)}if(h.preloaded.info){const a=await Fe(h.preloaded.info,"text"),o=Ae(a,{fieldSeparator:h.gxpSettings.info_field_sep,rowNameColumn:0});v.loadFromObject(o,{multiHeader:"*"})}if(h.preloaded.image){const a=await Fe(h.preloaded.image,"url"),o=(d=a.split("/").pop())==null?void 0:d.split(".").shift();J.addImagePlot(a,o)}if(h.preloaded.plots){const a=await Fe(h.preloaded.plots,"json");await Promise.all(a.map(async o=>{const n=await Fe(o,"json");J.addRawPlot(L({id:me(),isLoading:!1},n))}))}if(h.preloaded.enrichments){const a=await Fe(h.preloaded.enrichments,"json");await Promise.all(a.map(async o=>{const m=o,{rawData:n}=m,b=D(m,["rawData"]),s=await Fe(n,"text"),i=wt(s,h.gxpSettings.expression_field_sep);ye.addRawEnrichmentAnalysis({id:me(),isLoading:!1,options:b,data:i})}))}t({status:"idle"})}catch(a){t({status:"failed",message:a.message})}};return e.useEffect(function(){(h.preloaded.data||h.preloaded.image||h.preloaded.info||h.preloaded.settings)&&c()},[]),e.createElement(ad,null,e.createElement(Da,null,l.status==="loading"?e.createElement(x,{alignItems:"center",flexDirection:"column",flexGrow:1,justifyContent:"center",width:"100%"},e.createElement(sl,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),e.createElement(_,{fontSize:"xl",fontWeight:"semibold",marginTop:6},"Loading Application Data")):l.status==="failed"?e.createElement(Ue,{alignItems:"center",flexDirection:"column",justifyContent:"center",marginTop:10,padding:8,status:"error",textAlign:"center",variant:"subtle"},e.createElement(Ee,{boxSize:"2rem",marginRight:0}),e.createElement(Oe,{marginTop:6,fontSize:"lg"},"The application failed to load"),e.createElement(we,{marginTop:3,maxWidth:"xl"},"The application failed when trying to load data resources. You may try reloading the page. If the problem persists, please contact your administrator."),e.createElement(od,{marginTop:6},l.message)):e.createElement(Ea,null)))};nd.render(e.createElement(e.StrictMode,null,e.createElement(bd,null,e.createElement(ja,null))),document.getElementById("root"));
